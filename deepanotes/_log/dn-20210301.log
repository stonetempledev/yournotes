2021-03-01 22:29:22,878 [7] INFO dn_lib.tools.log - reload core
2021-03-01 22:29:22,923 [7] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:22,925 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:22,938 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:22,946 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:22,958 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:22,961 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:22,976 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:22,979 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:22,984 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:22,996 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:22,998 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:22,999 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,001 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,003 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,005 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,006 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,006 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,007 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:23,012 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:23,014 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,017 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,018 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,019 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,020 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,021 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,022 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:23,100 [7] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:23,102 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:23,103 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:23,104 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,105 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,107 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,107 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,108 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,109 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,109 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:23,110 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:23,111 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,113 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,115 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,118 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,120 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,121 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,121 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:23,122 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:23,123 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,124 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,125 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,126 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,127 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,127 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,128 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:23,167 [7] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:23,169 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:23,170 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:23,171 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,172 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,173 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,173 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,174 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,174 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,175 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:23,175 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:23,176 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,176 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,177 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,177 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,178 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,178 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,178 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:23,179 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:23,179 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:23,180 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:23,180 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:23,181 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:23,182 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:23,184 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:23,197 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:23,228 [7] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 22:29:23,238 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 22:29:23,245 [7] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 22:29:23,261 [7] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 22:29:23,275 [7] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 22:29:23,313 [7] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 22:29:23,334 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 22:29:23,429 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 22:29:23,436 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 22:29:23,439 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 22:29:31,146 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:31,147 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,148 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,149 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,150 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,151 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,152 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,152 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,153 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,154 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,154 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,155 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,156 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,156 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,157 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,158 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,159 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,159 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,160 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,160 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,161 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,161 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,162 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,164 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,164 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,165 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:31,181 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:31,182 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,183 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,184 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,184 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,185 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,186 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,187 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,187 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,188 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,189 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,189 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,190 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,191 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,194 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,195 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,195 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,197 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,198 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,198 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,199 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,200 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,201 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,201 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,202 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,203 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:31,219 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:31,220 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,221 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,221 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,222 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,223 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,224 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,224 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,225 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,226 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,226 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,227 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,227 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,228 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,229 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,229 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,230 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,231 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,231 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,232 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,233 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,233 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,234 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,235 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,235 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,236 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:31,795 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:31,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,805 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,805 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,805 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:31,807 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:31,815 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:31,815 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:31,815 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:31,815 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:31,815 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:31,865 [11] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:29:31,865 [11] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:29:31,865 [11] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:29:31,875 [11] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:29:31,875 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:29:31,875 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:29:31,875 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:29:31,875 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:29:31,885 [11] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:29:31,890 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:29:31,890 [11] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:29:31,890 [11] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:29:31,895 [11] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:29:31,895 [11] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:29:31,907 [11] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:29:31,907 [11] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:29:31,907 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:29:31,907 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:29:31,915 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:29:31,915 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:29:31')
        else update users_cache set var_value = substring('2021/03/01 22:29:31', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:29:33,758 [7] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:33,760 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:33,761 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:33,762 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:33,762 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:33,763 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:33,764 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:33,765 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:33,766 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:33,767 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:33,767 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:33,768 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:33,769 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:33,769 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:33,770 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:33,770 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:33,771 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:33,772 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:33,772 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:33,773 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:33,774 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:33,775 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:33,775 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:33,776 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:33,776 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:33,777 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:34,335 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:29:34,345 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:29:34,345 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:29:34,360 [7] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:29:34,360 [7] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:29:34,360 [7] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:29:34,365 [7] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:29:34,375 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:29:34,375 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:29:34,375 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:29:34,375 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:29:34')
        else update users_cache set var_value = substring('2021/03/01 22:29:34', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:30:09,531 [14] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:30:09,532 [14] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:09,533 [14] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:09,534 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:09,535 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:09,536 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:09,536 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:09,537 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:09,538 [14] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:09,539 [14] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:09,540 [14] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:09,541 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:09,542 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:09,543 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:09,545 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:09,545 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:09,546 [14] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:09,547 [14] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:09,548 [14] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:09,549 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:09,549 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:09,550 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:09,551 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:09,552 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:09,552 [14] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:09,553 [14] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:30:10,135 [12] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:30:10,136 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:10,137 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:10,138 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:10,139 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:10,140 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:10,141 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:10,142 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:10,142 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:10,143 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:10,144 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:10,145 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:10,145 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:10,146 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:10,146 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:10,147 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:10,148 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:10,148 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:10,149 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:10,150 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:10,150 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:10,151 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:10,152 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:10,152 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:10,153 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:10,154 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:30:10,170 [12] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:30:10,170 [12] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:30:10,175 [12] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:30:10,175 [12] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:30:10,175 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:30:10,175 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:30:10,175 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:30:10,185 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:30:10,185 [12] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:30:10,185 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:30:10,185 [12] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:30:10,185 [12] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:30:10,185 [12] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:30:10,195 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20200101.20200303.mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20200101.20200303.mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:01', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:01', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:01', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:30:10,195 [12] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20200101.20200303.mimmo.task
2021-03-01 22:30:10,215 [12] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20200101.20200303.mimmo.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:30:10,215 [12] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1850
2021-03-01 22:30:10,225 [12] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\mimmo.task\__i.xml
2021-03-01 22:30:10,225 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1850 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1850, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , NULL, NULL, NULL, NULL, convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:30:10', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:30:10,225 [12] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:30:10,235 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1850 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1850, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:30:10,235 [12] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:30:10,244 [12] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4348;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4348, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:30:10,244 [12] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:30:10,244 [12] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1471;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1471, 4348, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:30:10,255 [12] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:30:10,255 [12] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1471) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:30:10,265 [12] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:30:10,270 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:30:10,275 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:30:10,280 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:30:05')
        else update users_cache set var_value = substring('2021/03/01 22:30:05', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:30:10,280 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:30:10')
        else update users_cache set var_value = substring('2021/03/01 22:30:10', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:30:12,781 [13] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:30:12,783 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:12,783 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:12,784 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:12,785 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:12,785 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:12,786 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:12,786 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:12,787 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:12,787 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:12,788 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:12,788 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:12,789 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:12,790 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:12,790 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:12,791 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:12,791 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:12,792 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:12,792 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:12,793 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:12,793 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:12,794 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:12,794 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:12,795 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:12,795 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:12,796 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:30:13,345 [14] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:13,348 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:13,355 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:13,355 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:13,355 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:13,355 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:13,355 [14] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:13,355 [14] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:30:13,358 [14] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:30:13,358 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:30:13,358 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:30:13,358 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:30:13,358 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:30:13,358 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:30:13,358 [14] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:30:13,358 [14] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:30:13,365 [14] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:30:13,365 [14] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:30:13,365 [14] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:30:13,365 [14] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:30:13,365 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:30:13,374 [14] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:30:13,384 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:30:13,384 [14] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:30:13,384 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1850 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1850, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , NULL, NULL, NULL, NULL, convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:30:10', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:30:13,384 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1850 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1850, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:30:13,384 [14] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1471) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:30:13,384 [14] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:30:13,395 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:30:13,395 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:30:13,395 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:30:10')
        else update users_cache set var_value = substring('2021/03/01 22:30:10', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:30:13,395 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:30:13')
        else update users_cache set var_value = substring('2021/03/01 22:30:13', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:33:25,852 [19] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:33:25,854 [19] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:25,854 [19] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:25,855 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:25,856 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:25,857 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:25,858 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:25,859 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:25,860 [19] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:25,861 [19] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:25,861 [19] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:25,862 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:25,862 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:25,863 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:25,864 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:25,865 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:25,865 [19] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:25,866 [19] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:25,867 [19] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:25,868 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:25,869 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:25,869 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:25,870 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:25,871 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:25,872 [19] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:25,872 [19] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:33:26,427 [12] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:33:26,428 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:26,430 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:26,431 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:26,433 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:26,434 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:26,436 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:26,437 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:26,439 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:26,440 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:26,440 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:26,442 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:26,442 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:26,442 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:26,444 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:26,444 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:26,444 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:26,445 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:26,445 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:26,447 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:26,448 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:26,448 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:26,449 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:26,450 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:26,450 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:26,451 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:33:26,461 [12] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:33:26,473 [12] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:33:26,477 [12] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:33:26,481 [12] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:33:26,483 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:33:26,485 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:33:26,487 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:33:26,488 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:33:26,491 [12] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:33:26,492 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:33:26,493 [12] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:33:26,494 [12] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:33:26,499 [12] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:33:26,500 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.iocorso.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.iocorso.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:33:26,505 [12] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.iocorso.task
2021-03-01 22:33:26,507 [12] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.iocorso.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:33:26,508 [12] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1851
2021-03-01 22:33:26,511 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1851 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1851, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , NULL, NULL, NULL, NULL, convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:30:10', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:33:26,516 [12] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:33:26,517 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1851 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1851, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:33:26,522 [12] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:33:26,523 [12] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4349;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4349, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:33:26,526 [12] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:33:26,526 [12] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1472;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1472, 4349, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:33:26,529 [12] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:33:26,530 [12] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1472) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:33:26,538 [12] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:33:26,546 [12] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:33:26,547 [12] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:33:26,548 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:33:26,552 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:33:26,555 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:30:10')
        else update users_cache set var_value = substring('2021/03/01 22:30:10', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:33:26,558 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:33:26')
        else update users_cache set var_value = substring('2021/03/01 22:33:26', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:33:28,729 [5] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:33:28,730 [5] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:28,731 [5] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:28,732 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:28,733 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:28,734 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:28,735 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:28,736 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:28,736 [5] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:28,737 [5] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:28,738 [5] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:28,738 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:28,738 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:28,739 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:28,739 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:28,740 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:28,741 [5] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:28,741 [5] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:28,742 [5] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:28,743 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:28,743 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:28,744 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:28,744 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:28,745 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:28,746 [5] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:28,746 [5] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:33:29,301 [7] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:33:29,302 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:29,304 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:29,305 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:29,307 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:29,309 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:29,309 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:29,311 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:29,312 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:29,313 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:29,313 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:29,314 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:29,315 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:29,316 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:29,316 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:29,317 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:29,317 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:29,318 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:33:29,319 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:33:29,320 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:33:29,321 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:33:29,322 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:33:29,322 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:33:29,323 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:33:29,323 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:33:29,324 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:33:29,334 [7] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:33:29,336 [7] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:33:29,337 [7] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:33:29,338 [7] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:33:29,339 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:33:29,340 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:33:29,340 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:33:29,341 [7] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:33:29,343 [7] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:33:29,343 [7] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:33:29,344 [7] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:33:29,345 [7] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:33:29,355 [7] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:33:29,356 [7] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:33:29,360 [7] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1851 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1851, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , NULL, NULL, NULL, NULL, convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:30:10', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:33:29,363 [7] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1851 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1851, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:33:29,364 [7] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1472) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:33:29,365 [7] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:33:29,366 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:33:29,368 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:33:29,369 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:30:10')
        else update users_cache set var_value = substring('2021/03/01 22:30:10', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:33:29,370 [7] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:33:29')
        else update users_cache set var_value = substring('2021/03/01 22:33:29', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:34:23,514 [11] INFO dn_lib.tools.log - reload core
2021-03-01 22:34:23,587 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:23,589 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,590 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,591 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,592 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,593 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,594 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,594 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,595 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,596 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,597 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,598 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,600 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,602 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,603 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,604 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,605 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,605 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,634 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,637 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,639 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,640 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,642 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,643 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,644 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,647 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:23,763 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:23,763 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,764 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,766 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,768 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,770 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,771 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,771 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,772 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,773 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,774 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,775 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,776 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,777 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,778 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,779 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,780 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,781 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,782 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,784 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,785 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,786 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,787 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,788 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,789 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,791 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:23,874 [5] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:23,875 [5] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,876 [5] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,877 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,878 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,879 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,880 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,881 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,883 [5] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,885 [5] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,886 [5] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,887 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,887 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,888 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,889 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,890 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,890 [5] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,891 [5] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:23,892 [5] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:23,892 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:23,893 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:23,894 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:23,894 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:23,895 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:23,896 [5] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:23,901 [5] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:23,937 [5] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 22:34:23,946 [5] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 22:34:23,954 [5] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 22:34:23,973 [5] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 22:34:23,988 [5] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 22:34:24,030 [5] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 22:34:24,052 [5] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 22:34:24,214 [5] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 22:34:24,218 [5] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 22:34:24,222 [5] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 22:34:40,046 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:40,051 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,052 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,053 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,054 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,055 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,056 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,057 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,058 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,059 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,059 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,060 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,061 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,061 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,062 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,063 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,064 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,065 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,066 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,067 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,067 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,068 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,069 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,070 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,071 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,071 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:40,103 [5] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:40,104 [5] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,104 [5] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,105 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,105 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,106 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,106 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,107 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,107 [5] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,108 [5] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,108 [5] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,109 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,109 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,109 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,110 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,110 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,110 [5] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,111 [5] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,111 [5] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,112 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,112 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,113 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,113 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,114 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,114 [5] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,115 [5] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:40,150 [8] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:40,151 [8] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,151 [8] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,152 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,152 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,152 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,153 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,153 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,154 [8] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,154 [8] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,155 [8] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,155 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,156 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,156 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,157 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,157 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,158 [8] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,158 [8] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,159 [8] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,159 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,160 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,160 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,161 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,161 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,161 [8] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,162 [8] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:40,741 [12] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:40,742 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,743 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,744 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,745 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,746 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,747 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,747 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,748 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,749 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,750 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,750 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,751 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,752 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,753 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,753 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,754 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,755 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:40,756 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:40,756 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:40,757 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:40,758 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:40,759 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:40,759 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:40,760 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:40,761 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:43,587 [12] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:34:43,589 [12] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:34:43,592 [12] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:34:43,594 [12] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:34:43,597 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:34:43,600 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:34:43,601 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:34:43,603 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:34:43,609 [12] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:34:43,610 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:34:43,612 [12] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:34:43,614 [12] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:34:43,618 [12] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:34:43,620 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:34:44,687 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1851 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1851, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , NULL, NULL, NULL, NULL, convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:30:10', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:34:44,702 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1851 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1851, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:34:44,708 [12] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1472) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:34:44,716 [12] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:34:44,723 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:34:44,727 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:34:44,730 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:30:10')
        else update users_cache set var_value = substring('2021/03/01 22:30:10', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:34:44,733 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:34:44')
        else update users_cache set var_value = substring('2021/03/01 22:34:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:34:57,977 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:57,978 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:57,980 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:57,980 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:57,981 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:57,982 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:57,982 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:57,983 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:57,983 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:57,984 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:57,985 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:57,985 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:57,986 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:57,986 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:57,986 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:57,987 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:57,987 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:57,988 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:57,988 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:57,988 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:57,989 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:57,989 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:57,990 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:57,990 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:57,991 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:57,991 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:58,563 [5] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:34:58,564 [5] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:58,564 [5] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:58,565 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:58,566 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:58,567 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:58,568 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:58,568 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:58,569 [5] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:58,569 [5] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:58,570 [5] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:58,570 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:58,572 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:58,572 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:58,572 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:58,573 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:58,574 [5] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:58,574 [5] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:34:58,575 [5] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:34:58,576 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:34:58,576 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:34:58,577 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:34:58,577 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:34:58,578 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:34:58,578 [5] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:34:58,579 [5] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:34:58,588 [5] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:34:58,589 [5] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:34:58,591 [5] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:34:58,592 [5] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:34:58,592 [5] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:34:58,593 [5] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:34:58,594 [5] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:34:58,595 [5] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:34:58,597 [5] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:34:58,598 [5] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:34:58,599 [5] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:34:58,600 [5] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:34:58,609 [5] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:34:58,610 [5] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.incorso.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.incorso.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:34:58,614 [5] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.incorso.task
2021-03-01 22:38:35,639 [5] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.incorso.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:38:37,059 [5] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1852
2021-03-01 22:39:01,804 [5] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\mimmo.task\__i.xml
2021-03-01 22:40:12,701 [5] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1852 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1852, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:39:00', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:39:00', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:41:23,195 [5] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:41:30,355 [5] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1852 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1852, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:41:30,363 [5] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:41:30,365 [5] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4350;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4350, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:41:30,369 [5] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:41:30,371 [5] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1473;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1473, 4350, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:41:30,376 [5] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:41:30,377 [5] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1473) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:41:54,063 [5] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:42:04,185 [5] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:42:04,537 [5] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:42:06,774 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:42:07,754 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:42:08,176 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:30:10')
        else update users_cache set var_value = substring('2021/03/01 22:30:10', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:42:08,352 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:42:08')
        else update users_cache set var_value = substring('2021/03/01 22:42:08', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:42:32,659 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:42:32,660 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:42:32,660 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:42:32,661 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:42:32,661 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:42:32,662 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:42:32,662 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:42:32,663 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:42:32,663 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:42:32,664 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:42:32,664 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:42:32,664 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:42:32,665 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:42:32,665 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:42:32,665 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:42:32,666 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:42:32,666 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:42:32,667 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:42:32,667 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:42:32,667 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:42:32,668 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:42:32,668 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:42:32,669 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:42:32,670 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:42:32,670 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:42:32,671 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:42:33,247 [38] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:42:33,248 [38] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:42:33,249 [38] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:42:33,250 [38] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:42:33,251 [38] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:42:33,252 [38] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:42:33,253 [38] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:42:33,254 [38] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:42:33,255 [38] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:42:33,256 [38] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:42:33,256 [38] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:42:33,257 [38] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:42:33,257 [38] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:42:33,258 [38] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:42:33,258 [38] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:42:33,259 [38] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:42:33,260 [38] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:42:33,260 [38] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:42:33,261 [38] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:42:33,261 [38] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:42:33,262 [38] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:42:33,263 [38] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:42:33,263 [38] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:42:33,264 [38] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:42:33,265 [38] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:42:33,266 [38] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:42:33,279 [38] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:42:33,281 [38] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:42:33,284 [38] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:42:33,285 [38] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:42:33,287 [38] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:42:33,289 [38] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:42:33,290 [38] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:42:33,291 [38] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:42:33,293 [38] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:42:33,294 [38] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:42:33,295 [38] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:42:33,296 [38] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:42:33,308 [38] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:42:33,309 [38] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:42:35,040 [38] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1852 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1852, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:39:00', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:39:00', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:42:35,047 [38] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1852 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1852, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:42:35,053 [38] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1473) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:42:35,060 [38] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:42:35,067 [38] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:42:35,069 [38] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:42:35,071 [38] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:39:00')
        else update users_cache set var_value = substring('2021/03/01 22:39:00', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:42:35,075 [38] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:42:35')
        else update users_cache set var_value = substring('2021/03/01 22:42:35', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:43:38,092 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:43:38,093 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:38,094 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:38,095 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:38,095 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:38,096 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:38,097 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:38,097 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:38,098 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:38,098 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:38,099 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:38,099 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:38,100 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:38,100 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:38,100 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:38,101 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:38,101 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:38,101 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:38,102 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:38,102 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:38,103 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:38,103 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:38,103 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:38,104 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:38,104 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:38,105 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:43:38,682 [28] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:43:38,683 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:38,685 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:38,686 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:38,687 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:38,688 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:38,689 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:38,690 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:38,691 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:38,691 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:38,692 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:38,693 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:38,693 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:38,694 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:38,695 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:38,695 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:38,696 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:38,697 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:38,697 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:38,698 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:38,699 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:38,700 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:38,701 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:38,701 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:38,702 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:38,702 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:43:38,711 [28] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:43:38,714 [28] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:43:38,716 [28] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:43:38,717 [28] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:43:38,719 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:43:38,720 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:43:38,722 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:43:38,722 [28] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:43:38,724 [28] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:43:38,725 [28] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:43:38,726 [28] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:43:38,727 [28] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:43:38,741 [28] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:43:38,742 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.ok.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.ok.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:43:38,747 [28] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.ok.task
2021-03-01 22:43:39,609 [28] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.ok.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:43:39,610 [28] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1853
2021-03-01 22:43:39,620 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1853 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1853, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:39:00', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:39:00', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:43:39,626 [28] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:43:39,627 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1853 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1853, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:43:39,631 [28] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:43:39,633 [28] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4351;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4351, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:43:39,636 [28] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:43:39,637 [28] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1474;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1474, 4351, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:43:39,640 [28] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:43:39,641 [28] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1474) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:43:39,647 [28] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:43:39,655 [28] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:43:39,656 [28] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:43:39,657 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:43:39,661 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:43:39,665 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:39:00')
        else update users_cache set var_value = substring('2021/03/01 22:39:00', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:43:39,669 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:43:39')
        else update users_cache set var_value = substring('2021/03/01 22:43:39', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:43:41,634 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:43:41,635 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:41,636 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:41,636 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:41,637 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:41,637 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:41,638 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:41,638 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:41,639 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:41,639 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:41,639 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:41,640 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:41,640 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:41,641 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:41,641 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:41,642 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:41,643 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:41,643 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:41,643 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:41,644 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:41,644 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:41,645 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:41,645 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:41,646 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:41,646 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:41,647 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:43:42,207 [28] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:43:42,209 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:42,210 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:42,212 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:42,213 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:42,214 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:42,215 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:42,216 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:42,217 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:42,218 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:42,219 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:42,219 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:42,221 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:42,221 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:42,221 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:42,222 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:42,222 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:42,223 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:43:42,224 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:43:42,224 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:43:42,225 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:43:42,225 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:43:42,226 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:43:42,226 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:43:42,227 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:43:42,228 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:43:42,238 [28] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:43:42,239 [28] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:43:42,240 [28] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:43:42,241 [28] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:43:42,242 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:43:42,242 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:43:42,243 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:43:42,244 [28] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:43:42,245 [28] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:43:42,246 [28] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:43:42,247 [28] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:43:42,248 [28] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:43:42,258 [28] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:43:42,259 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:43:42,698 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1853 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1853, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:39:00', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:39:00', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:43:42,708 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1853 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1853, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:43:42,710 [28] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1474) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:43:42,711 [28] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:43:42,712 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:43:42,713 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:43:42,714 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:39:00')
        else update users_cache set var_value = substring('2021/03/01 22:39:00', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:43:42,714 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:43:42')
        else update users_cache set var_value = substring('2021/03/01 22:43:42', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:44:13,524 [36] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:44:13,525 [36] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:13,526 [36] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:13,527 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:13,527 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:13,528 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:13,528 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:13,529 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:13,529 [36] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:13,530 [36] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:13,530 [36] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:13,530 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:13,531 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:13,531 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:13,532 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:13,532 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:13,532 [36] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:13,533 [36] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:13,533 [36] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:13,534 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:13,534 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:13,535 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:13,536 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:13,536 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:13,537 [36] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:13,538 [36] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:44:14,092 [5] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:44:14,094 [5] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:14,096 [5] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:14,097 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:14,099 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:14,100 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:14,101 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:14,103 [5] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:14,104 [5] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:14,104 [5] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:14,105 [5] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:14,106 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:14,106 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:14,106 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:14,108 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:14,109 [5] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:14,109 [5] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:14,109 [5] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:14,111 [5] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:14,112 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:14,112 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:14,112 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:14,113 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:14,113 [5] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:14,114 [5] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:14,115 [5] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:44:14,125 [5] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:44:14,128 [5] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:44:14,130 [5] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:44:14,131 [5] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:44:14,133 [5] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:44:14,135 [5] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:44:14,136 [5] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:44:14,138 [5] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:44:14,141 [5] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:44:14,142 [5] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:44:14,143 [5] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:44:14,144 [5] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:44:14,157 [5] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:44:14,158 [5] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:44:15,174 [5] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1853 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1853, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:39:00', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:39:00', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:44:15,190 [5] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1853 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1853, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:44:15,196 [5] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1474) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:44:15,202 [5] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:44:15,209 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:44:15,212 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:44:15,216 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:39:00')
        else update users_cache set var_value = substring('2021/03/01 22:39:00', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:44:15,221 [5] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:44:15')
        else update users_cache set var_value = substring('2021/03/01 22:44:15', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:44:40,249 [11] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:44:40,250 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:40,251 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:40,252 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:40,253 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:40,253 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:40,254 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:40,254 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:40,255 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:40,255 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:40,256 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:40,256 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:40,257 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:40,257 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:40,258 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:40,258 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:40,258 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:40,259 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:40,259 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:40,260 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:40,260 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:40,261 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:40,261 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:40,262 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:40,262 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:40,263 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:44:40,820 [28] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:44:40,821 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:40,822 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:40,823 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:40,824 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:40,825 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:40,826 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:40,826 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:40,827 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:40,828 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:40,828 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:40,829 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:40,830 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:40,831 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:40,831 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:40,832 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:40,833 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:40,833 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:44:40,834 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:44:40,835 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:44:40,836 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:44:40,836 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:44:40,837 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:44:40,838 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:44:40,839 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:44:40,840 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:44:40,851 [28] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:44:40,853 [28] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:44:40,854 [28] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:44:40,855 [28] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:44:40,856 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:44:40,857 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:44:40,858 [28] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:44:40,859 [28] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:44:40,860 [28] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:44:40,861 [28] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:44:40,862 [28] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:44:40,862 [28] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:44:40,873 [28] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:44:40,874 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.ok.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.ok.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:44:40,878 [28] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.ok.task
2021-03-01 22:46:28,123 [28] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.ok.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:46:28,124 [28] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1854
2021-03-01 22:46:28,127 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1854 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1854, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:39:00', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:39:00', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:46:28,134 [28] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:46:28,135 [28] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1854 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1854, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:46:28,142 [28] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:46:28,144 [28] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4352;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4352, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:46:28,151 [28] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:46:28,152 [28] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1475;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1475, 4352, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:46:28,155 [28] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:46:28,156 [28] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1475) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:46:28,166 [28] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:46:28,174 [28] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:46:28,174 [28] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:46:28,175 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:46:28,181 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:46:28,185 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:39:00')
        else update users_cache set var_value = substring('2021/03/01 22:39:00', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:46:28,192 [28] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:46:28')
        else update users_cache set var_value = substring('2021/03/01 22:46:28', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:47:46,627 [68] INFO dn_lib.tools.log - reload core
2021-03-01 22:47:46,658 [68] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:46,660 [68] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,661 [68] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,662 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,664 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,665 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,678 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,681 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,682 [68] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,683 [68] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,685 [68] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,686 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,686 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,688 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,688 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,689 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,690 [68] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,690 [68] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,697 [68] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,699 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,700 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,701 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,703 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,704 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,704 [68] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,706 [68] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:46,733 [72] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:46,735 [72] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,736 [72] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,737 [72] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,738 [72] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,738 [72] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,739 [72] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,740 [72] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,740 [72] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,741 [72] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,741 [72] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,742 [72] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,742 [72] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,743 [72] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,743 [72] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,744 [72] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,744 [72] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,745 [72] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,745 [72] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,746 [72] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,747 [72] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,747 [72] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,748 [72] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,748 [72] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,749 [72] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,749 [72] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:46,780 [66] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:46,781 [66] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,782 [66] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,783 [66] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,784 [66] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,785 [66] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,786 [66] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,786 [66] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,786 [66] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,787 [66] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,789 [66] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,789 [66] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,789 [66] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,791 [66] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,791 [66] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,791 [66] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,792 [66] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,793 [66] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:46,793 [66] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:46,794 [66] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:46,795 [66] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:46,795 [66] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:46,796 [66] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:46,796 [66] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:46,797 [66] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:46,800 [66] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:46,823 [66] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 22:47:46,828 [66] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 22:47:46,833 [66] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 22:47:46,842 [66] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 22:47:46,853 [66] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 22:47:46,876 [66] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 22:47:46,889 [66] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 22:47:46,965 [66] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 22:47:46,969 [66] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 22:47:46,972 [66] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 22:47:51,506 [28] INFO dn_lib.tools.log - reload core
2021-03-01 22:47:51,567 [28] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:51,569 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,570 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,571 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,572 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,573 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,574 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,575 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,575 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,576 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,577 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,578 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,580 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,582 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,583 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,584 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,585 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,586 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,606 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,608 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,609 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,610 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,611 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,612 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,613 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,615 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:51,705 [55] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:51,706 [55] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,707 [55] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,708 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,709 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,710 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,711 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,712 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,713 [55] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,714 [55] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,715 [55] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,715 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,717 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,718 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,718 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,719 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,719 [55] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,720 [55] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,720 [55] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,721 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,721 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,721 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,722 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,722 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,723 [55] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,723 [55] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:51,791 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:51,792 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,792 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,793 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,793 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,794 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,795 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,795 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,796 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,797 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,797 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,798 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,798 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,799 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,800 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,801 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,802 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,802 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:51,803 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:51,804 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:51,804 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:51,805 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:51,805 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:51,806 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:51,806 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:51,810 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:51,834 [51] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 22:47:51,838 [51] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 22:47:51,842 [51] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 22:47:51,845 [51] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 22:47:51,849 [51] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 22:47:51,861 [51] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 22:47:51,873 [51] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 22:47:51,960 [51] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 22:47:51,960 [51] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 22:47:51,962 [51] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 22:47:55,241 [28] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:55,242 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,244 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,244 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,245 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,246 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,246 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,247 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,247 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,248 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,249 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,249 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,250 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,251 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,252 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,252 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,253 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,253 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,254 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,254 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,255 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,255 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,256 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,256 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,257 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,257 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:55,286 [55] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:55,287 [55] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,287 [55] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,288 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,289 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,290 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,290 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,291 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,292 [55] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,292 [55] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,293 [55] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,293 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,294 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,295 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,295 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,296 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,296 [55] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,297 [55] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,298 [55] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,299 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,300 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,301 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,302 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,302 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,303 [55] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,304 [55] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:55,340 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:55,341 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,342 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,342 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,343 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,343 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,344 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,345 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,345 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,345 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,346 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,346 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,347 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,347 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,347 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,348 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,348 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,349 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,349 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,350 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,350 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,351 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,351 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,352 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,352 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,353 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:55,911 [68] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:47:55,913 [68] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,914 [68] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,915 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,915 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,916 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,918 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,919 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,919 [68] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,920 [68] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,920 [68] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,921 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,922 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,922 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,923 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,924 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,924 [68] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,925 [68] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:47:55,925 [68] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:47:55,926 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:47:55,926 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:47:55,927 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:47:55,927 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:47:55,928 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:47:55,928 [68] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:47:55,929 [68] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:47:55,977 [68] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:47:55,979 [68] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:47:55,983 [68] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:47:55,986 [68] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:47:55,990 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:47:55,992 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:47:55,993 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:47:55,996 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:47:56,003 [68] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:47:56,005 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:47:56,006 [68] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:47:56,008 [68] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:47:56,021 [68] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:47:56,023 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:47:57,156 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1854 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1854, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:39:00', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:39:00', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:47:57,163 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1854 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1854, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:47:57,169 [68] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1475) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:47:57,176 [68] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:47:57,182 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:47:57,186 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:47:57,189 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:39:00')
        else update users_cache set var_value = substring('2021/03/01 22:39:00', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:47:57,193 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:47:57')
        else update users_cache set var_value = substring('2021/03/01 22:47:57', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:48:42,801 [28] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:48:42,803 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:42,804 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:42,805 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:42,805 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:42,806 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:42,807 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:42,808 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:42,809 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:42,810 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:42,811 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:42,811 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:42,811 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:42,812 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:42,812 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:42,813 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:42,813 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:42,814 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:42,814 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:42,815 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:42,815 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:42,816 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:42,816 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:42,817 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:42,817 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:42,819 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:48:43,373 [64] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:48:43,374 [64] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:43,375 [64] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:43,377 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:43,377 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:43,378 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:43,379 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:43,380 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:43,381 [64] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:43,382 [64] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:43,382 [64] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:43,383 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:43,384 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:43,385 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:43,385 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:43,386 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:43,387 [64] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:43,388 [64] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:43,388 [64] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:43,389 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:43,390 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:43,391 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:43,391 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:43,392 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:43,392 [64] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:43,393 [64] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:48:43,403 [64] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:48:43,406 [64] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:48:43,408 [64] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:48:43,409 [64] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:48:43,411 [64] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:48:43,413 [64] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:48:43,414 [64] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:48:43,415 [64] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:48:43,417 [64] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:48:43,418 [64] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:48:43,419 [64] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:48:43,420 [64] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:48:43,433 [64] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:48:43,435 [64] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.ok.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.ok.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:48:43,440 [64] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.ok.task
2021-03-01 22:48:44,044 [64] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.ok.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:48:44,045 [64] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1855
2021-03-01 22:48:44,063 [64] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\mimmo.task\__i.xml
2021-03-01 22:48:44,064 [64] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1855 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1855, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:48:44', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:48:44', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:48:44,071 [64] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:48:44,072 [64] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1855 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1855, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:48:44,080 [64] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:48:44,082 [64] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4353;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4353, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:48:44,084 [64] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:48:44,086 [64] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1476;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1476, 4353, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:48:44,089 [64] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:48:44,090 [64] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1476) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:48:44,098 [64] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:48:44,109 [64] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:48:44,110 [64] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:48:44,111 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:48:44,115 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:48:44,118 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:39:00')
        else update users_cache set var_value = substring('2021/03/01 22:39:00', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:48:44,121 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:48:44')
        else update users_cache set var_value = substring('2021/03/01 22:48:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:48:46,570 [28] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:48:46,572 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:46,573 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:46,574 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:46,575 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:46,576 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:46,577 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:46,577 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:46,578 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:46,579 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:46,579 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:46,580 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:46,580 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:46,581 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:46,581 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:46,582 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:46,582 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:46,583 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:46,583 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:46,584 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:46,584 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:46,584 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:46,585 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:46,585 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:46,586 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:46,586 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:48:47,142 [55] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:48:47,144 [55] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:47,145 [55] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:47,146 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:47,148 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:47,149 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:47,150 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:47,151 [55] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:47,152 [55] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:47,153 [55] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:47,154 [55] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:47,154 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:47,155 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:47,156 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:47,156 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:47,157 [55] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:47,158 [55] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:47,158 [55] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:48:47,158 [55] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:48:47,158 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:48:47,158 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:48:47,158 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:48:47,162 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:48:47,162 [55] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:48:47,162 [55] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:48:47,162 [55] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:48:47,172 [55] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:48:47,182 [55] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:48:47,182 [55] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:48:47,182 [55] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:48:47,187 [55] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:48:47,197 [55] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:48:47,197 [55] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:48:47,665 [55] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1855 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1855, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:48:44', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:48:44', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:48:47,667 [55] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1855 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1855, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:48:47,668 [55] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1476) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:48:47,669 [55] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:48:47,669 [55] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:48:47,670 [55] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:48:47,671 [55] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:48:44')
        else update users_cache set var_value = substring('2021/03/01 22:48:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:48:47,673 [55] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:48:47')
        else update users_cache set var_value = substring('2021/03/01 22:48:47', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:49:37,543 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:49:37,544 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:49:37,544 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:49:37,545 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:49:37,546 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:49:37,546 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:49:37,547 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:49:37,547 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:49:37,548 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:49:37,549 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:49:37,550 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:49:37,551 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:49:37,551 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:49:37,552 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:49:37,552 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:49:37,553 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:49:37,553 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:49:37,554 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:49:37,554 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:49:37,555 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:49:37,555 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:49:37,555 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:49:37,556 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:49:37,556 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:49:37,557 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:49:37,558 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:49:38,115 [68] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:49:38,116 [68] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:49:38,117 [68] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:49:38,118 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:49:38,119 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:49:38,120 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:49:38,121 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:49:38,121 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:49:38,122 [68] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:49:38,123 [68] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:49:38,123 [68] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:49:38,124 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:49:38,124 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:49:38,125 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:49:38,125 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:49:38,125 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:49:38,126 [68] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:49:38,126 [68] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:49:38,127 [68] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:49:38,127 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:49:38,128 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:49:38,128 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:49:38,129 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:49:38,129 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:49:38,130 [68] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:49:38,130 [68] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:49:38,133 [68] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:49:38,141 [68] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:49:38,141 [68] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:49:38,141 [68] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:49:38,141 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:49:38,141 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:49:38,141 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:49:38,141 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:49:38,152 [68] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:49:38,152 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:49:38,152 [68] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:49:38,152 [68] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:49:38,167 [68] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:49:38,167 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.molinero.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.molinero.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:49:38,171 [68] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.molinero.task
2021-03-01 22:50:21,702 [68] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.molinero.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:50:21,702 [68] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1856
2021-03-01 22:50:21,732 [68] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\mimmo.task\__i.xml
2021-03-01 22:50:21,732 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1856 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1856, null, left('mimmo', 150)
            , 'molinero', convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-03-01 22:50:21', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = 'molinero'
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:50:21', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull('molinero', '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:50:21,732 [68] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:50:21,732 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1856 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1856, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:50:21,742 [68] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:50:21,742 [68] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4354;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4354, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:50:21,742 [68] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:50:21,742 [68] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1477;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1477, 4354, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:50:21,751 [68] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:50:21,751 [68] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1477) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:50:21,751 [68] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:50:21,762 [68] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:50:21,762 [68] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:50:21,762 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:50:21,772 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:50:21,772 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:48:44')
        else update users_cache set var_value = substring('2021/03/01 22:48:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:50:21,772 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:50:21')
        else update users_cache set var_value = substring('2021/03/01 22:50:21', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:51:06,595 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:51:06,596 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:06,597 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:06,598 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:06,598 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:06,599 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:06,600 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:06,600 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:06,601 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:06,602 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:06,603 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:06,604 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:06,605 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:06,605 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:06,606 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:06,606 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:06,607 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:06,608 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:06,608 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:06,609 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:06,609 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:06,610 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:06,610 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:06,610 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:06,611 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:06,611 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:51:07,168 [68] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:51:07,170 [68] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:07,171 [68] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:07,173 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:07,174 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:07,176 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:07,177 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:07,177 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:07,178 [68] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:07,179 [68] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:07,179 [68] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:07,180 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:07,180 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:07,181 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:07,182 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:07,182 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:07,183 [68] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:07,184 [68] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:07,184 [68] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:07,185 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:07,185 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:07,185 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:07,185 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:07,185 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:07,185 [68] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:07,185 [68] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:51:07,191 [68] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:51:07,202 [68] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:51:07,202 [68] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:51:07,202 [68] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:51:07,202 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:51:07,202 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:51:07,211 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:51:07,211 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:51:07,211 [68] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:51:07,211 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:51:07,211 [68] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:51:07,211 [68] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:51:07,231 [68] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:51:07,231 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.alta.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.alta.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:51:07,231 [68] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.alta.task
2021-03-01 22:51:07,953 [68] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.alta.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 22:51:07,953 [68] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1857
2021-03-01 22:51:07,972 [68] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\mimmo.task\__i.xml
2021-03-01 22:51:07,972 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1857 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1857, null, left('mimmo', 150)
            , 'molinero', convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'fatto', 'alta', NULL, NULL, convert(datetime, '2021-03-01 22:51:07', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = 'molinero'
         , stato = 'fatto', priorita = 'alta'
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:51:07', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull('molinero', '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull('alta', '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:51:07,972 [68] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 22:51:07,981 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1857 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1857, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:51:07,981 [68] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:51:07,981 [68] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4355;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4355, '.txt', @content, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:51:07,988 [68] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:51:07,988 [68] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1478;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1478, 4355, @content
          , convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
2021-03-01 22:51:07,991 [68] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 22:51:07,991 [68] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1478) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:51:08,002 [68] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:51:08,002 [68] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 22:51:08,002 [68] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 22:51:08,011 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:51:08,011 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:51:08,011 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:50:21')
        else update users_cache set var_value = substring('2021/03/01 22:50:21', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:51:08,021 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:51:08')
        else update users_cache set var_value = substring('2021/03/01 22:51:08', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:51:10,168 [69] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:51:10,170 [69] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:10,171 [69] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:10,171 [69] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:10,172 [69] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:10,172 [69] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:10,173 [69] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:10,173 [69] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:10,174 [69] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:10,174 [69] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:10,175 [69] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:10,175 [69] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:10,175 [69] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:10,176 [69] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:10,176 [69] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:10,176 [69] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:10,177 [69] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:10,177 [69] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:10,178 [69] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:10,178 [69] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:10,178 [69] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:10,179 [69] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:10,179 [69] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:10,180 [69] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:10,180 [69] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:10,181 [69] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:51:10,742 [64] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:51:10,742 [64] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:10,742 [64] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:10,751 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:51:10,761 [64] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:51:10,761 [64] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:51:10,777 [64] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:51:10,777 [64] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:51:10,777 [64] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:51:10,777 [64] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:51:10,782 [64] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:51:10,798 [64] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:51:10,798 [64] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:51:12,231 [64] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1857 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1857, null, left('mimmo', 150)
            , 'molinero', convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'fatto', 'alta', NULL, NULL, convert(datetime, '2021-03-01 22:51:07', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = 'molinero'
         , stato = 'fatto', priorita = 'alta'
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:51:07', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull('molinero', '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull('alta', '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:51:12,245 [64] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1857 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1857, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:51:12,245 [64] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1478) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:51:12,245 [64] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:51:12,245 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:51:12,245 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:51:12,245 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:51:07')
        else update users_cache set var_value = substring('2021/03/01 22:51:07', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:51:12,252 [64] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:51:12')
        else update users_cache set var_value = substring('2021/03/01 22:51:12', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:52:23,964 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:52:23,965 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:52:23,966 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:52:23,966 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:52:23,967 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:52:23,968 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:52:23,968 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:52:23,969 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:52:23,969 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:52:23,970 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:52:23,970 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:52:23,971 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:52:23,971 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:52:23,973 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:52:23,974 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:52:23,974 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:52:23,975 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:52:23,975 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:52:23,976 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:52:23,976 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:52:23,977 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:52:23,977 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:52:23,978 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:52:23,978 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:52:23,979 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:52:23,979 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:52:24,538 [68] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:52:24,539 [68] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:52:24,540 [68] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:52:24,541 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:52:24,542 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:52:24,543 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:52:24,544 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:52:24,545 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:52:24,545 [68] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:52:24,546 [68] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:52:24,547 [68] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:52:24,548 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:52:24,549 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:52:24,549 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:52:24,550 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:52:24,551 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:52:24,552 [68] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:52:24,553 [68] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:52:24,553 [68] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:52:24,554 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:52:24,555 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:52:24,556 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:52:24,556 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:52:24,556 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:52:24,556 [68] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:52:24,556 [68] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:52:24,561 [68] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 22:52:24,571 [68] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:52:24,571 [68] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 22:52:24,571 [68] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 22:52:24,571 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 22:52:24,571 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 22:52:24,571 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 22:52:24,581 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:52:24,581 [68] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 22:52:24,581 [68] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 22:52:24,581 [68] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 22:52:24,581 [68] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 22:52:24,597 [68] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 22:52:24,597 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 22:29:42', 120), convert(datetime, '2021-03-01 22:30:10', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 22:29:42', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:10', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:42', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:10', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 22:52:46,631 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1857 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1857, null, left('mimmo', 150)
            , 'molinero', convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'in_corso', 'alta', NULL, NULL, convert(datetime, '2021-03-01 22:52:20', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = 'molinero'
         , stato = 'in_corso', priorita = 'alta'
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 22:52:20', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull('molinero', '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull('alta', '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:52:50,588 [68] DEBUG dn_lib.tools.log - aggiornato task nel database: mimmo
2021-03-01 22:52:50,590 [68] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1857 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1857, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 22:29:59', 120), convert(datetime, '2021-03-01 22:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 22:29:59', 120), dt_lwt = convert(datetime, '2021-03-01 22:30:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 22:29:59', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 22:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 22:52:50,596 [68] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1478) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 22:52:50,604 [68] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 22:52:50,609 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 22:52:50,613 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 22:52:50,616 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 22:52:20')
        else update users_cache set var_value = substring('2021/03/01 22:52:20', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 22:52:50,620 [68] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 22:52:50')
        else update users_cache set var_value = substring('2021/03/01 22:52:50', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 22:53:08,227 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:53:08,228 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,229 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,231 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,232 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,233 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,234 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,235 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,235 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,236 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,236 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,237 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,237 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,238 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,238 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,238 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,239 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,239 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,240 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,240 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,240 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,241 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,241 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,242 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,242 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,242 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:53:08,277 [68] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:53:08,278 [68] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,278 [68] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,279 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,280 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,281 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,282 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,282 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,283 [68] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,284 [68] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,284 [68] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,284 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,285 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,285 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,285 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,286 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,286 [68] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,287 [68] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,287 [68] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,287 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,288 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,288 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,289 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,289 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,289 [68] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,290 [68] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:53:08,326 [64] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:53:08,327 [64] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,328 [64] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,328 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,329 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,330 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,330 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,331 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,332 [64] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,333 [64] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,333 [64] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,334 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,334 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,335 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,336 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,336 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,336 [64] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,337 [64] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:08,337 [64] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:08,338 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:08,338 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:08,338 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:08,339 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:08,339 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:08,340 [64] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:08,340 [64] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:53:08,350 [64] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 22:53:08,352 [64] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 22:53:08,354 [64] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 22:53:08,363 [64] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 22:53:08,369 [64] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 22:53:08,385 [64] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 22:53:08,388 [64] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 22:53:08,391 [64] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 22:53:08,392 [64] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 22:53:08,395 [64] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 22:53:35,641 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:53:35,642 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:35,643 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:35,644 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:35,644 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:35,644 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:35,644 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:35,647 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:35,647 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:35,649 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:35,649 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:35,649 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:35,651 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:35,651 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:35,651 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:35,651 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:35,651 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:35,651 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:35,651 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:35,656 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:35,656 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:35,658 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:35,658 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:35,658 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:35,660 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:35,660 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:53:35,671 [51] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:53:35,671 [51] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1478) t2
2021-03-01 22:53:35,701 [51] ERROR dn_lib.tools.log - error
System.IO.IOException: Accesso al percorso 'C:\root\todd\_test\dn' negato.
   in System.IO.Directory.InternalMove(String sourceDirName, String destDirName, Boolean checkHost)
   in deepanotes.notes.update_task(Int32 task_id, String& rel_path, List`1 fl, String title, String assegna, String stato, String priorita, String stima, String tipo) in c:\root\todd\git\dn\deepanotes\App_Code\notes.cs:riga 226
   in _notes.OnInit(EventArgs e) in c:\root\todd\git\dn\deepanotes\notes.aspx.cs:riga 97
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:54,011 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:53:54,021 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:53:54,031 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:53:54,031 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:53:54,031 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:53:54,041 [51] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:53:54,041 [51] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1478) t2
2021-03-01 22:53:54,051 [51] ERROR dn_lib.tools.log - error
System.IO.IOException: Accesso al percorso 'C:\root\todd\_test\dn' negato.
   in System.IO.Directory.InternalMove(String sourceDirName, String destDirName, Boolean checkHost)
   in deepanotes.notes.update_task(Int32 task_id, String& rel_path, List`1 fl, String title, String assegna, String stato, String priorita, String stima, String tipo) in c:\root\todd\git\dn\deepanotes\App_Code\notes.cs:riga 226
   in _notes.OnInit(EventArgs e) in c:\root\todd\git\dn\deepanotes\notes.aspx.cs:riga 97
2021-03-01 22:54:16,611 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:54:16,611 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:54:16,611 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:54:16,611 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:54:16,611 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:54:16,611 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:54:16,611 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:54:16,621 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:54:16,631 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:54:16,631 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:54:16,631 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:54:16,631 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:54:22,325 [51] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 22:55:31,271 [51] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1478) t2
2021-03-01 22:56:35,941 [51] ERROR dn_lib.tools.log - error
System.IO.IOException: Accesso al percorso 'C:\root\todd\_test\dn' negato.
   in System.IO.Directory.InternalMove(String sourceDirName, String destDirName, Boolean checkHost)
   in deepanotes.notes.update_task(Int32 task_id, String& rel_path, List`1 fl, String title, String assegna, String stato, String priorita, String stima, String tipo) in c:\root\todd\git\dn\deepanotes\App_Code\notes.cs:riga 226
   in _notes.OnInit(EventArgs e) in c:\root\todd\git\dn\deepanotes\notes.aspx.cs:riga 97
2021-03-01 22:56:44,971 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 22:56:44,980 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:56:44,981 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 22:56:44,991 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 22:56:44,991 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 22:56:50,030 [51] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:00:45,728 [51] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1478) t2
2021-03-01 23:00:45,736 [51] ERROR dn_lib.tools.log - error
System.IO.IOException: Accesso al percorso 'C:\root\todd\_test\dn' negato.
   in System.IO.Directory.InternalMove(String sourceDirName, String destDirName, Boolean checkHost)
   in deepanotes.notes.update_task(Int32 task_id, String& rel_path, List`1 fl, String title, String assegna, String stato, String priorita, String stima, String tipo) in c:\root\todd\git\dn\deepanotes\App_Code\notes.cs:riga 226
   in _notes.OnInit(EventArgs e) in c:\root\todd\git\dn\deepanotes\notes.aspx.cs:riga 97
2021-03-01 23:03:57,208 [51] INFO dn_lib.tools.log - reload core
2021-03-01 23:03:57,242 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:03:57,245 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,246 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,247 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,248 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,248 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,249 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,250 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,250 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,251 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,252 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,253 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,253 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,255 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,255 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,256 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,257 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,257 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,273 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,275 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,278 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,279 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,280 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,281 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,282 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,283 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:03:57,574 [64] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:03:57,575 [64] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,576 [64] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,577 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,579 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,580 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,581 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,581 [64] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,582 [64] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,583 [64] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,583 [64] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,584 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,585 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,585 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,586 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,587 [64] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,587 [64] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,588 [64] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,588 [64] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,589 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,590 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,591 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,592 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,593 [64] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,594 [64] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,594 [64] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:03:57,667 [68] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:03:57,668 [68] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,669 [68] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,670 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,671 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,671 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,672 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,673 [68] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,674 [68] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,674 [68] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,675 [68] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,677 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,678 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,679 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,680 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,681 [68] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,682 [68] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,682 [68] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:03:57,683 [68] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:03:57,684 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:03:57,684 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:03:57,685 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:03:57,685 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:03:57,686 [68] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:03:57,687 [68] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:03:57,692 [68] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:03:57,721 [68] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:03:57,727 [68] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:03:57,733 [68] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:03:57,744 [68] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:03:57,754 [68] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:03:57,787 [68] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:03:57,801 [68] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:03:57,886 [68] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:03:57,888 [68] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:03:57,891 [68] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:04:02,833 [51] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:04:02,835 [51] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:04:02,836 [51] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:04:02,837 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:04:02,838 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:04:02,838 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:04:02,839 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:04:02,840 [51] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:04:02,841 [51] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:04:02,842 [51] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:04:02,843 [51] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:04:02,844 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:04:02,844 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:04:02,845 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:04:02,846 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:04:02,846 [51] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:04:02,847 [51] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:04:02,848 [51] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:04:02,849 [51] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:04:02,849 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:04:02,850 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:04:02,851 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:04:02,852 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:04:02,852 [51] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:04:02,853 [51] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:04:02,853 [51] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:04:08,653 [51] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:04:18,890 [51] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1478) t2
2021-03-01 23:05:01,510 [51] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1857
2021-03-01 23:05:01,523 [51] DEBUG dn_lib.tools.log - SQL: update dn_tasks set stato = 'sospeso' where task_id = 1478
2021-03-01 23:05:01,538 [51] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_lwt_idex = convert(datetime, '2021-03-01 23:05:01', 120) 
        where task_id = 1478;
2021-03-01 23:05:01,541 [51] ERROR dn_lib.tools.log - sql: update dn_tasks set dt_lwt_idex = convert(datetime, '2021-03-01 23:05:01', 120) 
        where task_id = 1478;
System.Data.SqlClient.SqlException (0x80131904): Il nome di colonna 'dt_lwt_idex' non  valido.
   in System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   in System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   in System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   in System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   in System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   in System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   in dn_lib.db.db_provider.execute(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 384
ClientConnectionId:42547e5f-4d47-465e-9c79-c7beda7cd9a9
Error Number:207,State:1,Class:16
2021-03-01 23:05:01,553 [51] ERROR dn_lib.tools.log - error
System.Data.SqlClient.SqlException (0x80131904): Il nome di colonna 'dt_lwt_idex' non  valido.
   in dn_lib.db.db_provider.execute(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 403
   in dn_lib.db.db_provider.exec(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 360
   in deepanotes.notes.update_task(Int32 task_id, String& rel_path, List`1 fl, String title, String assegna, String stato, String priorita, String stima, String tipo) in c:\root\todd\git\dn\deepanotes\App_Code\notes.cs:riga 276
   in _notes.OnInit(EventArgs e) in c:\root\todd\git\dn\deepanotes\notes.aspx.cs:riga 97
ClientConnectionId:42547e5f-4d47-465e-9c79-c7beda7cd9a9
Error Number:207,State:1,Class:16
2021-03-01 23:11:49,975 [124] INFO dn_lib.tools.log - reload core
2021-03-01 23:11:50,008 [124] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:50,010 [124] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,010 [124] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,011 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,013 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,014 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,026 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,028 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,037 [124] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,038 [124] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,039 [124] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,040 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,040 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,042 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,043 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,043 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,044 [124] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,045 [124] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,052 [124] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,053 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,054 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,055 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,056 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,057 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,057 [124] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,059 [124] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:50,089 [115] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:50,090 [115] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,090 [115] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,091 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,092 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,092 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,093 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,094 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,095 [115] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,095 [115] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,096 [115] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,097 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,097 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,098 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,098 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,099 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,100 [115] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,100 [115] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,101 [115] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,102 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,102 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,103 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,103 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,104 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,104 [115] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,105 [115] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:50,137 [120] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:50,138 [120] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,138 [120] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,139 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,140 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,141 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,141 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,142 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,143 [120] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,143 [120] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,144 [120] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,144 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,145 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,145 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,146 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,146 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,147 [120] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,147 [120] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:50,148 [120] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:50,148 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:50,149 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:50,150 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:50,150 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:50,151 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:50,151 [120] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:50,154 [120] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:50,176 [120] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:11:50,181 [120] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:11:50,187 [120] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:11:50,196 [120] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:11:50,206 [120] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:11:50,230 [120] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:11:50,244 [120] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:11:50,325 [120] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:11:50,327 [120] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:11:50,329 [120] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:11:56,057 [114] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:56,058 [114] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,060 [114] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,061 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,062 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,062 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,063 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,064 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,065 [114] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,066 [114] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,067 [114] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,068 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,068 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,069 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,070 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,070 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,071 [114] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,071 [114] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,072 [114] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,072 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,073 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,073 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,074 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,074 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,075 [114] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,076 [114] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:56,088 [124] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:56,089 [124] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,090 [124] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,090 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,091 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,091 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,092 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,092 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,093 [124] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,094 [124] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,094 [124] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,094 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,095 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,095 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,095 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,096 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,096 [124] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,096 [124] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,097 [124] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,098 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,099 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,099 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,100 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,100 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,101 [124] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,101 [124] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:56,113 [116] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:56,114 [116] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,115 [116] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,116 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,116 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,117 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,117 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,118 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,118 [116] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,119 [116] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,119 [116] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,119 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,120 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,120 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,121 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,121 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,121 [116] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,122 [116] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,122 [116] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,122 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,123 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,123 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,124 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,124 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,124 [116] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,125 [116] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:56,685 [122] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:56,686 [122] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,687 [122] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,688 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,688 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,689 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,690 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,690 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,691 [122] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,692 [122] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,692 [122] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,693 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,693 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,694 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,695 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,695 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,696 [122] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,697 [122] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:56,697 [122] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:56,698 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:56,699 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:56,699 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:56,700 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:56,701 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:56,701 [122] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:56,702 [122] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:56,750 [122] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 23:11:56,752 [122] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:11:56,754 [122] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 23:11:56,756 [122] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 23:11:56,759 [122] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 23:11:56,761 [122] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 23:11:56,762 [122] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 23:11:56,764 [122] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:11:56,769 [122] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 23:11:56,770 [122] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:11:56,771 [122] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 23:11:56,773 [122] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 23:11:56,777 [122] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 23:11:56,778 [122] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 23:11:56,787 [122] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 23:11:56,788 [122] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 23:11:56,788 [122] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 23:11:56,792 [122] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 23:11:56,795 [122] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 23:11:56,798 [122] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 23:11:56')
        else update users_cache set var_value = substring('2021/03/01 23:11:56', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 23:11:57,871 [114] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:57,872 [114] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:57,873 [114] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:57,874 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:57,874 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:57,875 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:57,875 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:57,876 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:57,876 [114] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:57,877 [114] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:57,877 [114] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:57,877 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:57,878 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:57,878 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:57,878 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:57,879 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:57,879 [114] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:57,880 [114] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:57,880 [114] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:57,881 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:57,881 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:57,882 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:57,882 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:57,882 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:57,883 [114] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:57,883 [114] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:58,433 [115] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:11:58,434 [115] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:58,435 [115] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:58,436 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:58,437 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:58,438 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:58,439 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:58,439 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:58,440 [115] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:58,440 [115] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:58,441 [115] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:58,441 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:58,442 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:58,442 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:58,443 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:58,443 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:58,445 [115] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:58,445 [115] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:11:58,446 [115] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:11:58,446 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:11:58,447 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:11:58,447 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:11:58,448 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:11:58,449 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:11:58,449 [115] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:11:58,450 [115] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:11:58,459 [115] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 23:11:58,460 [115] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:11:58,461 [115] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 23:11:58,461 [115] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 23:11:58,462 [115] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 23:11:58,462 [115] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 23:11:58,463 [115] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 23:11:58,464 [115] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:11:58,466 [115] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 23:11:58,466 [115] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:11:58,467 [115] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 23:11:58,468 [115] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 23:11:58,468 [115] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 23:11:58,469 [115] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 23:11:58,470 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 23:11:58,471 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 23:11:58,471 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 23:11:58,472 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 23:11:58')
        else update users_cache set var_value = substring('2021/03/01 23:11:58', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 23:12:30,314 [124] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:12:30,316 [124] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:30,317 [124] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:30,318 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:30,319 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:30,320 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:30,320 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:30,321 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:30,322 [124] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:30,323 [124] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:30,323 [124] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:30,324 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:30,325 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:30,326 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:30,327 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:30,328 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:30,329 [124] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:30,330 [124] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:30,330 [124] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:30,331 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:30,332 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:30,332 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:30,333 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:30,333 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:30,334 [124] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:30,334 [124] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:12:30,889 [116] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:12:30,891 [116] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:30,893 [116] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:30,894 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:30,895 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:30,896 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:30,897 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:30,898 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:30,899 [116] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:30,900 [116] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:30,900 [116] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:30,901 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:30,902 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:30,902 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:30,903 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:30,904 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:30,904 [116] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:30,905 [116] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:30,905 [116] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:30,906 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:30,906 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:30,907 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:30,907 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:30,908 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:30,908 [116] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:30,909 [116] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:12:30,918 [116] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 23:12:30,920 [116] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:12:30,921 [116] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 23:12:30,921 [116] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 23:12:30,922 [116] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 23:12:30,923 [116] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 23:12:30,924 [116] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 23:12:30,925 [116] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:12:30,926 [116] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 23:12:30,927 [116] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:12:30,928 [116] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 23:12:30,930 [116] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 23:12:30,931 [116] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 23:12:30,932 [116] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20200101.20200303.mimmo.ok.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20200101.20200303.mimmo.ok.task', 1, convert(datetime, '2021-03-01 23:12:02', 120), convert(datetime, '2021-03-01 23:12:18', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 23:12:02', 120), dt_lwt = convert(datetime, '2021-03-01 23:12:18', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:02', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:18', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 23:12:30,944 [116] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20200101.20200303.mimmo.ok.task
2021-03-01 23:12:30,954 [116] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20200101.20200303.mimmo.ok.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 23:12:30,955 [116] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1858
2021-03-01 23:12:30,960 [116] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\mimmo.task\__i.xml
2021-03-01 23:12:30,961 [116] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1858 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1858, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-03-01 23:12:30', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 23:12:30', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 23:12:30,967 [116] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 23:12:30,969 [116] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1858 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1858, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 23:12:17', 120), convert(datetime, '2021-03-01 23:12:26', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 23:12:17', 120), dt_lwt = convert(datetime, '2021-03-01 23:12:26', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:17', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:26', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 23:12:30,974 [116] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 23:12:30,981 [116] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4356;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4356, '.txt', @content, convert(datetime, '2021-03-01 23:12:17', 120), convert(datetime, '2021-03-01 23:12:26', 120));
2021-03-01 23:12:30,984 [116] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 23:12:30,985 [116] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1479;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1479, 4356, @content
          , convert(datetime, '2021-03-01 23:12:17', 120), convert(datetime, '2021-03-01 23:12:26', 120));
2021-03-01 23:12:30,988 [116] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 23:12:30,989 [116] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1479) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 23:12:30,995 [116] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 23:12:30,997 [116] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 23:12:31,000 [116] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 23:12:31,003 [116] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 23:12:26')
        else update users_cache set var_value = substring('2021/03/01 23:12:26', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 23:12:31,006 [116] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 23:12:31')
        else update users_cache set var_value = substring('2021/03/01 23:12:31', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 23:12:32,460 [121] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:12:32,461 [121] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:32,462 [121] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:32,463 [121] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:32,464 [121] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:32,464 [121] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:32,465 [121] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:32,466 [121] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:32,466 [121] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:32,467 [121] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:32,467 [121] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:32,468 [121] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:32,469 [121] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:32,469 [121] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:32,470 [121] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:32,471 [121] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:32,471 [121] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:32,472 [121] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:32,472 [121] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:32,473 [121] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:32,474 [121] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:32,474 [121] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:32,475 [121] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:32,476 [121] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:32,476 [121] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:32,477 [121] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:12:33,033 [115] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:12:33,034 [115] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:33,036 [115] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:33,037 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:33,039 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:33,040 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:33,041 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:33,042 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:33,043 [115] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:33,044 [115] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:33,044 [115] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:33,045 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:33,045 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:33,046 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:33,047 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:33,047 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:33,048 [115] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:33,048 [115] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:12:33,049 [115] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:12:33,050 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:12:33,051 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:12:33,051 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:12:33,052 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:12:33,053 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:12:33,054 [115] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:12:33,054 [115] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:12:33,064 [115] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 23:12:33,066 [115] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:12:33,067 [115] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 23:12:33,067 [115] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 23:12:33,069 [115] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 23:12:33,070 [115] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 23:12:33,071 [115] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 23:12:33,071 [115] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:12:33,073 [115] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 23:12:33,073 [115] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:12:33,074 [115] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 23:12:33,075 [115] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 23:12:33,085 [115] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 23:12:33,085 [115] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.task', 1, convert(datetime, '2021-03-01 23:12:02', 120), convert(datetime, '2021-03-01 23:12:30', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 23:12:02', 120), dt_lwt = convert(datetime, '2021-03-01 23:12:30', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:02', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:30', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 23:12:33,090 [115] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\mimmo.task
2021-03-01 23:12:33,093 [115] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1858 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1858, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-03-01 23:12:30', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 23:12:30', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 23:12:33,095 [115] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1858 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1858, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 23:12:17', 120), convert(datetime, '2021-03-01 23:12:26', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 23:12:17', 120), dt_lwt = convert(datetime, '2021-03-01 23:12:26', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:17', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:26', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 23:12:33,097 [115] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1479) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 23:12:33,098 [115] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 23:12:33,099 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 23:12:33,102 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 23:12:33,104 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 23:12:30')
        else update users_cache set var_value = substring('2021/03/01 23:12:30', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 23:12:33,107 [115] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 23:12:33')
        else update users_cache set var_value = substring('2021/03/01 23:12:33', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 23:14:12,614 [120] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:12,616 [120] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,617 [120] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,618 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,619 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,620 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,620 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,621 [120] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,622 [120] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,622 [120] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,623 [120] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,623 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,624 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,624 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,625 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,626 [120] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,627 [120] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,627 [120] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,628 [120] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,628 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,629 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,629 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,630 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,630 [120] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,631 [120] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,632 [120] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:12,644 [119] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:12,645 [119] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,645 [119] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,646 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,647 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,647 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,648 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,648 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,649 [119] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,649 [119] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,649 [119] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,650 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,650 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,650 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,651 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,651 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,651 [119] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,652 [119] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,652 [119] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,653 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,653 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,654 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,655 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,655 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,656 [119] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,656 [119] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:12,668 [116] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:12,669 [116] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,670 [116] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,671 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,671 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,672 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,672 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,673 [116] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,674 [116] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,674 [116] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,675 [116] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,676 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,676 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,677 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,677 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,677 [116] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,678 [116] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,678 [116] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:12,678 [116] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:12,679 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:12,679 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:12,680 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:12,680 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:12,680 [116] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:12,681 [116] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:12,681 [116] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:13,238 [114] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:13,240 [114] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:13,241 [114] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:13,243 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:13,244 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:13,246 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:13,247 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:13,249 [114] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:13,250 [114] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:13,251 [114] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:13,252 [114] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:13,253 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:13,253 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:13,255 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:13,255 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:13,256 [114] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:13,257 [114] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:13,257 [114] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:13,258 [114] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:13,258 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:13,259 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:13,260 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:13,260 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:13,261 [114] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:13,262 [114] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:13,262 [114] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:13,271 [114] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-03-01 23:14:13,274 [114] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:14:13,275 [114] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-03-01 23:14:13,277 [114] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-03-01 23:14:13,279 [114] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-03-01 23:14:13,281 [114] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-03-01 23:14:13,282 [114] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-03-01 23:14:13,283 [114] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:14:13,285 [114] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-03-01 23:14:13,286 [114] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-03-01 23:14:13,287 [114] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-03-01 23:14:13,288 [114] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-03-01 23:14:13,302 [114] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-03-01 23:14:13,303 [114] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'mimmo.sospeso.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'mimmo.sospeso.task', 1, convert(datetime, '2021-03-01 23:12:02', 120), convert(datetime, '2021-03-01 23:12:30', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-03-01 23:12:02', 120), dt_lwt = convert(datetime, '2021-03-01 23:12:30', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:02', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:30', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-03-01 23:14:13,308 [114] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\mimmo.sospeso.task
2021-03-01 23:14:13,310 [114] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\mimmo.sospeso.task, in: C:\root\todd\_test\dn\mimmo.task
2021-03-01 23:14:13,310 [114] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'mimmo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1859
2021-03-01 23:14:13,318 [114] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\mimmo.task\__i.xml
2021-03-01 23:14:13,319 [114] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1859 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1859, null, left('mimmo', 150)
            , NULL, convert(datetime, '2020-01-01 00:00:00', 120), convert(datetime, '2020-03-03 00:00:00', 120), 1
            , 'sospeso', NULL, NULL, NULL, convert(datetime, '2021-03-01 23:14:13', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-03-03 00:00:00', 120)
         , title = left('mimmo', 150), [user] = NULL
         , stato = 'sospeso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-03-01 23:14:13', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('mimmo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('sospeso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 23:14:13,324 [114] DEBUG dn_lib.tools.log - aggiunto task al database: mimmo
2021-03-01 23:14:13,325 [114] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1859 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1859, 'i.txt', '.txt', 1, convert(datetime, '2021-03-01 23:12:17', 120), convert(datetime, '2021-03-01 23:12:26', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-03-01 23:12:17', 120), dt_lwt = convert(datetime, '2021-03-01 23:12:26', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:17', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-03-01 23:12:26', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-03-01 23:14:13,330 [114] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 23:14:13,331 [114] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4357;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4357, '.txt', @content, convert(datetime, '2021-03-01 23:12:17', 120), convert(datetime, '2021-03-01 23:12:26', 120));
2021-03-01 23:14:13,333 [114] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 23:14:13,334 [114] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1480;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1480, 4357, @content
          , convert(datetime, '2021-03-01 23:12:17', 120), convert(datetime, '2021-03-01 23:12:26', 120));
2021-03-01 23:14:13,337 [114] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\mimmo.task\i.txt
2021-03-01 23:14:13,338 [114] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1480) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-03-01 23:14:13,344 [114] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-03-01 23:14:13,352 [114] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-03-01 23:14:13,353 [114] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-03-01 23:14:13,354 [114] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-03-01 23:14:13,357 [114] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-03-01 23:14:13,360 [114] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/03/01 23:12:30')
        else update users_cache set var_value = substring('2021/03/01 23:12:30', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-03-01 23:14:13,363 [114] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/03/01 23:14:13')
        else update users_cache set var_value = substring('2021/03/01 23:14:13', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-03-01 23:14:32,966 [122] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:32,967 [122] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:32,967 [122] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:32,968 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:32,970 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:32,970 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:32,971 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:32,972 [122] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:32,973 [122] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:32,974 [122] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:32,975 [122] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:32,975 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:32,977 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:32,977 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:32,978 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:32,978 [122] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:32,979 [122] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:32,979 [122] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:32,980 [122] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:32,980 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:32,981 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:32,981 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:32,982 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:32,982 [122] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:32,983 [122] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:32,983 [122] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:32,997 [124] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:32,998 [124] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:32,999 [124] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:33,000 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:33,001 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:33,002 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:33,002 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:33,003 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:33,003 [124] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:33,004 [124] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:33,005 [124] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:33,005 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:33,007 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:33,007 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:33,008 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:33,009 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:33,009 [124] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:33,010 [124] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:33,010 [124] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:33,011 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:33,011 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:33,013 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:33,013 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:33,014 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:33,014 [124] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:33,015 [124] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:33,028 [119] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:33,029 [119] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:33,029 [119] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:33,030 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:33,031 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:33,031 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:33,032 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:33,033 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:33,033 [119] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:33,034 [119] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:33,034 [119] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:33,035 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:33,035 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:33,035 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:33,036 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:33,036 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:33,037 [119] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:33,037 [119] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:33,038 [119] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:33,038 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:33,039 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:33,039 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:33,040 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:33,040 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:33,041 [119] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:33,041 [119] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:33,050 [119] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:14:33,052 [119] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:14:33,055 [119] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:14:33,062 [119] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:14:33,068 [119] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:14:33,084 [119] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:14:33,087 [119] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:14:33,089 [119] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:14:33,092 [119] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:14:33,093 [119] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:14:38,054 [112] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:38,056 [112] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:38,057 [112] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:38,059 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:38,060 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:38,061 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:38,062 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:38,063 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:38,064 [112] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:38,066 [112] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:38,067 [112] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:38,067 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:38,069 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:38,069 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:38,070 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:38,071 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:38,071 [112] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:38,072 [112] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:38,073 [112] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:38,073 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:38,074 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:38,074 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:38,075 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:38,075 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:38,076 [112] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:38,077 [112] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:38,087 [112] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:14:38,090 [112] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id, t2.rel_path, t2.folder_name, t2.task_name
          , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
       from ( select t.task_id, t.title
         , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
         , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
         , isnull(f.file_name, fo.folder_name) as folder_name, t.title as task_name
         , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
        from dn_tasks t
        left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
        left join dn_files f on f.file_id = t.file_id
        left join dn_folders fo on fo.folder_id = t.folder_id 
        where t.task_id = 1480 ) t2
2021-03-01 23:14:38,094 [112] DEBUG dn_lib.tools.log - SQL: update dn_tasks set stato = 'in_corso' where task_id = 1480
2021-03-01 23:14:38,106 [112] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_lwt_idex = convert(datetime, '2021-03-01 23:14:38', 120) 
        where task_id = 1480;
2021-03-01 23:14:38,107 [112] ERROR dn_lib.tools.log - sql: update dn_tasks set dt_lwt_idex = convert(datetime, '2021-03-01 23:14:38', 120) 
        where task_id = 1480;
System.Data.SqlClient.SqlException (0x80131904): Il nome di colonna 'dt_lwt_idex' non  valido.
   in System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   in System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   in System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   in System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   in System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   in System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   in dn_lib.db.db_provider.execute(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 384
ClientConnectionId:1d1a97a8-1328-4d50-b35b-1d5e162c3059
Error Number:207,State:1,Class:16
2021-03-01 23:14:38,118 [112] ERROR dn_lib.tools.log - error
System.Data.SqlClient.SqlException (0x80131904): Il nome di colonna 'dt_lwt_idex' non  valido.
   in dn_lib.db.db_provider.execute(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 403
   in dn_lib.db.db_provider.exec(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 360
   in deepanotes.notes.update_task(Int32 task_id, String& rel_path, List`1 fl, String title, String assegna, String stato, String priorita, String stima, String tipo) in c:\root\todd\git\dn\deepanotes\App_Code\notes.cs:riga 276
   in _notes.OnInit(EventArgs e) in c:\root\todd\git\dn\deepanotes\notes.aspx.cs:riga 97
ClientConnectionId:1d1a97a8-1328-4d50-b35b-1d5e162c3059
Error Number:207,State:1,Class:16
2021-03-01 23:14:54,836 [112] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:14:54,838 [112] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:54,839 [112] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:54,840 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:54,840 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:54,841 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:54,842 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:54,842 [112] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:54,843 [112] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:54,844 [112] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:54,845 [112] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:54,845 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:54,846 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:54,847 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:54,847 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:54,848 [112] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:54,848 [112] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:54,849 [112] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:14:54,849 [112] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:14:54,850 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:14:54,851 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:14:54,851 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:14:54,852 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:14:54,853 [112] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:14:54,853 [112] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:14:54,854 [112] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:14:54,863 [112] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:14:54,865 [112] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:14:54,866 [112] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:14:54,867 [112] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:14:54,868 [112] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:14:54,871 [112] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:14:54,873 [112] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:14:54,874 [112] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:14:54,875 [112] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:14:54,876 [112] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:15:21,412 [115] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:15:21,413 [115] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:15:21,414 [115] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:15:21,415 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:15:21,416 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:15:21,417 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:15:21,418 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:15:21,418 [115] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:15:21,419 [115] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:15:21,420 [115] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:15:21,421 [115] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:15:21,421 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:15:21,422 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:15:21,423 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:15:21,423 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:15:21,424 [115] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:15:21,425 [115] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:15:21,425 [115] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:15:21,426 [115] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:15:21,426 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:15:21,427 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:15:21,428 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:15:21,428 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:15:21,429 [115] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:15:21,429 [115] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:15:21,430 [115] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:15:21,438 [115] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:15:21,440 [115] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:15:21,442 [115] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:15:21,451 [115] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:15:21,457 [115] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:15:21,473 [115] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:15:21,476 [115] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:15:21,478 [115] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:15:21,481 [115] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:15:21,483 [115] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:15:50,131 [124] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:15:50,133 [124] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:15:50,134 [124] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:15:50,135 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:15:50,137 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:15:50,137 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:15:50,138 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:15:50,138 [124] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:15:50,139 [124] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:15:50,141 [124] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:15:50,141 [124] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:15:50,141 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:15:50,143 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:15:50,143 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:15:50,144 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:15:50,145 [124] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:15:50,145 [124] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:15:50,146 [124] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:15:50,146 [124] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:15:50,147 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:15:50,148 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:15:50,149 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:15:50,150 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:15:50,150 [124] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:15:50,151 [124] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:15:50,151 [124] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:15:50,161 [124] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:15:50,163 [124] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id, t2.rel_path, t2.folder_name, t2.task_name
          , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
       from ( select t.task_id, t.title
         , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
         , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
         , isnull(f.file_name, fo.folder_name) as folder_name, t.title as task_name
         , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
        from dn_tasks t
        left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
        left join dn_files f on f.file_id = t.file_id
        left join dn_folders fo on fo.folder_id = t.folder_id 
        where t.task_id = 1480 ) t2
2021-03-01 23:15:50,166 [124] DEBUG dn_lib.tools.log - SQL: update dn_tasks set stato = 'check' where task_id = 1480
2021-03-01 23:15:50,174 [124] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_lwt_idex = convert(datetime, '2021-03-01 23:15:50', 120) 
        where task_id = 1480;
2021-03-01 23:15:50,175 [124] ERROR dn_lib.tools.log - sql: update dn_tasks set dt_lwt_idex = convert(datetime, '2021-03-01 23:15:50', 120) 
        where task_id = 1480;
System.Data.SqlClient.SqlException (0x80131904): Il nome di colonna 'dt_lwt_idex' non  valido.
   in System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   in System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   in System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   in System.Data.SqlClient.SqlCommand.RunExecuteNonQueryTds(String methodName, Boolean async, Int32 timeout, Boolean asyncWrite)
   in System.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, String methodName, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   in System.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   in dn_lib.db.db_provider.execute(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 384
ClientConnectionId:b3b0bd19-551f-419a-aa26-7a30a265b653
Error Number:207,State:1,Class:16
2021-03-01 23:15:50,176 [124] ERROR dn_lib.tools.log - error
System.Data.SqlClient.SqlException (0x80131904): Il nome di colonna 'dt_lwt_idex' non  valido.
   in dn_lib.db.db_provider.execute(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 403
   in dn_lib.db.db_provider.exec(String sql, Boolean getidentity, Boolean noidentity, Boolean open_key, DbParameter[] pars) in C:\root\todd\git\dn\dn_lib\db\db_provider.cs:riga 360
   in deepanotes.notes.update_task(Int32 task_id, String& rel_path, List`1 fl, String title, String assegna, String stato, String priorita, String stima, String tipo) in c:\root\todd\git\dn\deepanotes\App_Code\notes.cs:riga 276
   in _notes.OnInit(EventArgs e) in c:\root\todd\git\dn\deepanotes\notes.aspx.cs:riga 97
ClientConnectionId:b3b0bd19-551f-419a-aa26-7a30a265b653
Error Number:207,State:1,Class:16
2021-03-01 23:17:58,111 [119] INFO dn_lib.tools.log - reload core
2021-03-01 23:17:58,144 [119] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:17:58,146 [119] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,147 [119] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,148 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,150 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,151 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,164 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,166 [119] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,168 [119] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,168 [119] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,170 [119] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,171 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,172 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,174 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,175 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,176 [119] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,176 [119] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,177 [119] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,183 [119] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,186 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,187 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,188 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,190 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,191 [119] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,192 [119] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,193 [119] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:17:58,225 [109] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:17:58,226 [109] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,226 [109] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,228 [109] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,228 [109] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,230 [109] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,230 [109] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,231 [109] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,231 [109] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,232 [109] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,233 [109] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,233 [109] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,234 [109] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,234 [109] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,235 [109] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,236 [109] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,236 [109] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,237 [109] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,237 [109] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,238 [109] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,239 [109] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,239 [109] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,240 [109] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,240 [109] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,241 [109] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,242 [109] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:17:58,273 [104] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:17:58,274 [104] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,276 [104] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,277 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,278 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,279 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,279 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,280 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,281 [104] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,282 [104] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,282 [104] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,283 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,283 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,284 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,284 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,285 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,285 [104] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,285 [104] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:17:58,286 [104] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:17:58,286 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:17:58,286 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:17:58,287 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:17:58,288 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:17:58,289 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:17:58,290 [104] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:17:58,293 [104] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:17:58,317 [104] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:17:58,323 [104] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:17:58,328 [104] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:17:58,340 [104] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:17:58,348 [104] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:17:58,375 [104] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:17:58,387 [104] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:17:58,469 [104] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:17:58,472 [104] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:17:58,474 [104] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:18:33,037 [104] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:18:33,038 [104] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:18:33,040 [104] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:18:33,041 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:18:33,042 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:18:33,042 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:18:33,044 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:18:33,044 [104] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:18:33,045 [104] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:18:33,045 [104] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:18:33,046 [104] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:18:33,047 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:18:33,048 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:18:33,049 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:18:33,049 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:18:33,050 [104] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:18:33,050 [104] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:18:33,051 [104] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:18:33,051 [104] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:18:33,052 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:18:33,053 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:18:33,053 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:18:33,054 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:18:33,054 [104] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:18:33,055 [104] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:18:33,055 [104] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:18:33,099 [104] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:18:33,103 [104] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id, t2.rel_path, t2.folder_name, t2.task_name
          , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
       from ( select t.task_id, t.title
         , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
         , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
         , isnull(f.file_name, fo.folder_name) as folder_name, t.title as task_name
         , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
        from dn_tasks t
        left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
        left join dn_files f on f.file_id = t.file_id
        left join dn_folders fo on fo.folder_id = t.folder_id 
        where t.task_id = 1480 ) t2
2021-03-01 23:18:33,111 [104] DEBUG dn_lib.tools.log - SQL: update dn_tasks set stato = 'da_fare' where task_id = 1480
2021-03-01 23:18:33,127 [104] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_lwt_index = convert(datetime, '2021-03-01 23:18:33', 120) 
        where task_id = 1480;
2021-03-01 23:18:33,129 [104] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:18:33,132 [104] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (1480 is null or (1480 is not null and t.task_id = 1480)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:24:17,393 [41] INFO dn_lib.tools.log - reload core
2021-03-01 23:24:17,424 [41] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:24:17,426 [41] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:17,427 [41] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:17,428 [41] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:17,430 [41] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:17,432 [41] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:17,443 [41] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:17,451 [41] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:17,452 [41] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:17,453 [41] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:17,455 [41] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:17,455 [41] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:17,457 [41] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:17,458 [41] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:17,459 [41] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:17,460 [41] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:17,460 [41] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:17,461 [41] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:17,468 [41] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:17,470 [41] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:17,471 [41] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:17,472 [41] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:17,473 [41] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:17,474 [41] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:17,474 [41] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:17,479 [41] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:24:17,509 [41] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:24:17,515 [41] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:24:17,519 [41] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:24:17,530 [41] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:24:17,538 [41] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:24:17,562 [41] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:24:17,572 [41] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:24:17,650 [41] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:24:17,652 [41] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:24:17,655 [41] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:24:23,616 [91] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:24:23,618 [91] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:23,618 [91] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:23,619 [91] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:23,621 [91] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:23,622 [91] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:23,623 [91] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:23,624 [91] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:23,625 [91] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:23,626 [91] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:23,626 [91] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:23,627 [91] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:23,628 [91] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:23,629 [91] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:23,630 [91] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:23,630 [91] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:23,630 [91] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:23,631 [91] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:23,632 [91] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:23,632 [91] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:23,633 [91] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:23,633 [91] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:23,634 [91] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:23,634 [91] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:23,635 [91] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:23,635 [91] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:24:23,678 [91] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-03-01 23:24:23,683 [91] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id, t2.rel_path, t2.folder_name, t2.task_name
          , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
       from ( select t.task_id, t.title
         , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
         , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
         , isnull(f.file_name, fo.folder_name) as folder_name, t.title as task_name
         , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
        from dn_tasks t
        left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
        left join dn_files f on f.file_id = t.file_id
        left join dn_folders fo on fo.folder_id = t.folder_id 
        where t.task_id = 1480 ) t2
2021-03-01 23:24:23,690 [91] DEBUG dn_lib.tools.log - SQL: update dn_tasks set stato = 'in_corso' where task_id = 1480
2021-03-01 23:24:23,707 [91] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_lwt_index = convert(datetime, '2021-03-01 23:24:23', 120), dt_upd = convert(datetime, '2021-03-01 23:24:23', 120)
        where task_id = 1480;
2021-03-01 23:24:23,710 [91] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:24:23,711 [91] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (1480 is null or (1480 is not null and t.task_id = 1480)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:24:43,827 [103] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:24:43,829 [103] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:43,831 [103] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:43,832 [103] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:43,833 [103] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:43,834 [103] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:43,835 [103] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:43,836 [103] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:43,837 [103] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:43,839 [103] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:43,839 [103] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:43,840 [103] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:43,840 [103] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:43,841 [103] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:43,841 [103] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:43,842 [103] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:43,842 [103] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:43,843 [103] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:43,844 [103] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:43,844 [103] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:43,845 [103] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:43,845 [103] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:43,846 [103] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:43,846 [103] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:43,847 [103] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:43,848 [103] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:24:43,857 [103] DEBUG dn_lib.tools.log - SQL: select content from dn_tasks_notes 
       where task_id = 1480
2021-03-01 23:24:43,860 [103] DEBUG dn_lib.tools.log - SQL: select a.file_id, a.file_name, a.extension, a.http_path , null as found_file       
       , (select top 1 1 from dn_tasks where task_id = a.task_id and file_id = a.file_id) as file_task
      from vw_task_allegati a
      where a.task_id = 1480
2021-03-01 23:24:48,844 [81] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:24:48,845 [81] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:48,847 [81] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:48,849 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:48,851 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:48,851 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:48,853 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:48,854 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:48,855 [81] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:48,856 [81] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:48,856 [81] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:48,857 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:48,858 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:48,859 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:48,859 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:48,861 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:48,861 [81] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:48,861 [81] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:24:48,862 [81] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:24:48,863 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:24:48,864 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:24:48,864 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:24:48,865 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:24:48,865 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:24:48,866 [81] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:24:48,866 [81] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:24:48,879 [81] DEBUG dn_lib.tools.log - SQL: select t.synch_folder_id, t.task_id, t.title, f.folder_id as parent_folder_id, t.folder_id
  , sf.local_path + isnull(replace(dbo.folder_path(t.folder_id), '/', '\'), '') as folder_path
  , t.file_id, ft.type_content, ft.open_comment, ft.close_comment
  , sf.local_path + replace(isnull(dbo.folder_path(f.folder_id), '\') + f.file_name, '/', '\') as file_path
  , tn.file_id as file_id_notes
  , sf.local_path + replace(isnull(dbo.folder_path(fn.folder_id), '\') + fn.file_name, '/', '\') as file_path_notes
 from dn_tasks t
 left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
 left join dn_files f on f.file_id = t.file_id
 left join dn_files_types ft on ft.extension = f.extension
 left join dn_tasks_notes tn on tn.task_id = t.task_id
 left join dn_files fn on fn.file_id = tn.file_id
 where t.task_id = 1480
2021-03-01 23:24:48,891 [81] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4357;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4357, '.txt', @content, convert(datetime, '2021-03-01 23:24:48', 120), convert(datetime, '2021-03-01 23:24:48', 120));
2021-03-01 23:24:48,903 [81] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1480;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_upd)
        values (1480, 4357, @content
          , convert(datetime, convert(varchar, getdate(), 120), 120), convert(datetime, convert(varchar, getdate(), 120), 120));
      if 1 = 1
        update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120) where task_id = 1480;
2021-03-01 23:32:22,748 [84] INFO dn_lib.tools.log - reload core
2021-03-01 23:32:22,777 [84] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:32:22,779 [84] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,780 [84] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,782 [84] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,784 [84] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,785 [84] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,797 [84] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,799 [84] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,801 [84] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,802 [84] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,804 [84] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,804 [84] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,805 [84] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,806 [84] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,807 [84] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,808 [84] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,808 [84] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,809 [84] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,816 [84] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,818 [84] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,819 [84] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,820 [84] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,821 [84] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,822 [84] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,822 [84] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,824 [84] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:32:22,862 [85] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:32:22,864 [85] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,865 [85] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,866 [85] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,867 [85] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,868 [85] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,868 [85] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,869 [85] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,870 [85] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,871 [85] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,872 [85] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,872 [85] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,873 [85] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,874 [85] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,875 [85] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,875 [85] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,876 [85] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,877 [85] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,878 [85] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,879 [85] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,880 [85] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,881 [85] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,881 [85] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,882 [85] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,883 [85] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,883 [85] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:32:22,917 [79] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:32:22,918 [79] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,920 [79] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,921 [79] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,922 [79] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,923 [79] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,924 [79] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,924 [79] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,925 [79] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,926 [79] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,926 [79] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,927 [79] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,928 [79] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,928 [79] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,929 [79] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,930 [79] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,931 [79] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,932 [79] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:22,933 [79] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:22,933 [79] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:22,934 [79] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:22,934 [79] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:22,935 [79] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:22,935 [79] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:22,936 [79] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:22,939 [79] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:32:22,963 [79] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-03-01 23:32:22,970 [79] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-03-01 23:32:22,975 [79] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-03-01 23:32:22,987 [79] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-03-01 23:32:22,996 [79] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-03-01 23:32:23,022 [79] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-03-01 23:32:23,035 [79] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-03-01 23:32:23,114 [79] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-03-01 23:32:23,117 [79] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-03-01 23:32:23,119 [79] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-03-01 23:32:26,503 [81] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:32:26,504 [81] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:26,504 [81] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:26,505 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:26,506 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:26,506 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:26,507 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:26,508 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:26,508 [81] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:26,509 [81] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:26,509 [81] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:26,510 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:26,511 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:26,511 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:26,512 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:26,512 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:26,513 [81] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:26,513 [81] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:26,514 [81] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:26,514 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:26,515 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:26,515 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:26,516 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:26,516 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:26,517 [81] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:26,517 [81] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:32:26,561 [81] DEBUG dn_lib.tools.log - SQL: select content from dn_tasks_notes 
       where task_id = 1480
2021-03-01 23:32:26,564 [81] DEBUG dn_lib.tools.log - SQL: select a.file_id, a.file_name, a.extension, a.http_path , null as found_file       
       , (select top 1 1 from dn_tasks where task_id = a.task_id and file_id = a.file_id) as file_task
      from vw_task_allegati a
      where a.task_id = 1480
2021-03-01 23:32:36,211 [81] INFO dn_lib.tools.log - reload config docs
2021-03-01 23:32:36,212 [81] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:36,214 [81] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:36,215 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:36,216 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:36,216 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:36,217 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:36,218 [81] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:36,219 [81] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:36,220 [81] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:36,220 [81] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:36,221 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:36,221 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:36,222 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:36,222 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:36,223 [81] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:36,224 [81] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:36,224 [81] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-03-01 23:32:36,225 [81] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-03-01 23:32:36,225 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-03-01 23:32:36,225 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-03-01 23:32:36,226 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-03-01 23:32:36,226 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-03-01 23:32:36,227 [81] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-03-01 23:32:36,227 [81] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-03-01 23:32:36,228 [81] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-03-01 23:32:36,241 [81] DEBUG dn_lib.tools.log - SQL: select t.synch_folder_id, t.task_id, t.title, f.folder_id as parent_folder_id, t.folder_id
  , sf.local_path + isnull(replace(dbo.folder_path(t.folder_id), '/', '\'), '') as folder_path
  , t.file_id, ft.type_content, ft.open_comment, ft.close_comment
  , sf.local_path + replace(isnull(dbo.folder_path(f.folder_id), '\') + f.file_name, '/', '\') as file_path
  , tn.file_id as file_id_notes
  , sf.local_path + replace(isnull(dbo.folder_path(fn.folder_id), '\') + fn.file_name, '/', '\') as file_path_notes
 from dn_tasks t
 left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
 left join dn_files f on f.file_id = t.file_id
 left join dn_files_types ft on ft.extension = f.extension
 left join dn_tasks_notes tn on tn.task_id = t.task_id
 left join dn_files fn on fn.file_id = tn.file_id
 where t.task_id = 1480
2021-03-01 23:32:36,256 [81] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4357;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4357, '.txt', @content, convert(datetime, '2021-03-01 23:32:36', 120), convert(datetime, '2021-03-01 23:32:36', 120));
2021-03-01 23:32:36,268 [81] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1480;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_upd)
        values (1480, 4357, @content
          , convert(datetime, convert(varchar, getdate(), 120), 120), convert(datetime, convert(varchar, getdate(), 120), 120));
      if 1 = 1
        update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120) where task_id = 1480;
2021-03-01 23:32:36,280 [81] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_lwt_index = convert(datetime, '2021-03-01 23:32:36', 120), dt_upd = convert(datetime, '2021-03-01 23:32:36', 120)
        where task_id = 1480;
