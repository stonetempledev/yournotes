2021-02-28 15:28:14,639 [6] INFO dn_lib.tools.log - reload core
2021-02-28 15:28:14,678 [6] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:28:14,680 [6] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:14,688 [6] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:14,697 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:14,699 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:14,702 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:14,713 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:14,715 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:14,717 [6] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:14,725 [6] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:14,727 [6] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:14,728 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:14,729 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:14,730 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:14,731 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:14,733 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:14,733 [6] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:14,734 [6] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:14,742 [6] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:14,744 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:14,745 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:14,746 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:14,748 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:14,748 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:14,750 [6] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:14,752 [6] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:28:26,904 [6] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:28:26,905 [6] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:26,906 [6] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:26,907 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:26,907 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:26,908 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:26,908 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:26,909 [6] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:26,909 [6] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:26,910 [6] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:26,910 [6] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:26,911 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:26,911 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:26,912 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:26,912 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:26,913 [6] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:26,914 [6] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:26,914 [6] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:26,915 [6] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:26,916 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:26,916 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:26,917 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:26,918 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:26,918 [6] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:26,919 [6] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:26,919 [6] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:28:26,939 [14] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:28:26,940 [14] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:26,940 [14] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:26,941 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:26,942 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:26,942 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:26,943 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:26,944 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:26,945 [14] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:26,945 [14] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:26,946 [14] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:26,946 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:26,947 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:26,948 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:26,948 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:26,949 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:26,949 [14] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:26,950 [14] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:26,951 [14] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:26,951 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:26,952 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:26,953 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:26,953 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:26,954 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:26,955 [14] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:26,956 [14] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:28:26,992 [14] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:28:27,011 [16] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:28:27,012 [16] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:27,013 [16] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:27,014 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:27,015 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:27,016 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:27,018 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:27,018 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:27,019 [16] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:27,020 [16] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:27,020 [16] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:27,021 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:27,022 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:27,023 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:27,024 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:27,024 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:27,025 [16] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:27,026 [16] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:27,027 [16] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:27,028 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:27,029 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:27,030 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:27,031 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:27,032 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:27,033 [16] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:27,034 [16] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:28:27,045 [16] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:28:27,070 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:28:27,071 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:27,072 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:27,073 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:27,074 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:27,075 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:27,075 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:27,076 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:27,077 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:27,078 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:27,079 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:27,080 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:27,081 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:27,082 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:27,082 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:27,084 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:27,084 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:27,085 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:28:27,086 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:28:27,087 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:28:27,087 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:28:27,088 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:28:27,089 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:28:27,089 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:28:27,090 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:28:27,101 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:28:27,115 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:28:27,127 [12] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 15:28:27,133 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 15:28:27,142 [12] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 15:28:27,166 [12] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 15:28:27,176 [12] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 15:28:27,204 [12] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 15:28:27,220 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 15:28:27,319 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 15:28:27,323 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 15:28:27,326 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 15:29:12,010 [13] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:12,012 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:12,013 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:12,014 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:12,015 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:12,016 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:12,017 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:12,018 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:12,018 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:12,019 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:12,020 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:12,020 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:12,021 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:12,022 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:12,023 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:12,023 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:12,024 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:12,025 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:12,026 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:12,026 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:12,027 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:12,028 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:12,028 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:12,029 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:12,030 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:12,031 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:12,043 [13] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:12,057 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:12,058 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:12,059 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:12,060 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:12,061 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:12,062 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:12,063 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:12,064 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:12,065 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:12,066 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:12,066 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:12,067 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:12,067 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:12,068 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:12,068 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:12,069 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:12,070 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:12,070 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:12,071 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:12,072 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:12,073 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:12,074 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:12,075 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:12,076 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:12,077 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:12,078 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:12,088 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:21,712 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:21,714 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,715 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,716 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,717 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,717 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,718 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,719 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,720 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,720 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,721 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,723 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,723 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,724 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,725 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,725 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,726 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,726 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,727 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,728 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,728 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,729 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,729 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,730 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,731 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,731 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:21,741 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:21,755 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:21,757 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,758 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,759 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,760 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,761 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,762 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,762 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,763 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,764 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,764 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,765 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,766 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,766 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,767 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,767 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,768 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,768 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,769 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,769 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,770 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,770 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,771 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,772 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,773 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,774 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:21,784 [7] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:21,791 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:21,792 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,793 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,794 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,795 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,796 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,797 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,798 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,798 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,799 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,799 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,800 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,800 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,801 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,802 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,803 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,803 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:21,804 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:21,805 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:21,805 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:21,806 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:21,807 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:21,807 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:21,808 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:21,809 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:21,819 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:22,391 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:22,392 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:22,393 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:22,395 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:22,396 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:22,397 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:22,398 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:22,399 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:22,400 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:22,401 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:22,401 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:22,402 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:22,403 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:22,404 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:22,405 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:22,406 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:22,406 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:22,407 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:22,408 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:22,409 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:22,410 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:22,410 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:22,411 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:22,411 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:22,413 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:22,413 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:22,425 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:22,472 [9] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:29:22,475 [9] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:29:22,479 [9] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:29:22,481 [9] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:29:22,484 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:29:22,486 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:29:22,487 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:29:22,490 [9] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:29:22,496 [9] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:29:22,497 [9] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:29:22,498 [9] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:29:22,500 [9] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:29:22,505 [9] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:29:22,508 [9] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:29:22,518 [9] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-02-28 15:29:22,519 [9] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-02-28 15:29:22,520 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:29:22,525 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:29:22,528 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:29:22,532 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:29:22')
        else update users_cache set var_value = substring('2021/02/28 15:29:22', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:29:26,966 [13] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:26,968 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:26,969 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:26,970 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:26,972 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:26,973 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:26,974 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:26,975 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:26,976 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:26,977 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:26,977 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:26,978 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:26,979 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:26,980 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:26,981 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:26,982 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:26,982 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:26,983 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:26,984 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:26,984 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:26,985 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:26,986 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:26,987 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:26,987 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:26,988 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:26,989 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:26,998 [13] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:27,556 [15] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:29:27,558 [15] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:27,559 [15] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:27,560 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:27,561 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:27,562 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:27,563 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:27,564 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:27,564 [15] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:27,565 [15] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:27,566 [15] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:27,567 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:27,568 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:27,568 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:27,569 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:27,570 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:27,570 [15] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:27,571 [15] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:29:27,571 [15] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:29:27,572 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:29:27,573 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:29:27,573 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:29:27,574 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:29:27,575 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:29:27,576 [15] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:29:27,577 [15] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:29:27,587 [15] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:29:27,589 [15] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:29:27,590 [15] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:29:27,591 [15] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:29:27,592 [15] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:29:27,593 [15] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:29:27,594 [15] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:29:27,595 [15] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:29:27,596 [15] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:29:27,597 [15] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:29:27,598 [15] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:29:27,599 [15] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:29:27,599 [15] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:29:27,600 [15] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:29:27,601 [15] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:29:27,602 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:29:27,604 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:29:27,605 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:29:27,606 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:29:27')
        else update users_cache set var_value = substring('2021/02/28 15:29:27', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:30:05,257 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:30:05,258 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:05,259 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:05,259 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:05,260 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:05,260 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:05,261 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:05,262 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:05,262 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:05,263 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:05,264 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:05,264 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:05,265 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:05,266 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:05,267 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:05,268 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:05,270 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:05,270 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:05,270 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:05,271 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:05,272 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:05,272 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:05,273 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:05,273 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:05,274 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:05,275 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:30:05,284 [7] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:30:05,843 [16] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:30:05,845 [16] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:05,847 [16] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:05,849 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:05,851 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:05,852 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:05,853 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:05,854 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:05,855 [16] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:05,856 [16] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:05,857 [16] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:05,858 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:05,858 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:05,858 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:05,859 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:05,860 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:05,861 [16] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:05,861 [16] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:05,862 [16] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:05,863 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:05,863 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:05,864 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:05,864 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:05,865 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:05,866 [16] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:05,866 [16] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:30:05,876 [16] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:30:05,887 [16] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:30:05,888 [16] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:30:05,889 [16] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:30:05,890 [16] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:30:05,891 [16] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:30:05,892 [16] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:30:05,893 [16] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:30:05,894 [16] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:30:05,895 [16] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:30:05,896 [16] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:30:05,897 [16] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:30:05,898 [16] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:30:05,899 [16] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:30:05,901 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id is null and file_name = 'primo.task.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, null, 'primo.task.txt', '.txt', 1, convert(datetime, '2021-02-28 15:29:45', 120), convert(datetime, '2021-02-28 15:29:58', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:29:45', 120), dt_lwt = convert(datetime, '2021-02-28 15:29:58', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:29:45', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:29:58', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:30:05,906 [16] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\primo.task.txt
2021-02-28 15:30:05,913 [16] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4336;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4336, '.txt', @content, convert(datetime, '2021-02-28 15:29:45', 120), convert(datetime, '2021-02-28 15:29:58', 120));
2021-02-28 15:30:05,918 [16] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\primo.task.txt
2021-02-28 15:30:05,923 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 0 and isnull(file_id, 0) = 4336;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, null, 4336, left('primo', 150)
            , NULL, convert(datetime, '2021-02-28 15:29:45', 120), NULL, 1
            , NULL, NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-02-28 15:29:45', 120), dt_upd = NULL
         , title = left('primo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:29:45', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('primo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:30:05,929 [16] DEBUG dn_lib.tools.log - inserito task nel database: C:\root\todd\_test\dn\primo
2021-02-28 15:30:05,931 [16] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1461;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1461, 4336, @content
          , convert(datetime, '2021-02-28 15:29:45', 120), convert(datetime, '2021-02-28 15:29:58', 120));
2021-02-28 15:30:05,935 [16] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\primo.task.txt
2021-02-28 15:30:05,937 [16] DEBUG dn_lib.tools.log - trasformazione task file in task folder: C:\root\todd\_test\dn\primo.task.txt
2021-02-28 15:30:05,939 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'primo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'primo.task', 1, convert(datetime, '2021-02-28 15:29:45', 120), convert(datetime, '2021-02-28 15:29:45', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:29:45', 120), dt_lwt = convert(datetime, '2021-02-28 15:29:45', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:29:45', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:29:45', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:30:05,943 [16] DEBUG dn_lib.tools.log - creato folder: C:\root\todd\_test\dn\primo.task
2021-02-28 15:30:05,945 [16] DEBUG dn_lib.tools.log - SQL: update dn_files set synch_folder_id = 1, folder_id = 1840, file_name = 'i.txt', dt_upd = getdate()
        where file_id = 4336;
      
2021-02-28 15:30:05,948 [16] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120), folder_id = 1840, file_id = null
        where task_id = 1461;
2021-02-28 15:30:05,951 [16] DEBUG dn_lib.tools.log - spostato file da: C:\root\todd\_test\dn\primo.task.txt, a:C:\root\todd\_test\dn\primo.task\i.txt
2021-02-28 15:30:05,952 [16] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1461;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_upd)
        values (1461, 4336, @content
          , convert(datetime, convert(varchar, getdate(), 120), 120), convert(datetime, convert(varchar, getdate(), 120), 120));
      update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120) where task_id = 1461;
2021-02-28 15:30:05,956 [16] DEBUG dn_lib.tools.log - salvate le note del task: C:\root\todd\_test\dn\primo.task
2021-02-28 15:30:05,969 [16] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\primo.task\__i.xml
2021-02-28 15:30:05,970 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1840 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1840, null, left('primo', 150)
            , NULL, NULL, convert(datetime, '2021-02-28 15:29:58', 120), 1
            , NULL, NULL, NULL, NULL, convert(datetime, '2021-02-28 15:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = NULL, dt_upd = convert(datetime, '2021-02-28 15:29:58', 120)
         , title = left('primo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 15:30:05', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(NULL, getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:29:58', 120), getdate())
          or isnull(title, '') <> isnull('primo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:30:05,977 [16] DEBUG dn_lib.tools.log - aggiornato task nel database: primo
2021-02-28 15:30:05,978 [16] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:30:05,979 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:30:05,982 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:30:05,983 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 15:29:58')
        else update users_cache set var_value = substring('2021/02/28 15:29:58', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:30:05,986 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:30:05')
        else update users_cache set var_value = substring('2021/02/28 15:30:05', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:30:58,190 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:30:58,192 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:58,193 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:58,194 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:58,196 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:58,196 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:58,198 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:58,198 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:58,199 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:58,200 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:58,201 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:58,201 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:58,202 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:58,203 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:58,204 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:58,204 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:58,205 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:58,206 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:58,207 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:58,209 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:58,210 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:58,211 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:58,212 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:58,212 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:58,213 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:58,215 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:30:58,225 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:30:58,781 [14] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:30:58,783 [14] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:58,784 [14] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:58,786 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:58,787 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:58,788 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:58,789 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:58,790 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:58,791 [14] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:58,792 [14] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:58,793 [14] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:58,793 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:58,794 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:58,795 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:58,796 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:58,796 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:58,797 [14] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:58,798 [14] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:30:58,798 [14] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:30:58,799 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:30:58,800 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:30:58,800 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:30:58,801 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:30:58,802 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:30:58,802 [14] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:30:58,803 [14] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:30:58,812 [14] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '1B8D75206E18FE6813EC';
 select top 1 1 from clients where client_key = '1B8D75206E18FE6813EC' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:30:58,821 [14] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:30:58,823 [14] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:30:58,824 [14] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:30:58,825 [14] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:30:58,826 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:30:58,827 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:30:58,828 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:30:58,829 [14] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:30:58,830 [14] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:30:58,831 [14] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:30:58,833 [14] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:30:58,833 [14] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:30:58,837 [14] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:30:58,837 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'primo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'primo.task', 1, convert(datetime, '2021-02-28 15:30:05', 120), convert(datetime, '2021-02-28 15:30:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:30:05', 120), dt_lwt = convert(datetime, '2021-02-28 15:30:05', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:30:05', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:30:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:30:58,843 [14] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\primo.task
2021-02-28 15:30:58,844 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1840 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1840, null, left('primo', 150)
            , NULL, NULL, convert(datetime, '2021-02-28 15:29:58', 120), 1
            , NULL, NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = NULL, dt_upd = convert(datetime, '2021-02-28 15:29:58', 120)
         , title = left('primo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(NULL, getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:29:58', 120), getdate())
          or isnull(title, '') <> isnull('primo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:30:58,850 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1840 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1840, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 15:29:45', 120), convert(datetime, '2021-02-28 15:29:58', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:29:45', 120), dt_lwt = convert(datetime, '2021-02-28 15:29:58', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:29:45', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:29:58', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:30:58,854 [14] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1461) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 15:30:58,864 [14] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:30:58,866 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:30:58,869 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:30:58,872 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 15:30:05')
        else update users_cache set var_value = substring('2021/02/28 15:30:05', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:30:58,875 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:30:58')
        else update users_cache set var_value = substring('2021/02/28 15:30:58', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:38:08,137 [22] INFO dn_lib.tools.log - reload core
2021-02-28 15:38:08,176 [22] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:38:08,178 [22] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,179 [22] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,180 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,182 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,183 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,194 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,195 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,197 [22] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,198 [22] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,199 [22] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,200 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,201 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,203 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,204 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,205 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,206 [22] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,207 [22] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,216 [22] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,218 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,220 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,221 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,223 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,224 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,225 [22] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,227 [22] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:38:08,247 [22] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:38:08,271 [25] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:38:08,273 [25] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,274 [25] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,274 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,275 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,276 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,277 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,278 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,279 [25] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,279 [25] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,280 [25] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,281 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,281 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,282 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,283 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,283 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,284 [25] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,285 [25] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,285 [25] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,287 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,288 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,289 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,289 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,290 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,291 [25] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,292 [25] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:38:08,303 [25] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:38:08,328 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:38:08,329 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,330 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,331 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,332 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,333 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,333 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,334 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,335 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,336 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,337 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,338 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,340 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,340 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,341 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,342 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,342 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,343 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:38:08,343 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:38:08,344 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:38:08,344 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:38:08,345 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:38:08,345 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:38:08,346 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:38:08,346 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:38:08,350 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:38:08,363 [23] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:38:08,375 [23] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 15:38:08,378 [23] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 15:38:08,382 [23] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 15:38:08,386 [23] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 15:38:08,390 [23] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 15:38:08,399 [23] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 15:38:08,411 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 15:38:08,492 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 15:38:08,494 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 15:38:08,495 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 15:40:14,331 [13] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:40:14,333 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,334 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,334 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,335 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,336 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,337 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,338 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,338 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,339 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,340 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,341 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,341 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,342 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,342 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,343 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,344 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,344 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,345 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,346 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,346 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,347 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,348 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,349 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,350 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,351 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:40:14,360 [13] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:40:14,374 [19] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:40:14,375 [19] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,376 [19] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,377 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,378 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,378 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,379 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,380 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,380 [19] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,381 [19] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,382 [19] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,382 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,383 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,384 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,384 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,385 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,385 [19] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,386 [19] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,387 [19] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,388 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,388 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,389 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,389 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,390 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,390 [19] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,391 [19] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:40:14,400 [19] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:40:14,406 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:40:14,407 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,408 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,409 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,410 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,411 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,411 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,412 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,413 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,413 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,414 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,414 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,415 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,416 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,416 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,416 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,417 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,417 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:14,417 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:14,418 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:14,418 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:14,419 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:14,420 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:14,420 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:14,421 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:14,422 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:40:14,431 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:40:15,001 [25] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:40:15,003 [25] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:15,005 [25] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:15,006 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:15,007 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:15,008 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:15,009 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:15,010 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:15,011 [25] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:15,011 [25] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:15,012 [25] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:15,013 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:15,014 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:15,015 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:15,015 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:15,016 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:15,017 [25] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:15,018 [25] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:15,019 [25] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:15,020 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:15,021 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:15,021 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:15,022 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:15,022 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:15,023 [25] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:15,024 [25] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:40:15,033 [25] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:40:15,081 [25] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:40:15,083 [25] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:40:15,085 [25] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:40:15,086 [25] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:40:15,088 [25] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:40:15,089 [25] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:40:15,090 [25] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:40:15,092 [25] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:40:15,097 [25] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:40:15,098 [25] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:40:15,100 [25] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:40:15,102 [25] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:40:15,115 [25] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:40:15,117 [25] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id is null and file_name = 'ringo.task.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, null, 'ringo.task.txt', '.txt', 1, convert(datetime, '2021-02-28 15:39:54', 120), convert(datetime, '2021-02-28 15:40:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:39:54', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:39:54', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:40:15,121 [25] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\ringo.task.txt
2021-02-28 15:40:15,127 [25] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4337;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4337, '.txt', @content, convert(datetime, '2021-02-28 15:39:54', 120), convert(datetime, '2021-02-28 15:40:05', 120));
2021-02-28 15:40:15,131 [25] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\ringo.task.txt
2021-02-28 15:40:15,135 [25] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 0 and isnull(file_id, 0) = 4337;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, null, 4337, left('ringo', 150)
            , NULL, convert(datetime, '2021-02-28 15:39:54', 120), NULL, 1
            , NULL, NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-02-28 15:39:54', 120), dt_upd = NULL
         , title = left('ringo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:39:54', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('ringo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:40:15,141 [25] DEBUG dn_lib.tools.log - inserito task nel database: C:\root\todd\_test\dn\ringo
2021-02-28 15:40:15,143 [25] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1462;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1462, 4337, @content
          , convert(datetime, '2021-02-28 15:39:54', 120), convert(datetime, '2021-02-28 15:40:05', 120));
2021-02-28 15:40:15,145 [25] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\ringo.task.txt
2021-02-28 15:40:15,147 [25] DEBUG dn_lib.tools.log - trasformazione task file in task folder: C:\root\todd\_test\dn\ringo.task.txt
2021-02-28 15:40:15,149 [25] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'ringo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'ringo.task', 1, convert(datetime, '2021-02-28 15:40:15', 120), convert(datetime, '2021-02-28 15:40:15', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:40:15', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:15', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:40:15,154 [25] DEBUG dn_lib.tools.log - creato folder: C:\root\todd\_test\dn\ringo.task
2021-02-28 15:40:15,155 [25] DEBUG dn_lib.tools.log - SQL: update dn_files set synch_folder_id = 1, folder_id = 1841, file_name = 'i.txt', dt_upd = getdate()
        where file_id = 4337;
      
2021-02-28 15:40:15,157 [25] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120), folder_id = 1841, file_id = null
        where task_id = 1462;
2021-02-28 15:40:15,158 [25] DEBUG dn_lib.tools.log - spostato file da: C:\root\todd\_test\dn\ringo.task.txt, a:C:\root\todd\_test\dn\ringo.task\i.txt
2021-02-28 15:40:15,159 [25] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1462;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_upd)
        values (1462, 4337, @content
          , convert(datetime, convert(varchar, getdate(), 120), 120), convert(datetime, convert(varchar, getdate(), 120), 120));
      update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120) where task_id = 1462;
2021-02-28 15:40:15,163 [25] DEBUG dn_lib.tools.log - salvate le note del task: C:\root\todd\_test\dn\ringo.task
2021-02-28 15:40:15,172 [25] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\ringo.task\__i.xml
2021-02-28 15:40:15,174 [25] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1841 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1841, null, left('ringo', 150)
            , NULL, NULL, convert(datetime, '2021-02-28 15:40:05', 120), 1
            , NULL, NULL, NULL, NULL, convert(datetime, '2021-02-28 15:40:15', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = NULL, dt_upd = convert(datetime, '2021-02-28 15:40:05', 120)
         , title = left('ringo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 15:40:15', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(NULL, getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate())
          or isnull(title, '') <> isnull('ringo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:40:15,180 [25] DEBUG dn_lib.tools.log - aggiornato task nel database: ringo
2021-02-28 15:40:15,181 [25] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:40:15,185 [25] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-02-28 15:40:15,186 [25] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-02-28 15:40:15,187 [25] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:40:15,188 [25] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:40:15,190 [25] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 15:40:05')
        else update users_cache set var_value = substring('2021/02/28 15:40:05', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:40:15,193 [25] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:40:15')
        else update users_cache set var_value = substring('2021/02/28 15:40:15', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:40:22,315 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:40:22,316 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:22,318 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:22,318 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:22,319 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:22,320 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:22,320 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:22,321 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:22,321 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:22,322 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:22,322 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:22,323 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:22,323 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:22,324 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:22,324 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:22,325 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:22,325 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:22,325 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:22,326 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:22,326 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:22,327 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:22,327 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:22,328 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:22,328 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:22,329 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:22,330 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:40:22,340 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:40:22,911 [27] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:40:22,913 [27] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:22,914 [27] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:22,915 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:22,916 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:22,917 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:22,918 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:22,919 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:22,920 [27] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:22,921 [27] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:22,922 [27] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:22,922 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:22,923 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:22,924 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:22,924 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:22,925 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:22,925 [27] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:22,926 [27] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:40:22,927 [27] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:40:22,928 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:40:22,928 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:40:22,929 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:40:22,930 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:40:22,931 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:40:22,932 [27] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:40:22,933 [27] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:40:22,942 [27] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:40:22,953 [27] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:40:22,955 [27] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:40:22,956 [27] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:40:22,956 [27] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:40:22,957 [27] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:40:22,958 [27] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:40:22,959 [27] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:40:22,960 [27] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:40:22,961 [27] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:40:22,962 [27] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:40:22,963 [27] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:40:22,964 [27] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:40:22,967 [27] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:40:22,967 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'ringo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'ringo.task', 1, convert(datetime, '2021-02-28 15:40:15', 120), convert(datetime, '2021-02-28 15:40:15', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:40:15', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:15', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:40:22,970 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1841 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1841, null, left('ringo', 150)
            , NULL, NULL, convert(datetime, '2021-02-28 15:40:05', 120), 1
            , NULL, NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = NULL, dt_upd = convert(datetime, '2021-02-28 15:40:05', 120)
         , title = left('ringo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(NULL, getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate())
          or isnull(title, '') <> isnull('ringo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:40:22,975 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1841 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1841, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 15:39:54', 120), convert(datetime, '2021-02-28 15:40:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:39:54', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:39:54', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:40:22,980 [27] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1462) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 15:40:22,985 [27] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:40:22,990 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:40:22,991 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:40:22,993 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 15:40:15')
        else update users_cache set var_value = substring('2021/02/28 15:40:15', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:40:22,996 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:40:22')
        else update users_cache set var_value = substring('2021/02/28 15:40:22', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:42:33,190 [27] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:42:33,192 [27] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,193 [27] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,194 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,195 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,196 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,197 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,198 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,199 [27] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,200 [27] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,201 [27] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,202 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,203 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,203 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,204 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,204 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,205 [27] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,205 [27] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,206 [27] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,206 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,207 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,208 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,208 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,209 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,210 [27] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,210 [27] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:42:33,218 [27] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:42:33,232 [25] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:42:33,233 [25] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,235 [25] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,235 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,236 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,237 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,238 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,239 [25] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,239 [25] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,240 [25] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,241 [25] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,241 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,242 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,243 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,243 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,244 [25] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,244 [25] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,245 [25] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,245 [25] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,247 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,248 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,249 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,249 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,250 [25] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,251 [25] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,251 [25] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:42:33,261 [25] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:42:33,268 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:42:33,269 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,270 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,270 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,271 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,271 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,272 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,273 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,273 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,274 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,274 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,275 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,275 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,276 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,276 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,277 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,277 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,278 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:42:33,278 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:42:33,279 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:42:33,279 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:42:33,280 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:42:33,280 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:42:33,281 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:42:33,281 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:42:33,282 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:42:33,292 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:42:33,294 [12] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 15:42:33,295 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 15:42:33,296 [12] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 15:42:33,297 [12] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 15:42:33,298 [12] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 15:42:33,299 [12] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 15:42:33,301 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 15:42:33,302 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 15:42:33,304 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 15:42:33,305 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 15:43:29,440 [28] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:29,441 [28] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,443 [28] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,444 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,445 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,445 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,446 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,448 [28] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,448 [28] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,449 [28] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,450 [28] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,451 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,452 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,453 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,453 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,454 [28] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,455 [28] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,456 [28] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,456 [28] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,457 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,458 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,458 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,459 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,459 [28] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,460 [28] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,461 [28] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:29,471 [28] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:29,487 [14] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:29,488 [14] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,490 [14] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,490 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,491 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,492 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,493 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,494 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,495 [14] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,495 [14] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,496 [14] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,497 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,497 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,497 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,498 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,499 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,499 [14] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,500 [14] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,501 [14] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,501 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,502 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,502 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,503 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,503 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,504 [14] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,505 [14] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:29,514 [14] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:29,519 [16] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:29,520 [16] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,521 [16] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,522 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,522 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,523 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,524 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,524 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,525 [16] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,526 [16] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,526 [16] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,527 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,527 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,528 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,529 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,530 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,530 [16] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,531 [16] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:29,531 [16] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:29,532 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:29,533 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:29,533 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:29,534 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:29,535 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:29,535 [16] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:29,536 [16] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:29,548 [16] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:30,109 [19] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:30,109 [19] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:30,118 [19] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:30,128 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:30,139 [19] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:30,139 [19] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:30,139 [19] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:30,148 [19] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:43:30,160 [19] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:43:30,169 [19] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:43:30,169 [19] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:43:30,169 [19] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:43:30,169 [19] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:43:30,169 [19] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:43:30,169 [19] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20210120.incorso.pem.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20210120.incorso.pem.task', 1, convert(datetime, '2021-02-28 15:42:43', 120), convert(datetime, '2021-02-28 15:42:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:42:43', 120), dt_lwt = convert(datetime, '2021-02-28 15:42:52', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:42:43', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:42:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:43:30,179 [19] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20210120.incorso.pem.task
2021-02-28 15:43:30,179 [19] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20210120.incorso.pem.task, in: C:\root\todd\_test\dn\pem.task
2021-02-28 15:43:30,179 [19] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'pem.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1842
2021-02-28 15:43:30,189 [19] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\pem.task\__i.xml
2021-02-28 15:43:30,189 [19] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1842 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1842, null, left('pem', 150)
            , NULL, convert(datetime, '2021-01-20 00:00:00', 120), convert(datetime, '2021-02-28 15:42:52', 120), 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-02-28 15:43:30', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-01-20 00:00:00', 120), dt_upd = convert(datetime, '2021-02-28 15:42:52', 120)
         , title = left('pem', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 15:43:30', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-01-20 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:42:52', 120), getdate())
          or isnull(title, '') <> isnull('pem', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:30,189 [19] DEBUG dn_lib.tools.log - aggiunto task al database: pem
2021-02-28 15:43:30,189 [19] ERROR dn_lib.tools.log - Impossibile trovare una parte del percorso 'C:\root\todd\_test\dn\20210120.incorso.pem.task'.
2021-02-28 15:43:30,199 [19] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'ringo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'ringo.task', 1, convert(datetime, '2021-02-28 15:40:15', 120), convert(datetime, '2021-02-28 15:40:15', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:40:15', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:15', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:43:30,199 [19] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1841 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1841, null, left('ringo', 150)
            , NULL, NULL, convert(datetime, '2021-02-28 15:40:05', 120), 1
            , NULL, NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = NULL, dt_upd = convert(datetime, '2021-02-28 15:40:05', 120)
         , title = left('ringo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(NULL, getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate())
          or isnull(title, '') <> isnull('ringo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:30,201 [19] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1841 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1841, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 15:39:54', 120), convert(datetime, '2021-02-28 15:40:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:39:54', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:39:54', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:30,201 [19] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1462) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 15:43:30,201 [19] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:43:30,201 [19] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '3')
        else update users_cache set var_value = substring('3', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:43:30,208 [19] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:43:30,208 [19] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 15:43:04')
        else update users_cache set var_value = substring('2021/02/28 15:43:04', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:43:30,208 [19] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:43:30')
        else update users_cache set var_value = substring('2021/02/28 15:43:30', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:43:43,829 [22] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:43,830 [22] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:43,832 [22] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:43,833 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:43,833 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:43,834 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:43,834 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:43,835 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:43,836 [22] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:43,837 [22] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:43,838 [22] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:43,839 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:43,840 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:43,840 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:43,841 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:43,842 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:43,842 [22] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:43,843 [22] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:43,843 [22] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:43,844 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:43,845 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:43,845 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:43,846 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:43,847 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:43,848 [22] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:43,849 [22] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:43,860 [22] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:44,429 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:44,429 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:44,438 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:44,439 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:44,449 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:44,458 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:44,458 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:44,477 [11] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:43:44,478 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:43:44,488 [11] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:43:44,488 [11] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:43:44,488 [11] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:43:44,488 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'pem.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'pem.task', 1, convert(datetime, '2021-02-28 15:42:43', 120), convert(datetime, '2021-02-28 15:43:30', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:42:43', 120), dt_lwt = convert(datetime, '2021-02-28 15:43:30', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:42:43', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:43:30', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:43:44,488 [11] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\pem.task
2021-02-28 15:43:44,488 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1842 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1842, null, left('pem', 150)
            , NULL, convert(datetime, '2021-01-20 00:00:00', 120), convert(datetime, '2021-02-28 15:42:52', 120), 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-01-20 00:00:00', 120), dt_upd = convert(datetime, '2021-02-28 15:42:52', 120)
         , title = left('pem', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-01-20 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:42:52', 120), getdate())
          or isnull(title, '') <> isnull('pem', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:44,499 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1842 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1842, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 15:42:51', 120), convert(datetime, '2021-02-28 15:43:04', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:42:51', 120), dt_lwt = convert(datetime, '2021-02-28 15:43:04', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:42:51', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:43:04', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:44,499 [11] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\pem.task\i.txt
2021-02-28 15:43:44,509 [11] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4338;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4338, '.txt', @content, convert(datetime, '2021-02-28 15:42:51', 120), convert(datetime, '2021-02-28 15:43:04', 120));
2021-02-28 15:43:44,509 [11] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\pem.task\i.txt
2021-02-28 15:43:44,509 [11] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1463;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1463, 4338, @content
          , convert(datetime, '2021-02-28 15:42:51', 120), convert(datetime, '2021-02-28 15:43:04', 120));
2021-02-28 15:43:44,509 [11] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\pem.task\i.txt
2021-02-28 15:43:44,509 [11] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1463) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 15:43:44,524 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'ringo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'ringo.task', 1, convert(datetime, '2021-02-28 15:40:15', 120), convert(datetime, '2021-02-28 15:40:15', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:40:15', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:15', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:43:44,524 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1841 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1841, null, left('ringo', 150)
            , NULL, NULL, convert(datetime, '2021-02-28 15:40:05', 120), 1
            , NULL, NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = NULL, dt_upd = convert(datetime, '2021-02-28 15:40:05', 120)
         , title = left('ringo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(NULL, getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate())
          or isnull(title, '') <> isnull('ringo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:44,524 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1841 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1841, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 15:39:54', 120), convert(datetime, '2021-02-28 15:40:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:39:54', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:39:54', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:44,529 [11] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1462) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 15:43:44,529 [11] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:43:44,529 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '4')
        else update users_cache set var_value = substring('4', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:43:44,529 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:43:44,529 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 15:43:30')
        else update users_cache set var_value = substring('2021/02/28 15:43:30', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:43:44,539 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:43:44')
        else update users_cache set var_value = substring('2021/02/28 15:43:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 15:43:47,283 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:47,285 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:47,286 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:47,287 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:47,288 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:47,289 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:47,290 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:47,291 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:47,291 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:47,292 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:47,293 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:47,294 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:47,295 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:47,295 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:47,296 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:47,297 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:47,298 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:47,299 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:47,299 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:47,300 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:47,301 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:47,302 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:47,303 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:47,303 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:47,304 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:47,305 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:47,315 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:47,879 [27] INFO dn_lib.tools.log - reload config docs
2021-02-28 15:43:47,879 [27] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:47,879 [27] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:47,889 [27] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:47,896 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:47,896 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:47,897 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:47,899 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:47,899 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:47,900 [27] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:47,901 [27] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 15:43:47,901 [27] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 15:43:47,902 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 15:43:47,903 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 15:43:47,904 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 15:43:47,904 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 15:43:47,905 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 15:43:47,905 [27] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 15:43:47,906 [27] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 15:43:47,916 [27] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '3lgsihzguznoqdkfvxvdqeqi', dt_session_id = getdate() where client_key = '4B9F997FC46D20C3B1D6';
 select top 1 1 from clients where client_key = '4B9F997FC46D20C3B1D6' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 15:43:47,925 [27] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 15:43:47,927 [27] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 15:43:47,928 [27] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 15:43:47,929 [27] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 15:43:47,930 [27] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'pem.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'pem.task', 1, convert(datetime, '2021-02-28 15:42:43', 120), convert(datetime, '2021-02-28 15:43:30', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:42:43', 120), dt_lwt = convert(datetime, '2021-02-28 15:43:30', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:42:43', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:43:30', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1842 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1842, null, left('pem', 150)
            , NULL, convert(datetime, '2021-01-20 00:00:00', 120), convert(datetime, '2021-02-28 15:42:52', 120), 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-01-20 00:00:00', 120), dt_upd = convert(datetime, '2021-02-28 15:42:52', 120)
         , title = left('pem', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-01-20 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:42:52', 120), getdate())
          or isnull(title, '') <> isnull('pem', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1842 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1842, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 15:42:51', 120), convert(datetime, '2021-02-28 15:43:04', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:42:51', 120), dt_lwt = convert(datetime, '2021-02-28 15:43:04', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:42:51', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:43:04', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1463) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'ringo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'ringo.task', 1, convert(datetime, '2021-02-28 15:40:15', 120), convert(datetime, '2021-02-28 15:40:15', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 15:40:15', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:15', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:15', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1841 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1841, null, left('ringo', 150)
            , NULL, NULL, convert(datetime, '2021-02-28 15:40:05', 120), 1
            , NULL, NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = NULL, dt_upd = convert(datetime, '2021-02-28 15:40:05', 120)
         , title = left('ringo', 150), [user] = NULL
         , stato = NULL, priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(NULL, getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate())
          or isnull(title, '') <> isnull('ringo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull(NULL, '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:47,939 [27] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1841 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1841, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 15:39:54', 120), convert(datetime, '2021-02-28 15:40:05', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 15:39:54', 120), dt_lwt = convert(datetime, '2021-02-28 15:40:05', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 15:39:54', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 15:40:05', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 15:43:47,948 [27] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1462) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 15:43:47,948 [27] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 15:43:47,948 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '4')
        else update users_cache set var_value = substring('4', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 15:43:47,948 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 15:43:47,948 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 15:43:30')
        else update users_cache set var_value = substring('2021/02/28 15:43:30', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 15:43:47,948 [27] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 15:43:47')
        else update users_cache set var_value = substring('2021/02/28 15:43:47', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:34:53,388 [9] INFO dn_lib.tools.log - reload core
2021-02-28 16:34:53,422 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:34:53,425 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,426 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,427 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,429 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,430 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,441 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,443 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,444 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,445 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,447 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,448 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,450 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,452 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,452 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,453 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,454 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,455 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,461 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,463 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,464 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,465 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,466 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,467 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,468 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,470 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:34:53,513 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:34:53,537 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:34:53,538 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,539 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,541 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,542 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,543 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,544 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,545 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,546 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,546 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,547 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,548 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,549 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,549 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,550 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,550 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,551 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,552 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,552 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,553 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,553 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,554 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,555 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,555 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,556 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,556 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:34:53,568 [7] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:34:53,592 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:34:53,593 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,594 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,595 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,596 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,596 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,597 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,598 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,599 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,600 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,601 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,602 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,603 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,604 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,604 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,605 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,606 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,606 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:53,607 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:53,608 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:53,609 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:53,610 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:53,611 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:53,612 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:53,613 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:53,616 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:34:53,631 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:34:53,643 [9] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:34:53,647 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:34:53,652 [9] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:34:53,665 [9] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:34:53,674 [9] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:34:53,700 [9] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:34:53,717 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:34:53,805 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:34:53,808 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:34:53,810 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:34:58,910 [8] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:34:58,912 [8] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:58,913 [8] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:58,914 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:58,915 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:58,915 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:58,916 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:58,917 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:58,917 [8] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:58,918 [8] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:58,919 [8] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:58,920 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:58,920 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:58,920 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:58,921 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:58,921 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:58,922 [8] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:58,923 [8] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:58,924 [8] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:58,925 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:58,925 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:58,926 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:58,927 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:58,927 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:58,928 [8] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:58,929 [8] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:34:58,940 [8] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:34:58,958 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:34:58,959 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:58,960 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:58,961 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:58,962 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:58,963 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:58,964 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:58,964 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:58,965 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:58,966 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:58,967 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:58,967 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:58,968 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:58,968 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:58,969 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:58,970 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:58,970 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:58,971 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:58,972 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:58,972 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:58,973 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:58,974 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:58,975 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:58,976 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:58,976 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:58,977 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:34:58,987 [7] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:34:58,993 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:34:58,994 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:58,994 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:58,995 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:58,996 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:58,996 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:58,997 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:58,997 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:58,998 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:58,999 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:59,000 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:59,000 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:59,001 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:59,002 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:59,002 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:59,003 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:59,003 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:59,004 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:59,004 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:59,005 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:59,006 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:59,006 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:59,007 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:59,008 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:59,008 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:59,009 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:34:59,019 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:34:59,573 [8] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:34:59,574 [8] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:59,575 [8] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:59,575 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:59,576 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:59,577 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:59,577 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:59,578 [8] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:59,579 [8] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:59,579 [8] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:59,580 [8] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:59,580 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:59,581 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:59,582 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:59,582 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:59,583 [8] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:59,584 [8] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:59,584 [8] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:34:59,585 [8] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:34:59,585 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:34:59,586 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:34:59,586 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:34:59,587 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:34:59,588 [8] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:34:59,588 [8] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:34:59,589 [8] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:34:59,598 [8] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:34:59,646 [8] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:34:59,650 [8] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:34:59,653 [8] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:34:59,655 [8] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:34:59,658 [8] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:34:59,660 [8] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:34:59,662 [8] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:34:59,665 [8] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:34:59,671 [8] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:34:59,672 [8] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:34:59,675 [8] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:34:59,676 [8] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:34:59,679 [8] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:34:59,680 [8] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:34:59,687 [8] DEBUG dn_lib.tools.log - cancellati dal database: 2 files
2021-02-28 16:34:59,687 [8] DEBUG dn_lib.tools.log - cancellati dal database: 2 folders
2021-02-28 16:34:59,688 [8] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:34:59,692 [8] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:34:59,695 [8] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:34:59,699 [8] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:34:59')
        else update users_cache set var_value = substring('2021/02/28 16:34:59', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:35:03,940 [10] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:35:03,941 [10] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:03,942 [10] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:03,943 [10] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:03,944 [10] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:03,945 [10] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:03,946 [10] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:03,947 [10] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:03,948 [10] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:03,948 [10] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:03,949 [10] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:03,950 [10] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:03,951 [10] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:03,951 [10] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:03,952 [10] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:03,952 [10] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:03,953 [10] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:03,954 [10] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:03,955 [10] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:03,956 [10] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:03,957 [10] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:03,958 [10] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:03,959 [10] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:03,959 [10] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:03,960 [10] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:03,961 [10] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:35:03,973 [10] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:35:04,526 [13] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:35:04,528 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:04,529 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:04,530 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:04,531 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:04,532 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:04,533 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:04,534 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:04,535 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:04,536 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:04,537 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:04,538 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:04,538 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:04,539 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:04,540 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:04,540 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:04,541 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:04,542 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:04,542 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:04,544 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:04,544 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:04,545 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:04,546 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:04,546 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:04,547 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:04,548 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:35:04,559 [13] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:35:04,570 [13] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:35:04,573 [13] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:35:04,575 [13] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:35:04,576 [13] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:35:04,578 [13] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:35:04,580 [13] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:35:04,581 [13] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:35:04,582 [13] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:35:04,585 [13] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:35:04,585 [13] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:35:04,587 [13] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:35:04,587 [13] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:35:04,590 [13] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:35:04,591 [13] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:35:04,597 [13] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:35:04,601 [13] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:35:04,605 [13] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:35:04,608 [13] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:35:04')
        else update users_cache set var_value = substring('2021/02/28 16:35:04', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:35:51,808 [13] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:35:51,809 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:51,810 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:51,811 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:51,812 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:51,813 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:51,815 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:51,816 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:51,817 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:51,818 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:51,819 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:51,820 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:51,820 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:51,821 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:51,822 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:51,823 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:51,824 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:51,825 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:51,826 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:51,826 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:51,827 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:51,828 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:51,829 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:51,830 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:51,831 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:51,832 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:35:51,843 [13] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:35:52,400 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:35:52,402 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:52,403 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:52,405 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:52,406 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:52,407 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:52,408 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:52,409 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:52,410 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:52,411 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:52,412 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:52,413 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:52,413 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:52,414 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:52,415 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:52,416 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:52,416 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:52,417 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:35:52,418 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:35:52,418 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:35:52,419 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:35:52,420 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:35:52,420 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:35:52,421 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:35:52,422 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:35:52,422 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:35:52,432 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:35:52,442 [9] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:35:52,444 [9] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:35:52,445 [9] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:35:52,446 [9] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:35:52,447 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:35:52,448 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:35:52,449 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:35:52,450 [9] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:35:52,451 [9] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:35:52,452 [9] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:35:52,453 [9] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:35:52,454 [9] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:35:52,455 [9] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:35:52,456 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id is null and file_name = '20210120.incorso.grigo.task.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, null, '20210120.incorso.grigo.task.txt', '.txt', 1, convert(datetime, '2021-02-28 16:35:09', 120), convert(datetime, '2021-02-28 16:35:22', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:35:09', 120), dt_lwt = convert(datetime, '2021-02-28 16:35:22', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:09', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:22', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:35:52,461 [9] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\20210120.incorso.grigo.task.txt
2021-02-28 16:35:52,464 [9] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4339;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4339, '.txt', @content, convert(datetime, '2021-02-28 16:35:09', 120), convert(datetime, '2021-02-28 16:35:22', 120));
2021-02-28 16:35:52,468 [9] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\20210120.incorso.grigo.task.txt
2021-02-28 16:35:52,473 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 0 and isnull(file_id, 0) = 4339;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, null, 4339, left('grigo', 150)
            , NULL, convert(datetime, '2021-01-20 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-01-20 00:00:00', 120), dt_upd = NULL
         , title = left('grigo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-01-20 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('grigo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:35:52,480 [9] DEBUG dn_lib.tools.log - inserito task nel database: C:\root\todd\_test\dn\grigo
2021-02-28 16:35:52,482 [9] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1464;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1464, 4339, @content
          , convert(datetime, '2021-02-28 16:35:09', 120), convert(datetime, '2021-02-28 16:35:22', 120));
2021-02-28 16:35:52,485 [9] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\20210120.incorso.grigo.task.txt
2021-02-28 16:35:52,487 [9] DEBUG dn_lib.tools.log - trasformazione task file in task folder: C:\root\todd\_test\dn\20210120.incorso.grigo.task.txt
2021-02-28 16:35:52,488 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20210120.incorso.grigo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20210120.incorso.grigo.task', 1, convert(datetime, '2021-02-28 16:35:52', 120), convert(datetime, '2021-02-28 16:35:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:35:52', 120), dt_lwt = convert(datetime, '2021-02-28 16:35:52', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:52', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:35:52,492 [9] DEBUG dn_lib.tools.log - creato folder: C:\root\todd\_test\dn\20210120.incorso.grigo.task
2021-02-28 16:35:52,494 [9] DEBUG dn_lib.tools.log - SQL: update dn_files set synch_folder_id = 1, folder_id = 1843, file_name = 'i.txt', dt_upd = getdate()
        where file_id = 4339;
      
2021-02-28 16:35:52,497 [9] DEBUG dn_lib.tools.log - SQL: update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120), folder_id = 1843, file_id = null
        where task_id = 1464;
2021-02-28 16:35:52,500 [9] DEBUG dn_lib.tools.log - spostato file da: C:\root\todd\_test\dn\20210120.incorso.grigo.task.txt, a:C:\root\todd\_test\dn\20210120.incorso.grigo.task\i.txt
2021-02-28 16:35:52,501 [9] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1464;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_upd)
        values (1464, 4339, @content
          , convert(datetime, convert(varchar, getdate(), 120), 120), convert(datetime, convert(varchar, getdate(), 120), 120));
      update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120) where task_id = 1464;
2021-02-28 16:35:52,505 [9] DEBUG dn_lib.tools.log - salvate le note del task: C:\root\todd\_test\dn\20210120.incorso.grigo.task
2021-02-28 16:35:52,512 [9] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20210120.incorso.grigo.task, in: C:\root\todd\_test\dn\grigo.task
2021-02-28 16:35:52,514 [9] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'grigo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1843
2021-02-28 16:35:52,521 [9] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\grigo.task\__i.xml
2021-02-28 16:35:52,522 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1843 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1843, null, left('grigo', 150)
            , NULL, convert(datetime, '2021-01-20 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-02-28 16:35:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-01-20 00:00:00', 120), dt_upd = NULL
         , title = left('grigo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 16:35:52', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-01-20 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('grigo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:35:52,529 [9] DEBUG dn_lib.tools.log - aggiornato task nel database: grigo
2021-02-28 16:35:52,530 [9] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:35:52,536 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:35:52,540 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:35:52,541 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:35:22')
        else update users_cache set var_value = substring('2021/02/28 16:35:22', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:35:52,545 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:35:52')
        else update users_cache set var_value = substring('2021/02/28 16:35:52', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:38:42,236 [13] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:38:42,238 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:38:42,239 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:38:42,240 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:38:42,240 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:38:42,241 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:38:42,242 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:38:42,243 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:38:42,244 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:38:42,244 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:38:42,245 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:38:42,246 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:38:42,247 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:38:42,248 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:38:42,248 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:38:42,249 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:38:42,250 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:38:42,250 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:38:42,251 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:38:42,252 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:38:42,253 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:38:42,254 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:38:42,255 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:38:42,256 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:38:42,256 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:38:42,257 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:38:42,265 [13] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:38:42,829 [14] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:38:42,830 [14] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:38:42,832 [14] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:38:42,834 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:38:42,835 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:38:42,836 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:38:42,837 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:38:42,838 [14] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:38:42,839 [14] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:38:42,840 [14] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:38:42,841 [14] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:38:42,841 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:38:42,842 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:38:42,842 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:38:42,843 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:38:42,844 [14] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:38:42,845 [14] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:38:42,845 [14] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:38:42,846 [14] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:38:42,847 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:38:42,847 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:38:42,848 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:38:42,849 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:38:42,850 [14] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:38:42,850 [14] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:38:42,851 [14] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:38:42,862 [14] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:38:42,871 [14] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:38:42,874 [14] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:38:42,876 [14] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:38:42,877 [14] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:38:42,879 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:38:42,881 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:38:42,882 [14] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:38:42,883 [14] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:38:42,885 [14] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:38:42,886 [14] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:38:42,887 [14] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:38:42,888 [14] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:38:42,892 [14] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:38:42,893 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'grigo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'grigo.task', 1, convert(datetime, '2021-02-28 16:35:52', 120), convert(datetime, '2021-02-28 16:35:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:35:52', 120), dt_lwt = convert(datetime, '2021-02-28 16:35:52', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:52', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:38:42,898 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1843 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1843, null, left('grigo', 150)
            , NULL, convert(datetime, '2021-01-20 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-01-20 00:00:00', 120), dt_upd = NULL
         , title = left('grigo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-01-20 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('grigo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:38:42,904 [14] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1843 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1843, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:35:09', 120), convert(datetime, '2021-02-28 16:35:22', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:35:09', 120), dt_lwt = convert(datetime, '2021-02-28 16:35:22', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:09', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:22', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:38:42,910 [14] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1464) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:38:42,916 [14] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:38:42,922 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:38:42,926 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:38:42,929 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:35:52')
        else update users_cache set var_value = substring('2021/02/28 16:35:52', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:38:42,932 [14] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:38:42')
        else update users_cache set var_value = substring('2021/02/28 16:38:42', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:39:33,740 [13] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:39:33,741 [13] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:39:33,742 [13] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:39:33,743 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:39:33,744 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:39:33,745 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:39:33,747 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:39:33,748 [13] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:39:33,748 [13] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:39:33,749 [13] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:39:33,750 [13] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:39:33,750 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:39:33,751 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:39:33,751 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:39:33,752 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:39:33,753 [13] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:39:33,753 [13] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:39:33,753 [13] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:39:33,754 [13] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:39:33,755 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:39:33,755 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:39:33,756 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:39:33,757 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:39:33,757 [13] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:39:33,757 [13] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:39:33,758 [13] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:39:33,768 [13] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:39:34,327 [15] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:39:34,328 [15] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:39:34,329 [15] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:39:34,331 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:39:34,332 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:39:34,333 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:39:34,334 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:39:34,335 [15] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:39:34,336 [15] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:39:34,337 [15] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:39:34,337 [15] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:39:34,338 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:39:34,339 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:39:34,339 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:39:34,340 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:39:34,341 [15] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:39:34,342 [15] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:39:34,343 [15] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:39:34,343 [15] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:39:34,344 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:39:34,345 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:39:34,346 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:39:34,348 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:39:34,348 [15] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:39:34,349 [15] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:39:34,350 [15] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:39:34,360 [15] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'aiibe5jb4dcwbfpfjlzdypa0', dt_session_id = getdate() where client_key = 'BE46B3281D5990A43527';
 select top 1 1 from clients where client_key = 'BE46B3281D5990A43527' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:39:34,369 [15] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:39:34,372 [15] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:39:34,374 [15] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:39:34,376 [15] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:39:34,377 [15] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:39:34,379 [15] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:39:34,380 [15] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:39:34,381 [15] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:39:34,384 [15] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:39:34,385 [15] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:39:34,386 [15] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:39:34,387 [15] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:39:34,390 [15] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:39:34,391 [15] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20190101.20200102.orches.ok.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20190101.20200102.orches.ok.task', 1, convert(datetime, '2021-02-28 16:38:51', 120), convert(datetime, '2021-02-28 16:39:24', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:38:51', 120), dt_lwt = convert(datetime, '2021-02-28 16:39:24', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:38:51', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:39:24', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:39:34,396 [15] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20190101.20200102.orches.ok.task
2021-02-28 16:39:34,400 [15] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20190101.20200102.orches.ok.task, in: C:\root\todd\_test\dn\orches.task
2021-02-28 16:39:34,400 [15] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'orches.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1844
2021-02-28 16:39:34,409 [15] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\orches.task\__i.xml
2021-02-28 16:39:34,410 [15] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1844 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1844, null, left('orches', 150)
            , NULL, convert(datetime, '2019-01-01 00:00:00', 120), convert(datetime, '2020-01-02 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-02-28 16:39:34', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-01-01 00:00:00', 120), dt_upd = convert(datetime, '2020-01-02 00:00:00', 120)
         , title = left('orches', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 16:39:34', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2020-01-02 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('orches', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:39:34,416 [15] DEBUG dn_lib.tools.log - aggiunto task al database: orches
2021-02-28 16:39:34,417 [15] ERROR dn_lib.tools.log - Impossibile trovare una parte del percorso 'C:\root\todd\_test\dn\20190101.20200102.orches.ok.task'.
2021-02-28 16:39:34,418 [15] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'grigo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'grigo.task', 1, convert(datetime, '2021-02-28 16:35:52', 120), convert(datetime, '2021-02-28 16:35:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:35:52', 120), dt_lwt = convert(datetime, '2021-02-28 16:35:52', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:52', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:39:34,424 [15] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1843 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1843, null, left('grigo', 150)
            , NULL, convert(datetime, '2021-01-20 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2021-01-20 00:00:00', 120), dt_upd = NULL
         , title = left('grigo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-01-20 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('grigo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:39:34,431 [15] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1843 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1843, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:35:09', 120), convert(datetime, '2021-02-28 16:35:22', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:35:09', 120), dt_lwt = convert(datetime, '2021-02-28 16:35:22', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:09', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:35:22', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:39:34,436 [15] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1464) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:39:34,442 [15] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:39:34,449 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '3')
        else update users_cache set var_value = substring('3', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:39:34,453 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:39:34,457 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:39:30')
        else update users_cache set var_value = substring('2021/02/28 16:39:30', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:39:34,460 [15] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:39:34')
        else update users_cache set var_value = substring('2021/02/28 16:39:34', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:48:19,383 [23] INFO dn_lib.tools.log - reload core
2021-02-28 16:48:19,417 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:19,419 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,420 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,421 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,423 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,424 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,434 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,436 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,437 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,438 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,439 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,440 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,441 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,442 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,444 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,444 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,445 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,446 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,453 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,455 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,456 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,457 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,458 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,459 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,460 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,462 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:19,484 [23] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:19,500 [31] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:19,501 [31] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,502 [31] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,503 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,505 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,506 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,506 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,507 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,508 [31] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,509 [31] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,510 [31] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,511 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,512 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,512 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,513 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,513 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,514 [31] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,514 [31] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,515 [31] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,516 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,516 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,517 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,518 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,518 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,519 [31] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,520 [31] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:19,530 [31] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:19,553 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:19,554 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,555 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,556 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,557 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,558 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,559 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,560 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,561 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,562 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,563 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,564 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,565 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,565 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,566 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,567 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,567 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,568 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:19,569 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:19,570 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:19,571 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:19,572 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:19,572 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:19,573 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:19,574 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:19,578 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:19,590 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:19,607 [9] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:48:19,611 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:48:19,616 [9] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:48:19,627 [9] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:48:19,637 [9] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:48:19,663 [9] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:48:19,675 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:48:19,761 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:48:19,764 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:48:19,766 [9] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:48:24,741 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:24,742 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,744 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,745 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,745 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,746 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,747 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,748 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,749 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,749 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,750 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,751 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,752 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,752 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,753 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,754 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,754 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,755 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,756 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,756 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,757 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,758 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,759 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,760 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,761 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,761 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:24,771 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:24,785 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:24,786 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,787 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,787 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,788 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,789 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,790 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,791 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,792 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,792 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,793 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,794 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,794 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,795 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,796 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,796 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,797 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,798 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,799 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,799 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,800 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,801 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,801 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,802 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,803 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,804 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:24,814 [20] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:24,819 [31] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:24,820 [31] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,821 [31] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,822 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,823 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,824 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,824 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,825 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,826 [31] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,827 [31] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,828 [31] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,828 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,829 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,829 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,830 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,830 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,831 [31] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,831 [31] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:24,832 [31] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:24,833 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:24,833 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:24,834 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:24,835 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:24,835 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:24,836 [31] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:24,836 [31] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:24,845 [31] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:25,398 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:25,400 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:25,401 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:25,402 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:25,403 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:25,404 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:25,405 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:25,405 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:25,406 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:25,407 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:25,408 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:25,409 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:25,409 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:25,410 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:25,411 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:25,412 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:25,412 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:25,413 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:25,414 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:25,415 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:25,415 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:25,416 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:25,417 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:25,418 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:25,418 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:25,419 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:25,429 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:25,479 [30] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:48:25,482 [30] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:48:25,486 [30] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:48:25,488 [30] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:48:25,490 [30] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:48:25,492 [30] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:48:25,493 [30] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:48:25,495 [30] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:48:25,501 [30] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:48:25,502 [30] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:48:25,503 [30] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:48:25,505 [30] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:48:25,509 [30] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:48:25,510 [30] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:48:25,517 [30] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-02-28 16:48:25,517 [30] DEBUG dn_lib.tools.log - cancellati dal database: 2 folders
2021-02-28 16:48:25,518 [30] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:48:25,522 [30] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:48:25,525 [30] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:48:25,528 [30] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:48:25')
        else update users_cache set var_value = substring('2021/02/28 16:48:25', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:48:27,576 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:27,577 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:27,578 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:27,579 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:27,580 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:27,581 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:27,581 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:27,582 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:27,583 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:27,583 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:27,584 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:27,585 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:27,585 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:27,586 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:27,586 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:27,587 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:27,587 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:27,588 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:27,588 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:27,589 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:27,590 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:27,590 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:27,591 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:27,592 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:27,593 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:27,594 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:27,604 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:28,151 [18] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:48:28,153 [18] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:28,155 [18] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:28,156 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:28,158 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:28,159 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:28,160 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:28,161 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:28,162 [18] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:28,163 [18] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:28,164 [18] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:28,165 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:28,165 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:28,166 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:28,167 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:28,167 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:28,168 [18] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:28,169 [18] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:48:28,170 [18] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:48:28,171 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:48:28,171 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:48:28,172 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:48:28,174 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:48:28,175 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:48:28,175 [18] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:48:28,176 [18] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:48:28,186 [18] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:48:28,197 [18] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:48:28,199 [18] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:48:28,200 [18] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:48:28,201 [18] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:48:28,202 [18] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:48:28,203 [18] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:48:28,204 [18] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:48:28,205 [18] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:48:28,206 [18] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:48:28,207 [18] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:48:28,208 [18] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:48:28,208 [18] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:48:28,210 [18] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:48:28,211 [18] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:48:28,212 [18] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:48:28,213 [18] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '0')
        else update users_cache set var_value = substring('0', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:48:28,214 [18] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/01/05 15:40:09')
        else update users_cache set var_value = substring('2021/01/05 15:40:09', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:48:28,216 [18] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:48:28')
        else update users_cache set var_value = substring('2021/02/28 16:48:28', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:49:44,169 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:44,171 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:44,172 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:44,173 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:44,173 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:44,174 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:44,175 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:44,176 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:44,177 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:44,178 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:44,179 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:44,180 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:44,182 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:44,183 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:44,184 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:44,184 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:44,185 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:44,186 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:44,187 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:44,188 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:44,188 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:44,189 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:44,189 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:44,190 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:44,190 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:44,191 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:44,202 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:44,763 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:44,765 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:44,766 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:44,767 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:44,768 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:44,769 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:44,770 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:44,771 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:44,772 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:44,773 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:44,773 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:44,775 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:44,775 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:44,776 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:44,777 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:44,777 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:44,778 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:44,779 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:44,779 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:44,780 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:44,781 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:44,782 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:44,782 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:44,783 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:44,784 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:44,784 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:44,794 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:44,798 [11] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:49:44,801 [11] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:49:44,803 [11] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:49:44,805 [11] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:49:44,806 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:49:44,808 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:49:44,809 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:49:44,810 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:49:44,812 [11] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:49:44,813 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:49:44,814 [11] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:49:44,814 [11] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:49:44,817 [11] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:49:44,819 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20190101.2019030.pemmm.ok.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20190101.2019030.pemmm.ok.task', 1, convert(datetime, '2021-02-28 16:48:54', 120), convert(datetime, '2021-02-28 16:49:28', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:48:54', 120), dt_lwt = convert(datetime, '2021-02-28 16:49:28', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:48:54', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:28', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:49:44,823 [11] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20190101.2019030.pemmm.ok.task
2021-02-28 16:49:44,834 [11] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20190101.2019030.pemmm.ok.task, in: C:\root\todd\_test\dn\2019030.task
2021-02-28 16:49:44,835 [11] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = '2019030.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1845
2021-02-28 16:49:44,842 [11] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\2019030.task\__i.xml
2021-02-28 16:49:44,844 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1845 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1845, null, left('2019030', 150)
            , NULL, convert(datetime, '2019-01-01 00:00:00', 120), NULL, 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-02-28 16:49:44', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-01-01 00:00:00', 120), dt_upd = NULL
         , title = left('2019030', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 16:49:44', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('2019030', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:49:44,850 [11] DEBUG dn_lib.tools.log - aggiunto task al database: 2019030
2021-02-28 16:49:44,851 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1845 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1845, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:49:12', 120), convert(datetime, '2021-02-28 16:49:40', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:49:12', 120), dt_lwt = convert(datetime, '2021-02-28 16:49:40', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:12', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:40', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:49:44,856 [11] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\2019030.task\i.txt
2021-02-28 16:49:44,862 [11] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4340;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4340, '.txt', @content, convert(datetime, '2021-02-28 16:49:12', 120), convert(datetime, '2021-02-28 16:49:40', 120));
2021-02-28 16:49:44,865 [11] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\2019030.task\i.txt
2021-02-28 16:49:44,866 [11] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1466;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1466, 4340, @content
          , convert(datetime, '2021-02-28 16:49:12', 120), convert(datetime, '2021-02-28 16:49:40', 120));
2021-02-28 16:49:44,869 [11] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\2019030.task\i.txt
2021-02-28 16:49:44,870 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1845 and file_name = 'rincos.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1845, 'rincos.txt', '.txt', 1, convert(datetime, '2021-02-28 16:49:12', 120), convert(datetime, '2021-02-28 16:49:23', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:49:12', 120), dt_lwt = convert(datetime, '2021-02-28 16:49:23', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:12', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:23', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:49:44,873 [11] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\2019030.task\rincos.txt
2021-02-28 16:49:44,879 [11] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4341;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4341, '.txt', @content, convert(datetime, '2021-02-28 16:49:12', 120), convert(datetime, '2021-02-28 16:49:23', 120));
2021-02-28 16:49:44,881 [11] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\2019030.task\rincos.txt
2021-02-28 16:49:44,882 [11] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1466) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:49:44,889 [11] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:49:44,895 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:49:44,899 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:49:44,902 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:49:40')
        else update users_cache set var_value = substring('2021/02/28 16:49:40', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:49:44,905 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:49:44')
        else update users_cache set var_value = substring('2021/02/28 16:49:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:49:48,632 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:48,634 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:48,635 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:48,636 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:48,636 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:48,637 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:48,638 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:48,638 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:48,639 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:48,640 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:48,641 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:48,641 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:48,642 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:48,643 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:48,644 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:48,645 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:48,646 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:48,646 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:48,647 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:48,648 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:48,649 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:48,649 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:48,650 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:48,652 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:48,652 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:48,653 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:48,664 [20] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:49,218 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:49,219 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:49,221 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:49,223 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:49,224 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:49,225 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:49,226 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:49,228 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:49,228 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:49,229 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:49,230 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:49,231 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:49,232 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:49,233 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:49,233 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:49,234 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:49,235 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:49,235 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:49,236 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:49,237 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:49,238 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:49,239 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:49,240 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:49,240 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:49,241 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:49,242 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:49,252 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:49,263 [9] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:49:49,264 [9] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:49:49,265 [9] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:49:49,266 [9] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:49:49,267 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:49:49,268 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:49:49,269 [9] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:49:49,270 [9] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:49:49,271 [9] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:49:49,272 [9] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:49:49,273 [9] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:49:49,274 [9] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:49:49,276 [9] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:49:49,277 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '2019030.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '2019030.task', 1, convert(datetime, '2021-02-28 16:48:54', 120), convert(datetime, '2021-02-28 16:49:44', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:48:54', 120), dt_lwt = convert(datetime, '2021-02-28 16:49:44', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:48:54', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:44', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:49:49,281 [9] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\2019030.task
2021-02-28 16:49:49,282 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1845 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1845, null, left('2019030', 150)
            , NULL, convert(datetime, '2019-01-01 00:00:00', 120), NULL, 1
            , 'fatto', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-01-01 00:00:00', 120), dt_upd = NULL
         , title = left('2019030', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-01-01 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('2019030', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:49:49,288 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1845 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1845, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:49:12', 120), convert(datetime, '2021-02-28 16:49:40', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:49:12', 120), dt_lwt = convert(datetime, '2021-02-28 16:49:40', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:12', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:40', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:49:49,292 [9] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1845 and file_name = 'rincos.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1845, 'rincos.txt', '.txt', 1, convert(datetime, '2021-02-28 16:49:12', 120), convert(datetime, '2021-02-28 16:49:23', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:49:12', 120), dt_lwt = convert(datetime, '2021-02-28 16:49:23', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:12', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:49:23', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:49:49,293 [9] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1466) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:49:49,294 [9] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:49:49,296 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '3')
        else update users_cache set var_value = substring('3', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:49:49,299 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:49:49,301 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:49:44')
        else update users_cache set var_value = substring('2021/02/28 16:49:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:49:49,304 [9] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:49:49')
        else update users_cache set var_value = substring('2021/02/28 16:49:49', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:49:55,468 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:55,471 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,472 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,473 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,474 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,475 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,476 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,476 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,478 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,479 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,480 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,481 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,482 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,483 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,483 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,484 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,485 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,486 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,486 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,487 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,488 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,489 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,490 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,490 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,491 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,492 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:55,504 [20] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:55,516 [9] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:55,517 [9] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,518 [9] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,519 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,520 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,521 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,521 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,522 [9] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,523 [9] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,523 [9] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,524 [9] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,524 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,525 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,526 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,526 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,527 [9] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,528 [9] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,528 [9] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,529 [9] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,530 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,530 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,531 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,531 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,532 [9] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,533 [9] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,533 [9] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:55,543 [9] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:55,548 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:55,549 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,549 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,550 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,551 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,551 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,552 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,553 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,553 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,554 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,554 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,555 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,556 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,556 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,557 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,558 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,558 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,559 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:55,559 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:55,560 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:55,561 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:55,561 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:55,562 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:55,563 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:55,563 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:55,564 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:55,573 [23] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:55,575 [23] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:49:55,577 [23] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:49:55,579 [23] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:49:55,587 [23] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:49:55,593 [23] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:49:55,609 [23] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:49:55,612 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:49:55,614 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:49:55,616 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:49:55,618 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:49:58,504 [31] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:49:58,506 [31] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:58,508 [31] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:58,510 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:58,511 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:58,512 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:58,513 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:58,514 [31] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:58,515 [31] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:58,515 [31] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:58,516 [31] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:58,517 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:58,517 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:58,518 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:58,519 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:58,520 [31] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:58,521 [31] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:58,522 [31] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:49:58,523 [31] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:49:58,523 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:49:58,524 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:49:58,525 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:49:58,525 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:49:58,526 [31] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:49:58,526 [31] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:49:58,527 [31] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:49:58,536 [31] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:49:58,539 [31] DEBUG dn_lib.tools.log - SQL: select content from dn_tasks_notes 
       where task_id = 1466
2021-02-28 16:49:58,542 [31] DEBUG dn_lib.tools.log - SQL: select a.file_id, a.file_name, a.extension, a.http_path , null as found_file       
       , (select top 1 1 from dn_tasks where task_id = a.task_id and file_id = a.file_id) as file_task
      from vw_task_allegati a
      where a.task_id = 1466
2021-02-28 16:50:02,796 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:50:02,797 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:02,798 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:02,799 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:02,799 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:02,800 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:02,801 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:02,803 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:02,803 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:02,804 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:02,805 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:02,806 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:02,806 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:02,807 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:02,808 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:02,808 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:02,810 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:02,811 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:02,811 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:02,811 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:02,812 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:02,813 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:02,813 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:02,814 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:02,815 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:02,815 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:50:02,826 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:50:02,828 [30] DEBUG dn_lib.tools.log - SQL: insert into clients_cmds (client_key, cmd)
  select t.ck, t.cmd
   from (select '1E2C476027529CDD8574' as ck, 'open_att#file_id:4341#user_id:0#user_name:admin' as cmd) t
   join clients c on c.client_key = t.ck and datediff(second, c.dt_refresh, getdate()) < c.interval_ss + 5
2021-02-28 16:50:27,473 [32] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:50:27,474 [32] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:27,475 [32] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:27,476 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:27,477 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:27,477 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:27,478 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:27,479 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:27,480 [32] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:27,481 [32] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:27,482 [32] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:27,483 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:27,483 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:27,484 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:27,485 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:27,486 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:27,487 [32] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:27,488 [32] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:27,489 [32] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:27,490 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:27,491 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:27,491 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:27,493 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:27,494 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:27,494 [32] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:27,495 [32] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:50:27,507 [32] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:50:27,511 [32] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.stato is not null and fl.free_txt = t.item) as free_state
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.priorita is not null and fl.free_txt = t.item) as free_priorita
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.stima is not null and fl.free_txt = t.item) as free_stima
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.tipo is not null and fl.free_txt = t.item) as free_tipo
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join users fl on fl.nome = t.item) as free_assegna
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1466) t2
2021-02-28 16:50:27,546 [32] DEBUG dn_lib.tools.log - SQL: delete from dn_folders where folder_id = 1845;
      
        delete f from dn_files f
          where file_id is not null and not exists (select top 1 1 from dn_folders where folder_id = f.file_id);
          
        delete dn from dn_files_contents dn
          where file_id is not null and not exists (select top 1 1 from dn_files where file_id = dn.file_id);

        delete dn from dn_tasks dn
         where folder_id is not null and not exists (select top 1 1 from dn_folders where folder_id = dn.folder_id);

        delete dn from dn_tasks dn
         where file_id is not null and not exists (select top 1 1 from dn_files where file_id = dn.file_id);
  
        delete dn from dn_tasks_notes dn
         where not exists (select top 1 1 from dn_tasks where task_id = dn.task_id);
2021-02-28 16:50:27,563 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:50:27,564 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:27,565 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:27,566 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:27,567 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:27,568 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:27,569 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:27,570 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:27,570 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:27,571 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:27,572 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:27,573 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:27,574 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:27,575 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:27,576 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:27,576 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:27,577 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:27,578 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:50:27,578 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:50:27,579 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:50:27,580 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:50:27,581 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:50:27,582 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:50:27,583 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:50:27,583 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:50:27,584 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:50:27,595 [7] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:50:27,597 [7] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:50:27,598 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:50:27,600 [7] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:50:27,609 [7] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:50:27,615 [7] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:50:27,631 [7] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:50:27,633 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:50:27,635 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:50:27,637 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:50:27,641 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:51:12,869 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:51:12,871 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,872 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,873 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,873 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,874 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,875 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,876 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,877 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,878 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,879 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,880 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,880 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,882 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,883 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,883 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,884 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,885 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,886 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,887 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,888 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,889 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,890 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,890 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,891 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,892 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:51:12,902 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:51:12,908 [32] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:51:12,909 [32] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,910 [32] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,910 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,911 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,912 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,912 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,913 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,914 [32] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,914 [32] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,915 [32] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,916 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,916 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,917 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,917 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,918 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,919 [32] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,919 [32] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,920 [32] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,921 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,921 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,922 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,923 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,923 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,924 [32] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,924 [32] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:51:12,934 [32] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:51:12,939 [27] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:51:12,940 [27] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,941 [27] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,941 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,942 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,943 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,944 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,945 [27] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,946 [27] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,947 [27] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,948 [27] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,949 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,949 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,950 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,950 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,951 [27] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,952 [27] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,952 [27] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:12,953 [27] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:12,954 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:12,954 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:12,955 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:12,956 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:12,957 [27] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:12,957 [27] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:12,958 [27] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:51:12,967 [27] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:51:13,520 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:51:13,522 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:13,524 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:13,525 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:13,526 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:13,528 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:13,529 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:13,530 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:13,531 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:13,532 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:13,532 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:13,533 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:13,533 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:13,534 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:13,535 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:13,536 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:13,537 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:13,538 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:13,539 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:13,540 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:13,541 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:13,541 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:13,542 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:13,543 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:13,544 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:13,544 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:51:13,555 [23] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:51:13,557 [23] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:51:13,559 [23] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:51:13,561 [23] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:51:13,562 [23] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:51:13,564 [23] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:51:13,565 [23] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:51:13,566 [23] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:51:13,567 [23] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:51:13,570 [23] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:51:13,571 [23] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:51:13,572 [23] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:51:13,573 [23] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:51:13,575 [23] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:51:13,576 [23] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20190202.20190303.pemmm.ok.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20190202.20190303.pemmm.ok.task', 1, convert(datetime, '2021-02-28 16:50:32', 120), convert(datetime, '2021-02-28 16:50:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:50:32', 120), dt_lwt = convert(datetime, '2021-02-28 16:50:52', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:32', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:51:13,581 [23] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20190202.20190303.pemmm.ok.task
2021-02-28 16:51:13,584 [23] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20190202.20190303.pemmm.ok.task, in: C:\root\todd\_test\dn\pemmm.task
2021-02-28 16:51:13,585 [23] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'pemmm.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1846
2021-02-28 16:51:13,592 [23] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\pemmm.task\__i.xml
2021-02-28 16:51:13,593 [23] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1846 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1846, null, left('pemmm', 150)
            , NULL, convert(datetime, '2019-02-02 00:00:00', 120), convert(datetime, '2019-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, convert(datetime, '2021-02-28 16:51:13', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-02-02 00:00:00', 120), dt_upd = convert(datetime, '2019-03-03 00:00:00', 120)
         , title = left('pemmm', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 16:51:13', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2019-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('pemmm', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:51:13,599 [23] DEBUG dn_lib.tools.log - aggiunto task al database: pemmm
2021-02-28 16:51:13,600 [23] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1846 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1846, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:50:51', 120), convert(datetime, '2021-02-28 16:50:57', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:50:51', 120), dt_lwt = convert(datetime, '2021-02-28 16:50:57', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:51', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:57', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:51:13,605 [23] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\pemmm.task\i.txt
2021-02-28 16:51:13,610 [23] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4342;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4342, '.txt', @content, convert(datetime, '2021-02-28 16:50:51', 120), convert(datetime, '2021-02-28 16:50:57', 120));
2021-02-28 16:51:13,612 [23] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\pemmm.task\i.txt
2021-02-28 16:51:13,613 [23] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1467;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1467, 4342, @content
          , convert(datetime, '2021-02-28 16:50:51', 120), convert(datetime, '2021-02-28 16:50:57', 120));
2021-02-28 16:51:13,616 [23] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\pemmm.task\i.txt
2021-02-28 16:51:13,616 [23] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1467) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:51:13,623 [23] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:51:13,629 [23] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:51:13,633 [23] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:51:13,636 [23] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:50:57')
        else update users_cache set var_value = substring('2021/02/28 16:50:57', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:51:13,639 [23] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:51:13')
        else update users_cache set var_value = substring('2021/02/28 16:51:13', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:51:34,338 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:51:34,339 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:34,341 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:34,342 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:34,343 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:34,344 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:34,345 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:34,347 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:34,348 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:34,349 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:34,349 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:34,350 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:34,351 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:34,352 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:34,352 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:34,353 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:34,354 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:34,355 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:34,355 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:34,356 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:34,357 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:34,358 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:34,358 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:34,359 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:34,361 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:34,362 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:51:34,369 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:51:34,928 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:51:34,930 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:34,931 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:34,932 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:34,934 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:34,934 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:34,935 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:34,936 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:34,937 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:34,937 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:34,938 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:34,939 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:34,940 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:34,941 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:34,942 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:34,943 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:34,943 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:34,944 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:51:34,945 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:51:34,946 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:51:34,947 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:51:34,948 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:51:34,949 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:51:34,950 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:51:34,950 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:51:34,951 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:51:34,960 [20] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:51:34,970 [20] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:51:34,973 [20] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:51:34,975 [20] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:51:34,976 [20] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:51:34,978 [20] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:51:34,981 [20] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:51:34,982 [20] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:51:34,983 [20] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:51:34,985 [20] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:51:34,986 [20] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:51:34,987 [20] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:51:34,988 [20] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:51:34,992 [20] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:51:34,993 [20] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'pemmm.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'pemmm.task', 1, convert(datetime, '2021-02-28 16:50:32', 120), convert(datetime, '2021-02-28 16:51:13', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:50:32', 120), dt_lwt = convert(datetime, '2021-02-28 16:51:13', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:32', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:51:13', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:51:34,999 [20] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\pemmm.task
2021-02-28 16:51:35,001 [20] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1846 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1846, null, left('pemmm', 150)
            , NULL, convert(datetime, '2019-02-02 00:00:00', 120), convert(datetime, '2019-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-02-02 00:00:00', 120), dt_upd = convert(datetime, '2019-03-03 00:00:00', 120)
         , title = left('pemmm', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2019-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('pemmm', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:51:35,008 [20] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1846 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1846, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:50:51', 120), convert(datetime, '2021-02-28 16:50:57', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:50:51', 120), dt_lwt = convert(datetime, '2021-02-28 16:50:57', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:51', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:57', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:51:35,014 [20] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1467) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:51:35,020 [20] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:51:35,026 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:51:35,031 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:51:35,034 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:51:13')
        else update users_cache set var_value = substring('2021/02/28 16:51:13', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:51:35,037 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:51:35')
        else update users_cache set var_value = substring('2021/02/28 16:51:35', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:52:25,156 [32] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:52:25,157 [32] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,158 [32] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,160 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,161 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,162 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,163 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,164 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,165 [32] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,165 [32] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,166 [32] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,167 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,168 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,169 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,170 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,171 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,172 [32] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,172 [32] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,173 [32] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,174 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,174 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,175 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,176 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,177 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,177 [32] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,178 [32] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:52:25,188 [32] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:52:25,202 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:52:25,203 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,204 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,205 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,206 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,207 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,208 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,209 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,209 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,210 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,211 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,212 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,213 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,213 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,214 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,215 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,216 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,216 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,217 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,217 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,218 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,219 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,220 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,221 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,221 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,222 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:52:25,231 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:52:25,237 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:52:25,238 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,239 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,240 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,240 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,241 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,242 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,242 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,243 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,244 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,244 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,245 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,246 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,247 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,247 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,248 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,248 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,249 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:25,250 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:25,250 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:25,251 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:25,251 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:25,252 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:25,253 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:25,253 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:25,254 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:52:25,264 [23] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:52:25,266 [23] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:52:25,268 [23] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:52:25,270 [23] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:52:25,278 [23] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:52:25,284 [23] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:52:25,299 [23] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:52:25,303 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:52:25,304 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:52:25,307 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:52:25,310 [23] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:52:32,341 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:52:32,343 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:32,344 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:32,346 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:32,348 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:32,349 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:32,350 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:32,351 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:32,352 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:32,353 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:32,353 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:32,354 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:32,355 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:32,355 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:32,356 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:32,357 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:32,358 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:32,358 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:52:32,359 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:52:32,360 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:52:32,361 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:52:32,362 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:52:32,363 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:52:32,363 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:52:32,364 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:52:32,366 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:52:32,376 [20] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:52:32,389 [20] DEBUG dn_lib.tools.log - SQL: select content from dn_tasks_notes 
       where task_id = 1467
2021-02-28 16:52:32,392 [20] DEBUG dn_lib.tools.log - SQL: select a.file_id, a.file_name, a.extension, a.http_path , null as found_file       
       , (select top 1 1 from dn_tasks where task_id = a.task_id and file_id = a.file_id) as file_task
      from vw_task_allegati a
      where a.task_id = 1467
2021-02-28 16:53:52,316 [16] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:53:52,317 [16] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,319 [16] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,320 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,321 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,321 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,323 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,324 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,324 [16] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,325 [16] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,326 [16] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,326 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,327 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,328 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,329 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,329 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,330 [16] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,331 [16] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,331 [16] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,332 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,333 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,333 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,334 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,335 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,336 [16] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,337 [16] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:53:52,352 [16] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:53:52,372 [34] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:53:52,373 [34] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,374 [34] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,375 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,376 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,377 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,378 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,378 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,379 [34] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,380 [34] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,381 [34] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,382 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,382 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,383 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,384 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,384 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,385 [34] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,386 [34] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,386 [34] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,387 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,388 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,389 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,389 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,390 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,391 [34] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,391 [34] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:53:52,401 [34] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:53:52,407 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:53:52,408 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,408 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,409 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,410 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,410 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,411 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,412 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,412 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,413 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,413 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,414 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,415 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,415 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,416 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,416 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,417 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,417 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,418 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,418 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,419 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,419 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,420 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,421 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,421 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,422 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:53:52,431 [23] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:53:52,985 [11] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:53:52,986 [11] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,988 [11] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,990 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,991 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,992 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,993 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,994 [11] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:52,994 [11] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:52,995 [11] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:52,996 [11] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:52,997 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:52,997 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:52,998 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:52,999 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:52,999 [11] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:53,000 [11] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:53,001 [11] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:53,002 [11] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:53,003 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:53,003 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:53,004 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:53,005 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:53,006 [11] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:53,007 [11] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:53,007 [11] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:53:53,017 [11] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:53:53,019 [11] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:53:53,021 [11] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:53:53,023 [11] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:53:53,025 [11] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:53:53,025 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:53:53,028 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:53:53,028 [11] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:53:53,029 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:53:53,032 [11] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:53:53,032 [11] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:53:53,034 [11] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:53:53,034 [11] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:53:53,039 [11] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:53:53,039 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'pemmm.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'pemmm.task', 1, convert(datetime, '2021-02-28 16:50:32', 120), convert(datetime, '2021-02-28 16:52:39', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:50:32', 120), dt_lwt = convert(datetime, '2021-02-28 16:52:39', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:32', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:52:39', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:53:53,043 [11] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\pemmm.task
2021-02-28 16:53:53,045 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1846 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1846, null, left('pemmm', 150)
            , NULL, convert(datetime, '2019-02-02 00:00:00', 120), convert(datetime, '2019-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-02-02 00:00:00', 120), dt_upd = convert(datetime, '2019-03-03 00:00:00', 120)
         , title = left('pemmm', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2019-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('pemmm', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:53:53,051 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1846 and file_name = 'gringo.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1846, 'gringo.txt', '.txt', 1, convert(datetime, '2021-02-28 16:52:36', 120), convert(datetime, '2021-02-28 16:52:44', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:52:36', 120), dt_lwt = convert(datetime, '2021-02-28 16:52:44', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:52:36', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:52:44', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:53:53,056 [11] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\pemmm.task\gringo.txt
2021-02-28 16:53:53,060 [11] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4343;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4343, '.txt', @content, convert(datetime, '2021-02-28 16:52:36', 120), convert(datetime, '2021-02-28 16:52:44', 120));
2021-02-28 16:53:53,064 [11] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\pemmm.task\gringo.txt
2021-02-28 16:53:53,065 [11] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1846 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1846, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:50:51', 120), convert(datetime, '2021-02-28 16:50:57', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:50:51', 120), dt_lwt = convert(datetime, '2021-02-28 16:50:57', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:51', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:57', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:53:53,069 [11] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1467) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:53:53,075 [11] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:53:53,081 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '3')
        else update users_cache set var_value = substring('3', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:53:53,084 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:53:53,088 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:52:44')
        else update users_cache set var_value = substring('2021/02/28 16:52:44', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:53:53,091 [11] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:53:53')
        else update users_cache set var_value = substring('2021/02/28 16:53:53', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:53:58,115 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:53:58,118 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,119 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,120 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,122 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,122 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,123 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,124 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,125 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,125 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,126 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,127 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,128 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,128 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,129 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,130 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,130 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,131 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,131 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,132 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,132 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,133 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,134 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,134 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,135 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,135 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:53:58,145 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:53:58,159 [32] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:53:58,160 [32] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,161 [32] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,162 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,163 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,163 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,164 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,165 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,165 [32] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,166 [32] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,166 [32] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,167 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,167 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,168 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,169 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,169 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,170 [32] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,170 [32] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,171 [32] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,172 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,173 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,173 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,174 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,175 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,175 [32] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,176 [32] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:53:58,186 [32] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:53:58,191 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:53:58,193 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,194 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,195 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,195 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,196 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,197 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,198 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,199 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,200 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,201 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,201 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,202 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,203 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,204 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,204 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,204 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,205 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:53:58,205 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:53:58,206 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:53:58,206 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:53:58,207 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:53:58,208 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:53:58,208 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:53:58,209 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:53:58,210 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:53:58,219 [7] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:53:58,222 [7] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:53:58,223 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:53:58,226 [7] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:53:58,233 [7] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:53:58,240 [7] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:53:58,257 [7] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:53:58,260 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:53:58,262 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:53:58,265 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:53:58,267 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:54:01,094 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:01,095 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:01,097 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:01,098 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:01,099 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:01,100 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:01,101 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:01,102 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:01,103 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:01,104 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:01,105 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:01,105 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:01,106 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:01,107 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:01,107 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:01,108 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:01,109 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:01,109 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:01,110 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:01,111 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:01,111 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:01,112 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:01,113 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:01,113 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:01,114 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:01,115 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:01,124 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:54:01,127 [12] DEBUG dn_lib.tools.log - SQL: select content from dn_tasks_notes 
       where task_id = 1467
2021-02-28 16:54:01,129 [12] DEBUG dn_lib.tools.log - SQL: select a.file_id, a.file_name, a.extension, a.http_path , null as found_file       
       , (select top 1 1 from dn_tasks where task_id = a.task_id and file_id = a.file_id) as file_task
      from vw_task_allegati a
      where a.task_id = 1467
2021-02-28 16:54:02,544 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:02,545 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:02,546 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:02,547 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:02,548 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:02,549 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:02,549 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:02,550 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:02,551 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:02,552 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:02,553 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:02,553 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:02,554 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:02,555 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:02,555 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:02,556 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:02,557 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:02,557 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:02,558 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:02,559 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:02,560 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:02,560 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:02,561 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:02,562 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:02,562 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:02,563 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:02,572 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:54:02,574 [30] DEBUG dn_lib.tools.log - SQL: insert into clients_cmds (client_key, cmd)
  select t.ck, t.cmd
   from (select '1E2C476027529CDD8574' as ck, 'open_att#file_id:4343#user_id:0#user_name:admin' as cmd) t
   join clients c on c.client_key = t.ck and datediff(second, c.dt_refresh, getdate()) < c.interval_ss + 5
2021-02-28 16:54:11,048 [18] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:11,050 [18] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:11,051 [18] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:11,052 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:11,053 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:11,054 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:11,055 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:11,056 [18] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:11,057 [18] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:11,058 [18] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:11,059 [18] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:11,059 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:11,060 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:11,061 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:11,062 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:11,062 [18] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:11,063 [18] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:11,064 [18] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:11,065 [18] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:11,066 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:11,066 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:11,067 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:11,068 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:11,069 [18] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:11,070 [18] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:11,071 [18] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:11,080 [18] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:54:11,092 [18] DEBUG dn_lib.tools.log - SQL: insert into clients_cmds (client_key, cmd)
  select t.ck, t.cmd
   from (select '1E2C476027529CDD8574' as ck, 'open_att#file_id:4343#user_id:0#user_name:admin' as cmd) t
   join clients c on c.client_key = t.ck and datediff(second, c.dt_refresh, getdate()) < c.interval_ss + 5
2021-02-28 16:54:32,354 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:32,355 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:32,356 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:32,357 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:32,358 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:32,359 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:32,360 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:32,361 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:32,362 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:32,363 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:32,364 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:32,365 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:32,366 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:32,366 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:32,367 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:32,368 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:32,369 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:32,370 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:32,370 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:32,371 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:32,372 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:32,372 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:32,373 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:32,374 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:32,374 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:32,375 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:32,383 [23] DEBUG dn_lib.tools.log - SQL: select f.folder_id, replace((select local_path from synch_folders where synch_folder_id = f.synch_folder_id) 
        + isnull(dbo.folder_path(f.folder_id), '\') + f.file_name , '/', '\') as file_path
       from dn_files f where f.file_id = 4343
2021-02-28 16:54:32,387 [23] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4343;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4343, '.txt', @content, convert(datetime, '2021-02-28 16:54:32', 120), convert(datetime, '2021-02-28 16:54:32', 120));
2021-02-28 16:54:50,414 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:50,415 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,416 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,418 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,419 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,419 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,420 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,421 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,422 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,423 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,423 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,424 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,424 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,425 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,425 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,426 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,426 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,427 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,428 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,428 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,430 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,430 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,431 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,432 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,433 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,434 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:50,442 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:54:50,459 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:50,459 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,460 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,461 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,463 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,463 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,464 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,465 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,466 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,467 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,467 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,468 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,469 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,470 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,471 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,471 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,472 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,473 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,474 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,475 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,476 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,476 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,478 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,478 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,479 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,481 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:50,492 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:54:50,497 [34] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:50,498 [34] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,499 [34] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,500 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,501 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,501 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,502 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,503 [34] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,504 [34] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,505 [34] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,506 [34] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,507 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,508 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,508 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,509 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,510 [34] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,510 [34] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,511 [34] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:50,512 [34] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:50,513 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:50,514 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:50,515 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:50,516 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:50,517 [34] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:50,517 [34] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:50,519 [34] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:50,531 [34] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:54:51,084 [16] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:54:51,085 [16] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:51,085 [16] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:51,086 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:51,087 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:51,087 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:51,088 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:51,090 [16] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:51,090 [16] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:51,090 [16] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:51,091 [16] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:51,092 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:51,093 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:51,094 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:51,094 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:51,095 [16] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:51,095 [16] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:51,096 [16] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:54:51,096 [16] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:54:51,097 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:54:51,098 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:54:51,098 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:54:51,099 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:54:51,099 [16] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:54:51,100 [16] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:54:51,101 [16] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:54:51,110 [16] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = '2vqvsqa35c5jtbzmfzdzaod1', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:54:51,119 [16] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:54:51,121 [16] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:54:51,123 [16] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:54:51,124 [16] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:54:51,125 [16] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:54:51,127 [16] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:54:51,128 [16] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:54:51,129 [16] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:54:51,132 [16] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:54:51,133 [16] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:54:51,134 [16] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:54:51,134 [16] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:54:51,137 [16] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:54:51,138 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'pemmm.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'pemmm.task', 1, convert(datetime, '2021-02-28 16:50:32', 120), convert(datetime, '2021-02-28 16:52:39', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:50:32', 120), dt_lwt = convert(datetime, '2021-02-28 16:52:39', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:32', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:52:39', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:54:51,143 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1846 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1846, null, left('pemmm', 150)
            , NULL, convert(datetime, '2019-02-02 00:00:00', 120), convert(datetime, '2019-03-03 00:00:00', 120), 1
            , 'fatto', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-02-02 00:00:00', 120), dt_upd = convert(datetime, '2019-03-03 00:00:00', 120)
         , title = left('pemmm', 150), [user] = NULL
         , stato = 'fatto', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(convert(datetime, '2019-03-03 00:00:00', 120), getdate())
          or isnull(title, '') <> isnull('pemmm', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('fatto', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:54:51,148 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1846 and file_name = 'gringo.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1846, 'gringo.txt', '.txt', 1, convert(datetime, '2021-02-28 16:52:36', 120), convert(datetime, '2021-02-28 16:54:32', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:52:36', 120), dt_lwt = convert(datetime, '2021-02-28 16:54:32', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:52:36', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:54:32', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:54:51,154 [16] DEBUG dn_lib.tools.log - aggiornato file nel database: C:\root\todd\_test\dn\pemmm.task\gringo.txt
2021-02-28 16:54:51,154 [16] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4343;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4343, '.txt', @content, convert(datetime, '2021-02-28 16:52:36', 120), convert(datetime, '2021-02-28 16:54:32', 120));
2021-02-28 16:54:51,157 [16] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\pemmm.task\gringo.txt
2021-02-28 16:54:51,157 [16] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1846 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1846, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:50:51', 120), convert(datetime, '2021-02-28 16:50:57', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:50:51', 120), dt_lwt = convert(datetime, '2021-02-28 16:50:57', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:51', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:50:57', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:54:51,162 [16] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1467) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:54:51,168 [16] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:54:51,174 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '3')
        else update users_cache set var_value = substring('3', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:54:51,178 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:54:51,183 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:54:32')
        else update users_cache set var_value = substring('2021/02/28 16:54:32', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:54:51,186 [16] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:54:51')
        else update users_cache set var_value = substring('2021/02/28 16:54:51', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:56:06,615 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:56:06,618 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,620 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,621 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,622 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,622 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,623 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,624 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,625 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,626 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,626 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,628 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,628 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,629 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,630 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,630 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,631 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,632 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,633 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,634 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,635 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,636 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,637 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,637 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,638 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,639 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:56:06,649 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'znykkklddxzf01xhyljb1j35', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:56:06,669 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:56:06,670 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,671 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,672 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,672 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,673 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,674 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,675 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,676 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,677 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,677 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,678 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,678 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,679 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,680 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,680 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,681 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,683 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,684 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,685 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,686 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,687 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,687 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,688 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,689 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,690 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:56:06,701 [30] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'znykkklddxzf01xhyljb1j35', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:56:06,705 [36] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:56:06,706 [36] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,707 [36] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,708 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,709 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,710 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,710 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,711 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,713 [36] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,713 [36] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,713 [36] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,714 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,714 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,715 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,716 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,718 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,719 [36] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,719 [36] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:06,720 [36] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:06,721 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:06,721 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:06,722 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:06,723 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:06,725 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:06,726 [36] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:06,727 [36] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:56:06,737 [36] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'znykkklddxzf01xhyljb1j35', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:56:06,738 [36] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:56:06,740 [36] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:56:06,742 [36] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:56:06,751 [36] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:56:06,758 [36] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:56:06,775 [36] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:56:06,778 [36] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:56:06,780 [36] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:56:06,784 [36] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:56:06,787 [36] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:56:11,674 [23] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:56:11,675 [23] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,677 [23] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,678 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,678 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,679 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,680 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,681 [23] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,682 [23] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,683 [23] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,684 [23] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,684 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,685 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,686 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,686 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,686 [23] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,687 [23] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,688 [23] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,688 [23] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,689 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,689 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,690 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,691 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,691 [23] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,692 [23] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,692 [23] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:56:11,703 [23] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'znykkklddxzf01xhyljb1j35', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:56:11,717 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:56:11,718 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,719 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,720 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,720 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,722 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,723 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,723 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,724 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,725 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,725 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,726 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,727 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,727 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,728 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,728 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,729 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,729 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,730 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,731 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,731 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,732 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,733 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,734 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,734 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,735 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:56:11,744 [12] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'znykkklddxzf01xhyljb1j35', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:56:11,749 [32] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:56:11,751 [32] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,751 [32] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,752 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,753 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,753 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,754 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,755 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,755 [32] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,756 [32] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,756 [32] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,757 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,757 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,758 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,758 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,759 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,759 [32] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,760 [32] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:11,760 [32] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:11,761 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:11,762 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:11,762 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:11,763 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:11,764 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:11,764 [32] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:11,765 [32] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:56:11,775 [32] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'znykkklddxzf01xhyljb1j35', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:56:12,328 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:56:12,330 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:12,332 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:12,333 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:12,334 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:12,335 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:12,336 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:12,337 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:12,338 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:12,339 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:12,339 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:12,340 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:12,341 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:12,341 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:12,342 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:12,343 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:12,344 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:12,344 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:56:12,345 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:56:12,346 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:56:12,347 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:56:12,348 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:56:12,349 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:56:12,349 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:56:12,350 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:56:12,351 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:56:12,361 [20] DEBUG dn_lib.tools.log - SQL: 
 update clients set session_id = 'znykkklddxzf01xhyljb1j35', dt_session_id = getdate() where client_key = '1E2C476027529CDD8574';
 select top 1 1 from clients where client_key = '1E2C476027529CDD8574' 
  and datediff(second, dt_refresh, getdate()) < interval_ss + 5;
2021-02-28 16:56:12,370 [20] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:56:12,372 [20] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:56:12,374 [20] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:56:12,376 [20] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:56:12,378 [20] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:56:12,379 [20] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:56:12,381 [20] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:56:12,382 [20] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:56:12,384 [20] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:56:12,385 [20] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:56:12,386 [20] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:56:12,387 [20] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:56:12,391 [20] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:56:12,392 [20] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20190202.illo.incorso.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20190202.illo.incorso.task', 1, convert(datetime, '2021-02-28 16:55:33', 120), convert(datetime, '2021-02-28 16:55:51', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:55:33', 120), dt_lwt = convert(datetime, '2021-02-28 16:55:51', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:55:33', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:55:51', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:56:12,397 [20] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20190202.illo.incorso.task
2021-02-28 16:56:12,399 [20] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20190202.illo.incorso.task, in: C:\root\todd\_test\dn\illo.task
2021-02-28 16:56:12,400 [20] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'illo.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1847
2021-02-28 16:56:12,407 [20] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\illo.task\__i.xml
2021-02-28 16:56:12,408 [20] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1847 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1847, null, left('illo', 150)
            , NULL, convert(datetime, '2019-02-02 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-02-28 16:56:12', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-02-02 00:00:00', 120), dt_upd = NULL
         , title = left('illo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 16:56:12', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('illo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:56:12,415 [20] DEBUG dn_lib.tools.log - aggiunto task al database: illo
2021-02-28 16:56:12,416 [20] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1847 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1847, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:55:50', 120), convert(datetime, '2021-02-28 16:55:56', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:55:50', 120), dt_lwt = convert(datetime, '2021-02-28 16:55:56', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:55:50', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:55:56', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:56:12,421 [20] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\illo.task\i.txt
2021-02-28 16:56:12,426 [20] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4344;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4344, '.txt', @content, convert(datetime, '2021-02-28 16:55:50', 120), convert(datetime, '2021-02-28 16:55:56', 120));
2021-02-28 16:56:12,428 [20] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\illo.task\i.txt
2021-02-28 16:56:12,429 [20] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1468;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1468, 4344, @content
          , convert(datetime, '2021-02-28 16:55:50', 120), convert(datetime, '2021-02-28 16:55:56', 120));
2021-02-28 16:56:12,432 [20] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\illo.task\i.txt
2021-02-28 16:56:12,432 [20] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1468) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:56:12,439 [20] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:56:12,446 [20] DEBUG dn_lib.tools.log - cancellati dal database: 2 files
2021-02-28 16:56:12,446 [20] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-02-28 16:56:12,447 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:56:12,451 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:56:12,454 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:55:56')
        else update users_cache set var_value = substring('2021/02/28 16:55:56', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:56:12,457 [20] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:56:12')
        else update users_cache set var_value = substring('2021/02/28 16:56:12', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 16:58:31,033 [20] INFO dn_lib.tools.log - reload core
2021-02-28 16:58:31,068 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:31,070 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,071 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,072 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,072 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,073 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,073 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,074 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,075 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,076 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,077 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,078 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,079 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,081 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,082 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,082 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,083 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,084 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,091 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,094 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,095 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,096 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,098 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,099 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,100 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,102 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:31,137 [36] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:31,138 [36] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,139 [36] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,140 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,141 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,143 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,144 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,145 [36] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,146 [36] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,147 [36] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,148 [36] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,148 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,149 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,150 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,150 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,151 [36] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,152 [36] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,153 [36] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,153 [36] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,154 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,155 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,155 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,156 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,157 [36] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,158 [36] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,159 [36] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:31,192 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:31,194 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,195 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,196 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,196 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,197 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,198 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,199 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,200 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,201 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,201 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,202 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,203 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,204 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,205 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,206 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,206 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,207 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:31,208 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:31,209 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:31,210 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:31,210 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:31,211 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:31,212 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:31,213 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:31,216 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:31,241 [12] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:58:31,247 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:58:31,253 [12] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:58:31,263 [12] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:58:31,274 [12] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:58:31,300 [12] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:58:31,313 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:58:31,398 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:58:31,400 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:58:31,403 [12] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:58:52,621 [7] INFO dn_lib.tools.log - reload core
2021-02-28 16:58:52,658 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:52,661 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,662 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,663 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,664 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,665 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,667 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,668 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,670 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,671 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,674 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,676 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,677 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,678 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,679 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,680 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,681 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,682 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,697 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,699 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,700 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,701 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,702 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,703 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,704 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,707 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:52,779 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:52,780 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,780 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,781 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,782 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,783 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,784 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,784 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,785 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,786 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,786 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,787 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,788 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,789 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,790 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,791 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,792 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,793 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,793 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,794 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,795 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,795 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,796 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,797 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,798 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,799 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:52,880 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:52,881 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,881 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,882 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,883 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,884 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,885 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,886 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,887 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,887 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,888 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,889 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,889 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,890 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,892 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,892 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,893 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,894 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:52,895 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:52,895 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:52,896 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:52,897 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:52,898 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:52,899 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:52,899 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:52,901 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:52,926 [7] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 16:58:52,929 [7] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 16:58:52,930 [7] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 16:58:52,932 [7] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 16:58:52,933 [7] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 16:58:52,943 [7] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 16:58:52,955 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 16:58:53,012 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 16:58:53,013 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 16:58:53,014 [7] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 16:58:58,718 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:58,719 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,721 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,722 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,723 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,723 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,724 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,725 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,727 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,727 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,727 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,728 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,729 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,730 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,730 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,731 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,732 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,732 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,733 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,734 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,734 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,735 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,736 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,737 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,737 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,739 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:58,768 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:58,769 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,770 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,771 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,772 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,772 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,773 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,774 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,774 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,775 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,775 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,776 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,777 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,777 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,778 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,778 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,779 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,780 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,780 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,781 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,781 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,782 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,783 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,783 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,784 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,784 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:58,823 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:58,824 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,824 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,825 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,826 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,827 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,827 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,828 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,829 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,829 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,830 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,830 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,831 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,832 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,832 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,833 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,833 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,834 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:58,834 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:58,835 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:58,836 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:58,836 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:58,837 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:58,838 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:58,838 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:58,839 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:59,400 [32] INFO dn_lib.tools.log - reload config docs
2021-02-28 16:58:59,401 [32] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:59,402 [32] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:59,402 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:59,403 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:59,404 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:59,405 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:59,406 [32] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:59,406 [32] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:59,407 [32] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:59,408 [32] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:59,408 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:59,409 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:59,410 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:59,410 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:59,411 [32] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:59,412 [32] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:59,412 [32] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 16:58:59,413 [32] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 16:58:59,413 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 16:58:59,414 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 16:58:59,414 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 16:58:59,415 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 16:58:59,415 [32] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 16:58:59,416 [32] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 16:58:59,417 [32] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 16:58:59,466 [32] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 16:58:59,469 [32] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 16:58:59,472 [32] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 16:58:59,475 [32] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 16:58:59,478 [32] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 16:58:59,480 [32] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 16:58:59,481 [32] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 16:58:59,482 [32] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:59:30,428 [32] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 16:59:30,430 [32] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 16:59:30,432 [32] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 16:59:30,434 [32] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 16:59:30,446 [32] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 16:59:43,313 [32] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'illo.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'illo.task', 1, convert(datetime, '2021-02-28 16:55:33', 120), convert(datetime, '2021-02-28 16:56:12', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 16:55:33', 120), dt_lwt = convert(datetime, '2021-02-28 16:56:12', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:55:33', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:56:12', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 16:59:43,336 [32] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\illo.task
2021-02-28 16:59:43,346 [32] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1847 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1847, null, left('illo', 150)
            , NULL, convert(datetime, '2019-02-02 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2019-02-02 00:00:00', 120), dt_upd = NULL
         , title = left('illo', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2019-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('illo', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:59:43,355 [32] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1847 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1847, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 16:55:50', 120), convert(datetime, '2021-02-28 16:55:56', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 16:55:50', 120), dt_lwt = convert(datetime, '2021-02-28 16:55:56', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 16:55:50', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 16:55:56', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 16:59:43,362 [32] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1468) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 16:59:43,375 [32] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 16:59:43,400 [32] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 16:59:43,416 [32] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 16:59:43,425 [32] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 16:56:12')
        else update users_cache set var_value = substring('2021/02/28 16:56:12', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 16:59:43,430 [32] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 16:59:43')
        else update users_cache set var_value = substring('2021/02/28 16:59:43', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 17:02:07,862 [20] INFO dn_lib.tools.log - reload core
2021-02-28 17:02:07,898 [20] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:07,900 [20] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:07,901 [20] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:07,902 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:07,911 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:07,920 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:07,931 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:07,933 [20] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:07,942 [20] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:07,943 [20] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:07,945 [20] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:07,947 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:07,947 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:07,949 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:07,950 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:07,951 [20] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:07,952 [20] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:07,953 [20] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:07,978 [20] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:07,980 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:07,981 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:07,982 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:07,983 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:07,985 [20] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:07,986 [20] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:07,988 [20] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:08,054 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:08,055 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:08,056 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:08,058 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:08,059 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:08,060 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:08,060 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:08,061 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:08,062 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:08,063 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:08,063 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:08,064 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:08,064 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:08,065 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:08,066 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:08,066 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:08,067 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:08,068 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:08,068 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:08,069 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:08,070 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:08,070 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:08,071 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:08,072 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:08,073 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:08,074 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:08,144 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:08,146 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:08,146 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:08,147 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:08,148 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:08,148 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:08,149 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:08,150 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:08,151 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:08,151 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:08,152 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:08,153 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:08,153 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:08,154 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:08,154 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:08,155 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:08,156 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:08,156 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:08,157 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:08,158 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:08,159 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:08,159 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:08,160 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:08,161 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:08,162 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:08,167 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:08,195 [30] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 17:02:08,200 [30] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 17:02:08,205 [30] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 17:02:08,219 [30] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 17:02:08,233 [30] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 17:02:08,266 [30] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 17:02:08,285 [30] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 17:02:08,373 [30] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 17:02:08,377 [30] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 17:02:08,379 [30] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 17:02:51,947 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:51,948 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:51,950 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:51,951 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:51,953 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:51,953 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:51,955 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:51,956 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:51,957 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:51,958 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:51,959 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:51,959 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:51,959 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:51,960 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:51,961 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:51,961 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:51,962 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:51,963 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:51,964 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:51,965 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:51,968 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:51,968 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:51,969 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:51,969 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:51,970 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:51,972 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:52,003 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:52,004 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,005 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,006 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,007 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,007 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,008 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,008 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,009 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,010 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,010 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,011 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,011 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,012 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,012 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,012 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,013 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,013 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,014 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,015 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,015 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,016 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,017 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,018 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,019 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,020 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:52,055 [7] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:52,056 [7] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,057 [7] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,057 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,058 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,059 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,059 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,060 [7] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,060 [7] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,061 [7] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,061 [7] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,062 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,062 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,063 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,063 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,064 [7] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,064 [7] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,065 [7] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,066 [7] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,067 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,068 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,068 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,069 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,069 [7] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,070 [7] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,071 [7] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:52,650 [35] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:52,651 [35] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,652 [35] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,653 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,653 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,654 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,655 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,655 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,656 [35] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,657 [35] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,657 [35] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,658 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,658 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,659 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,659 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,660 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,661 [35] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,661 [35] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:52,662 [35] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:52,663 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:52,663 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:52,664 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:52,666 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:52,667 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:52,668 [35] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:52,669 [35] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:52,717 [35] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 17:02:52,721 [35] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 17:02:52,724 [35] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 17:02:52,726 [35] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 17:02:52,730 [35] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 17:02:52,732 [35] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 17:02:52,733 [35] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 17:02:52,735 [35] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:02:52,742 [35] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 17:02:52,743 [35] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:02:52,745 [35] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 17:02:52,747 [35] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 17:02:52,759 [35] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 17:02:52,761 [35] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20200202.oches.incorso.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20200202.oches.incorso.task', 1, convert(datetime, '2021-02-28 17:01:01', 120), convert(datetime, '2021-02-28 17:01:48', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 17:01:01', 120), dt_lwt = convert(datetime, '2021-02-28 17:01:48', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:01', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:48', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 17:02:52,766 [35] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20200202.oches.incorso.task
2021-02-28 17:02:52,824 [35] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20200202.oches.incorso.task, in: C:\root\todd\_test\dn\oches.task
2021-02-28 17:02:52,825 [35] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'oches.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1848
2021-02-28 17:02:52,832 [35] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\oches.task\__i.xml
2021-02-28 17:02:52,834 [35] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1848 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1848, null, left('oches', 150)
            , NULL, convert(datetime, '2020-02-02 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-02-28 17:02:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-02-02 00:00:00', 120), dt_upd = NULL
         , title = left('oches', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 17:02:52', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('oches', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:02:52,839 [35] DEBUG dn_lib.tools.log - aggiunto task al database: oches
2021-02-28 17:02:52,840 [35] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1848 and file_name = 'bingo.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1848, 'bingo.txt', '.txt', 1, convert(datetime, '2021-02-28 17:01:45', 120), convert(datetime, '2021-02-28 17:01:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:01:45', 120), dt_lwt = convert(datetime, '2021-02-28 17:01:52', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:45', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:02:52,845 [35] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\oches.task\bingo.txt
2021-02-28 17:02:52,853 [35] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4345;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4345, '.txt', @content, convert(datetime, '2021-02-28 17:01:45', 120), convert(datetime, '2021-02-28 17:01:52', 120));
2021-02-28 17:02:52,855 [35] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\oches.task\bingo.txt
2021-02-28 17:02:52,856 [35] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1848 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1848, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 17:01:24', 120), convert(datetime, '2021-02-28 17:01:34', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:01:24', 120), dt_lwt = convert(datetime, '2021-02-28 17:01:34', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:24', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:34', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:02:52,860 [35] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\oches.task\i.txt
2021-02-28 17:02:52,864 [35] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4346;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4346, '.txt', @content, convert(datetime, '2021-02-28 17:01:24', 120), convert(datetime, '2021-02-28 17:01:34', 120));
2021-02-28 17:02:52,867 [35] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\oches.task\i.txt
2021-02-28 17:02:52,869 [35] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1469;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1469, 4346, @content
          , convert(datetime, '2021-02-28 17:01:24', 120), convert(datetime, '2021-02-28 17:01:34', 120));
2021-02-28 17:02:52,872 [35] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\oches.task\i.txt
2021-02-28 17:02:52,873 [35] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1469) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 17:02:52,879 [35] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 17:02:52,888 [35] DEBUG dn_lib.tools.log - cancellati dal database: 1 files
2021-02-28 17:02:52,889 [35] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-02-28 17:02:52,890 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 17:02:52,894 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 17:02:52,898 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 17:01:52')
        else update users_cache set var_value = substring('2021/02/28 17:01:52', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 17:02:52,901 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 17:02:52')
        else update users_cache set var_value = substring('2021/02/28 17:02:52', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 17:02:56,924 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:56,925 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:56,926 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:56,927 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:56,928 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:56,928 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:56,929 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:56,929 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:56,930 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:56,930 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:56,931 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:56,931 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:56,932 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:56,933 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:56,934 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:56,935 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:56,935 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:56,936 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:56,936 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:56,937 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:56,937 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:56,938 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:56,938 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:56,939 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:56,939 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:56,940 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:57,502 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:02:57,503 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:57,504 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:57,505 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:57,506 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:57,506 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:57,507 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:57,508 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:57,509 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:57,509 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:57,510 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:57,510 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:57,511 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:57,512 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:57,512 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:57,513 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:57,513 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:57,514 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:02:57,515 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:02:57,516 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:02:57,516 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:02:57,517 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:02:57,518 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:02:57,518 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:02:57,519 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:02:57,520 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:02:57,529 [12] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 17:02:57,531 [12] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 17:02:57,532 [12] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 17:02:57,533 [12] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 17:02:57,534 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 17:02:57,536 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 17:02:57,537 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 17:02:57,538 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:02:57,539 [12] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 17:02:57,540 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:02:57,541 [12] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 17:02:57,542 [12] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 17:02:57,544 [12] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 17:02:57,545 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'oches.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'oches.task', 1, convert(datetime, '2021-02-28 17:01:01', 120), convert(datetime, '2021-02-28 17:02:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 17:01:01', 120), dt_lwt = convert(datetime, '2021-02-28 17:02:52', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:01', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:02:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 17:02:57,549 [12] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\oches.task
2021-02-28 17:02:57,566 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1848 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1848, null, left('oches', 150)
            , NULL, convert(datetime, '2020-02-02 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-02-02 00:00:00', 120), dt_upd = NULL
         , title = left('oches', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('oches', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:02:57,572 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1848 and file_name = 'bingo.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1848, 'bingo.txt', '.txt', 1, convert(datetime, '2021-02-28 17:01:45', 120), convert(datetime, '2021-02-28 17:01:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:01:45', 120), dt_lwt = convert(datetime, '2021-02-28 17:01:52', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:45', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:02:57,573 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1848 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1848, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 17:01:24', 120), convert(datetime, '2021-02-28 17:01:34', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:01:24', 120), dt_lwt = convert(datetime, '2021-02-28 17:01:34', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:24', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:34', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:02:57,575 [12] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1469) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 17:02:57,576 [12] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 17:02:57,577 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '3')
        else update users_cache set var_value = substring('3', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 17:02:57,580 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 17:02:57,581 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 17:02:52')
        else update users_cache set var_value = substring('2021/02/28 17:02:52', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 17:02:57,584 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 17:02:57')
        else update users_cache set var_value = substring('2021/02/28 17:02:57', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 17:03:02,236 [30] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:03:02,237 [30] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:03:02,238 [30] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:03:02,239 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:03:02,239 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:03:02,240 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:03:02,241 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:03:02,242 [30] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:03:02,242 [30] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:03:02,243 [30] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:03:02,243 [30] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:03:02,244 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:03:02,245 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:03:02,245 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:03:02,246 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:03:02,246 [30] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:03:02,247 [30] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:03:02,247 [30] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:03:02,248 [30] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:03:02,249 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:03:02,250 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:03:02,251 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:03:02,252 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:03:02,254 [30] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:03:02,255 [30] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:03:02,256 [30] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:03:02,813 [12] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:03:02,820 [12] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:03:02,821 [12] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:03:02,823 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:03:02,824 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:03:02,824 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:03:02,825 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:03:02,826 [12] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:03:02,827 [12] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:03:02,827 [12] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:03:02,828 [12] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:03:02,829 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:03:02,829 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:03:02,830 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:03:02,831 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:03:02,832 [12] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:03:02,832 [12] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:03:02,833 [12] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:03:02,833 [12] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:03:02,834 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:03:02,834 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:03:02,835 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:03:02,836 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:03:02,836 [12] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:03:02,837 [12] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:03:02,838 [12] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:03:02,847 [12] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 17:03:02,848 [12] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 17:03:02,849 [12] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 17:03:02,850 [12] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 17:03:02,851 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 17:03:02,852 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 17:03:02,853 [12] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 17:03:02,854 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:03:02,855 [12] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 17:03:02,856 [12] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:03:02,857 [12] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 17:03:02,858 [12] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 17:03:02,860 [12] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 17:03:02,861 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'oches.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'oches.task', 1, convert(datetime, '2021-02-28 17:01:01', 120), convert(datetime, '2021-02-28 17:02:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 17:01:01', 120), dt_lwt = convert(datetime, '2021-02-28 17:02:52', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:01', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:02:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 17:03:02,876 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1848 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1848, null, left('oches', 150)
            , NULL, convert(datetime, '2020-02-02 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-02-02 00:00:00', 120), dt_upd = NULL
         , title = left('oches', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-02-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('oches', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:03:02,878 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1848 and file_name = 'bingo.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1848, 'bingo.txt', '.txt', 1, convert(datetime, '2021-02-28 17:01:45', 120), convert(datetime, '2021-02-28 17:01:52', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:01:45', 120), dt_lwt = convert(datetime, '2021-02-28 17:01:52', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:45', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:52', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:03:02,879 [12] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1848 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1848, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 17:01:24', 120), convert(datetime, '2021-02-28 17:01:34', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:01:24', 120), dt_lwt = convert(datetime, '2021-02-28 17:01:34', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:24', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:01:34', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:03:02,881 [12] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1469) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 17:03:02,882 [12] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 17:03:02,883 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '3')
        else update users_cache set var_value = substring('3', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 17:03:02,884 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 17:03:02,885 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 17:02:52')
        else update users_cache set var_value = substring('2021/02/28 17:02:52', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 17:03:02,887 [12] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 17:03:02')
        else update users_cache set var_value = substring('2021/02/28 17:03:02', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 17:08:08,099 [43] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:08:08,100 [43] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:08,101 [43] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:08,103 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:08,103 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:08,104 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:08,105 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:08,106 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:08,107 [43] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:08,108 [43] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:08,108 [43] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:08,109 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:08,110 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:08,111 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:08,111 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:08,112 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:08,113 [43] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:08,113 [43] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:08,114 [43] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:08,115 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:08,117 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:08,118 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:08,119 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:08,120 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:08,121 [43] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:08,121 [43] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:08:08,680 [40] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:08:08,681 [40] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:08,682 [40] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:08,683 [40] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:08,684 [40] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:08,684 [40] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:08,685 [40] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:08,686 [40] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:08,687 [40] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:08,687 [40] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:08,688 [40] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:08,689 [40] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:08,690 [40] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:08,690 [40] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:08,691 [40] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:08,692 [40] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:08,692 [40] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:08,693 [40] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:08,694 [40] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:08,694 [40] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:08,695 [40] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:08,696 [40] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:08,697 [40] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:08,698 [40] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:08,699 [40] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:08,699 [40] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:08:08,710 [40] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 17:08:08,713 [40] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 17:08:08,715 [40] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 17:08:08,718 [40] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 17:08:08,719 [40] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 17:08:08,721 [40] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 17:08:08,722 [40] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 17:08:08,724 [40] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:08:08,726 [40] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 17:08:08,727 [40] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:08:08,728 [40] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 17:08:08,729 [40] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 17:08:08,741 [40] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 17:08:08,742 [40] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = '20200102.fuffa.incorso.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, '20200102.fuffa.incorso.task', 1, convert(datetime, '2021-02-28 17:03:26', 120), convert(datetime, '2021-02-28 17:03:42', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 17:03:26', 120), dt_lwt = convert(datetime, '2021-02-28 17:03:42', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:03:26', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:03:42', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 17:08:08,747 [40] DEBUG dn_lib.tools.log - aggiunto folder al database: C:\root\todd\_test\dn\20200102.fuffa.incorso.task
2021-02-28 17:08:08,783 [40] DEBUG dn_lib.tools.log - rinominato folder: C:\root\todd\_test\dn\20200102.fuffa.incorso.task, in: C:\root\todd\_test\dn\fuffa.task
2021-02-28 17:08:08,783 [40] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'fuffa.task', dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120)
        where folder_id = 1849
2021-02-28 17:08:08,789 [40] DEBUG dn_lib.tools.log - salvato index doc: C:\root\todd\_test\dn\fuffa.task\__i.xml
2021-02-28 17:08:08,790 [40] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1849 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1849, null, left('fuffa', 150)
            , NULL, convert(datetime, '2020-01-02 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, convert(datetime, '2021-02-28 17:08:08', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-02 00:00:00', 120), dt_upd = NULL
         , title = left('fuffa', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = convert(datetime, '2021-02-28 17:08:08', 120)
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('fuffa', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:08:08,795 [40] DEBUG dn_lib.tools.log - aggiunto task al database: fuffa
2021-02-28 17:08:08,796 [40] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1849 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1849, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 17:03:41', 120), convert(datetime, '2021-02-28 17:03:47', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:03:41', 120), dt_lwt = convert(datetime, '2021-02-28 17:03:47', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:03:41', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:03:47', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:08:08,802 [40] DEBUG dn_lib.tools.log - aggiunto file al database: C:\root\todd\_test\dn\fuffa.task\i.txt
2021-02-28 17:08:08,806 [40] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4347;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4347, '.txt', @content, convert(datetime, '2021-02-28 17:03:41', 120), convert(datetime, '2021-02-28 17:03:47', 120));
2021-02-28 17:08:08,809 [40] DEBUG dn_lib.tools.log - salvato contenuto file nel database: C:\root\todd\_test\dn\fuffa.task\i.txt
2021-02-28 17:08:08,809 [40] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1470;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_lwt)
        values (1470, 4347, @content
          , convert(datetime, '2021-02-28 17:03:41', 120), convert(datetime, '2021-02-28 17:03:47', 120));
2021-02-28 17:08:08,812 [40] DEBUG dn_lib.tools.log - salvate le note del task nel database: C:\root\todd\_test\dn\fuffa.task\i.txt
2021-02-28 17:08:08,812 [40] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1470) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 17:08:08,820 [40] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 17:08:08,828 [40] DEBUG dn_lib.tools.log - cancellati dal database: 2 files
2021-02-28 17:08:08,829 [40] DEBUG dn_lib.tools.log - cancellati dal database: 1 folders
2021-02-28 17:08:08,829 [40] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 17:08:08,835 [40] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 17:08:08,839 [40] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 17:03:47')
        else update users_cache set var_value = substring('2021/02/28 17:03:47', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 17:08:08,842 [40] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 17:08:08')
        else update users_cache set var_value = substring('2021/02/28 17:08:08', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 17:08:52,529 [33] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:08:52,531 [33] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:52,532 [33] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:52,533 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:52,534 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:52,535 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:52,536 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:52,537 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:52,538 [33] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:52,539 [33] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:52,540 [33] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:52,541 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:52,542 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:52,543 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:52,543 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:52,544 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:52,545 [33] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:52,546 [33] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:52,547 [33] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:52,548 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:52,549 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:52,549 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:52,550 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:52,551 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:52,552 [33] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:52,553 [33] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:08:53,108 [35] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:08:53,109 [35] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:53,110 [35] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:53,111 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:53,112 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:53,113 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:53,113 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:53,114 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:53,115 [35] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:53,116 [35] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:53,116 [35] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:53,117 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:53,118 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:53,118 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:53,119 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:53,120 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:53,120 [35] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:53,121 [35] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:08:53,121 [35] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:08:53,122 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:08:53,123 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:08:53,123 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:08:53,124 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:08:53,124 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:08:53,125 [35] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:08:53,126 [35] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:08:53,135 [35] DEBUG dn_lib.tools.log - SQL: select distinct lower(nome) as nome from users
2021-02-28 17:08:53,137 [35] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 17:08:53,139 [35] DEBUG dn_lib.tools.log - SQL: select file_name, type_info from dn_files_info
2021-02-28 17:08:53,140 [35] DEBUG dn_lib.tools.log - SQL: select extension, des_extension, open_comment, close_comment, type_content from dn_files_types
2021-02-28 17:08:53,142 [35] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-files')
2021-02-28 17:08:53,144 [35] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-folders')
2021-02-28 17:08:53,145 [35] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = -1 and var_name in ('synch-lwt')
2021-02-28 17:08:53,146 [35] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:09:20,077 [35] DEBUG dn_lib.tools.log - elenco cartelle da sincronizzare
2021-02-28 17:09:20,078 [35] DEBUG dn_lib.tools.log - SQL: select sf.synch_folder_id, sf.pc_name, sf.[title], sf.[des], sf.local_path, sf.http_path, sf.[user], sf.[password]
        from synch_folders sf where sf.pc_name = 'MOLINOVO' order by sf.[title]
2021-02-28 17:09:20,081 [35] DEBUG dn_lib.tools.log -    - cartella di sincronizzazione 'dipa notess' - Deepa Notes, path: C:\root\todd\_test\dn
2021-02-28 17:09:20,082 [35] DEBUG dn_lib.tools.log - SQL: update dn_folders set readed = null;
      update dn_files set readed = null;
      update dn_tasks set readed = null;
2021-02-28 17:09:20,094 [35] DEBUG dn_lib.tools.log - elaboro la cartella C:\root\todd\_test\dn...
2021-02-28 17:09:20,095 [35] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int;
      select top 1 @id = folder_id from dn_folders 
       where synch_folder_id = 1 and parent_id is null 
        and folder_name = 'fuffa.task';
      if(@id is null)
      begin
        insert into dn_folders (synch_folder_id, parent_id, folder_name, readed, dt_ins, dt_lwt)
          values (1, null, 'fuffa.task', 1, convert(datetime, '2021-02-28 17:03:26', 120), convert(datetime, '2021-02-28 17:08:08', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else
      begin
       update dn_folders set readed = 1 where folder_id = @id;
       set ROWCOUNT 0;
       update dn_folders set dt_ins = convert(datetime, '2021-02-28 17:03:26', 120), dt_lwt = convert(datetime, '2021-02-28 17:08:08', 120) 
        where folder_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:03:26', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:08:08', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;
      end
      select @id, @tp, @cc;
2021-02-28 17:09:20,101 [35] DEBUG dn_lib.tools.log - aggiornato folder nel database: C:\root\todd\_test\dn\fuffa.task
2021-02-28 17:09:20,122 [35] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = task_id from dn_tasks where isnull(folder_id, 0) = 1849 and isnull(file_id, 0) = 0;
      if(@id is null)
      begin
        insert into dn_tasks (synch_folder_id, folder_id, file_id, title, [user], dt_ins, dt_upd, readed, stato, priorita, tipo, stima, dt_lwt_index)
          values (1, 1849, null, left('fuffa', 150)
            , NULL, convert(datetime, '2020-01-02 00:00:00', 120), NULL, 1
            , 'in_corso', NULL, NULL, NULL, NULL);
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_tasks set readed = 1 where task_id = @id;
       set ROWCOUNT 0;
       update dn_tasks set dt_ins = convert(datetime, '2020-01-02 00:00:00', 120), dt_upd = NULL
         , title = left('fuffa', 150), [user] = NULL
         , stato = 'in_corso', priorita = NULL
         , tipo = NULL, stima = NULL, dt_lwt_index = NULL
        where task_id = @id
         and (isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2020-01-02 00:00:00', 120), getdate()) 
          or isnull(dt_upd, getdate()) < isnull(NULL, getdate())
          or isnull(title, '') <> isnull('fuffa', '') or isnull([user], '') <> isnull(NULL, '') 
          or isnull(stato, '') <> isnull('in_corso', '') or isnull(priorita, '') <> isnull(NULL, '') 
          or isnull(tipo, '') <> isnull(NULL, '') or isnull(stima, '') <> isnull(NULL, ''))
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:09:20,128 [35] DEBUG dn_lib.tools.log - SQL: declare @id bigint; declare @tp varchar(10); declare @cc int; 
      select top 1 @id = file_id from dn_files where synch_folder_id = 1 and folder_id = 1849 and file_name = 'i.txt';
      if(@id is null)
      begin
        insert into dn_files (synch_folder_id, folder_id, file_name, extension, readed, dt_ins, dt_lwt)
          values (1, 1849, 'i.txt', '.txt', 1, convert(datetime, '2021-02-28 17:03:41', 120), convert(datetime, '2021-02-28 17:03:47', 120));
        select @id = @@IDENTITY, @tp = 'insert', @cc = 1;  
      end
      else 
      begin
       update dn_files set readed = 1 where file_id = @id;
       set ROWCOUNT 0;
       update dn_files set dt_ins = convert(datetime, '2021-02-28 17:03:41', 120), dt_lwt = convert(datetime, '2021-02-28 17:03:47', 120) 
        where file_id = @id and ( isnull(dt_ins, getdate()) <> isnull(convert(datetime, '2021-02-28 17:03:41', 120), getdate())
         or isnull(dt_lwt, getdate()) <> isnull(convert(datetime, '2021-02-28 17:03:47', 120), getdate()));
       select @tp = 'update', @cc = @@ROWCOUNT;       
      end
      select @id, @tp, @cc;
2021-02-28 17:09:20,133 [35] DEBUG dn_lib.tools.log - SQL: update tt set tt.dt_lwt = t2.max_dt
         from dn_tasks tt
         join ( select t.*
          from (select dt.task_id, dt.folder_id, dt.dt_lwt
            , (select max(dt_lwt) from dn_files where folder_id = dt.folder_id) as max_dt
          from dn_tasks dt where dt.folder_id is not null and dt.task_id = 1470) t
          where t.max_dt is not null and t.dt_lwt < t.max_dt ) t2 on t2.task_id = tt.task_id
         where isnull(tt.dt_lwt, 0) <> t2.max_dt;
        select @@ROWCOUNT;
2021-02-28 17:09:20,140 [35] DEBUG dn_lib.tools.log - SQL: declare @cc_files int; declare @cc_folders int;
      select @cc_files = (select count(*) from dn_files where readed is null) 
      select @cc_folders = (select count(*) from dn_folders where readed is null)
      
      delete from dn_folders where readed is null;
      delete from dn_files where readed is null;
      delete fc from dn_files_contents fc
       where not exists (select top 1 1 from dn_files where file_id = fc.file_id);
      delete from dn_tasks where readed is null;
      delete tn from dn_tasks_notes tn
       where not exists (select top 1 1 from dn_tasks where task_id = tn.task_id);
      select @cc_files, @cc_folders;
2021-02-28 17:09:20,147 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-files')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-files', '2')
        else update users_cache set var_value = substring('2', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-files'
2021-02-28 17:09:20,150 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-folders')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-folders', '1')
        else update users_cache set var_value = substring('1', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-folders'
2021-02-28 17:09:20,153 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-lwt')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-lwt', '2021/02/28 17:08:08')
        else update users_cache set var_value = substring('2021/02/28 17:08:08', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-lwt'
2021-02-28 17:09:20,158 [35] DEBUG dn_lib.tools.log - SQL: if not exists (select top 1 1 from users_cache where [user_id] = -1 and var_name = 'synch-last')
        insert into users_cache ([user_id], var_name, var_value)
          values (-1, 'synch-last', '2021/02/28 17:09:20')
        else update users_cache set var_value = substring('2021/02/28 17:09:20', 1, 500), dt_upd = getdate()
          where [user_id] = -1 and var_name = 'synch-last'
2021-02-28 17:09:32,949 [43] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:09:32,951 [43] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:32,952 [43] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:32,953 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:32,954 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:32,955 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:32,955 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:32,956 [43] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:32,957 [43] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:32,957 [43] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:32,958 [43] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:32,958 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:32,959 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:32,961 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:32,961 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:32,961 [43] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:32,962 [43] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:32,963 [43] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:32,964 [43] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:32,964 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:32,965 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:32,965 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:32,966 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:32,967 [43] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:32,969 [43] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:32,969 [43] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:09:33,001 [22] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:09:33,002 [22] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:33,003 [22] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:33,003 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:33,004 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:33,005 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:33,006 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:33,006 [22] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:33,007 [22] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:33,007 [22] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:33,008 [22] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:33,008 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:33,009 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:33,009 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:33,010 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:33,010 [22] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:33,011 [22] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:33,011 [22] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:33,012 [22] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:33,012 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:33,013 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:33,013 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:33,014 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:33,014 [22] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:33,015 [22] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:33,015 [22] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:09:33,052 [35] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:09:33,052 [35] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:33,053 [35] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:33,054 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:33,054 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:33,055 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:33,056 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:33,056 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:33,057 [35] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:33,057 [35] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:33,058 [35] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:33,058 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:33,059 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:33,059 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:33,060 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:33,060 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:33,061 [35] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:33,061 [35] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:09:33,062 [35] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:09:33,062 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:09:33,063 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:09:33,063 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:09:33,064 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:09:33,065 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:09:33,065 [35] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:09:33,066 [35] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:09:33,076 [35] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 17:09:33,078 [35] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 17:09:33,081 [35] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 17:09:33,088 [35] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 17:09:33,095 [35] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 17:09:33,112 [35] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 17:09:33,115 [35] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 17:09:33,118 [35] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 17:09:33,121 [35] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 17:09:33,123 [35] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 17:10:08,409 [33] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:10:08,410 [33] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:10:08,411 [33] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:10:08,412 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:10:08,413 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:10:08,414 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:10:08,415 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:10:08,416 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:10:08,417 [33] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:10:08,417 [33] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:10:08,418 [33] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:10:08,419 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:10:08,419 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:10:08,420 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:10:08,421 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:10:08,421 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:10:08,422 [33] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:10:08,422 [33] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:10:08,423 [33] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:10:08,423 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:10:08,424 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:10:08,425 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:10:08,426 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:10:08,427 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:10:08,428 [33] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:10:08,429 [33] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:10:08,443 [33] DEBUG dn_lib.tools.log - SQL: select content from dn_tasks_notes 
       where task_id = 1470
2021-02-28 17:10:08,446 [33] DEBUG dn_lib.tools.log - SQL: select a.file_id, a.file_name, a.extension, a.http_path , null as found_file       
       , (select top 1 1 from dn_tasks where task_id = a.task_id and file_id = a.file_id) as file_task
      from vw_task_allegati a
      where a.task_id = 1470
2021-02-28 17:12:24,877 [35] INFO dn_lib.tools.log - reload core
2021-02-28 17:12:24,928 [35] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:12:24,930 [35] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:24,931 [35] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:24,932 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:24,932 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:24,933 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:24,934 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:24,934 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:24,935 [35] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:24,935 [35] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:24,937 [35] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:24,937 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:24,938 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:24,939 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:24,940 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:24,941 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:24,942 [35] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:24,944 [35] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:24,967 [35] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:24,969 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:24,971 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:24,972 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:24,975 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:24,976 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:24,977 [35] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:24,979 [35] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:12:25,042 [17] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:12:25,043 [17] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:25,044 [17] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:25,044 [17] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:25,045 [17] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:25,046 [17] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:25,046 [17] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:25,047 [17] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:25,047 [17] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:25,048 [17] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:25,048 [17] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:25,049 [17] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:25,049 [17] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:25,050 [17] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:25,050 [17] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:25,051 [17] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:25,052 [17] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:25,052 [17] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:25,053 [17] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:25,054 [17] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:25,055 [17] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:25,056 [17] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:25,057 [17] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:25,058 [17] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:25,059 [17] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:25,059 [17] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:12:25,140 [33] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:12:25,141 [33] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:25,142 [33] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:25,143 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:25,143 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:25,144 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:25,145 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:25,145 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:25,146 [33] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:25,147 [33] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:25,147 [33] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:25,148 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:25,148 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:25,149 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:25,150 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:25,150 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:25,151 [33] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:25,152 [33] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:25,153 [33] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:25,154 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:25,155 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:25,156 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:25,158 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:25,159 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:25,159 [33] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:25,164 [33] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:12:25,195 [33] DEBUG dn_lib.tools.log - SQL: select task_filter_id, filter_title, filter_notes, filter_def, filter_class
 from dn_tasks_filters order by filter_order
2021-02-28 17:12:25,200 [33] DEBUG dn_lib.tools.log - SQL: select var_name, var_value 
          from users_cache where [user_id] = 0 and var_name in ('active-task-filter')
2021-02-28 17:12:25,208 [33] DEBUG dn_lib.tools.log - SQL: select ft.tp, ft.synch_folder_id, ft.folder_id, ft.parent_id, ft.title
       , ft.des, ft.http_path, ft.lvl, dbo.folder_path(ft.folder_id) as folder_path
       , (select top 1 1 from dn_tasks where folder_id = ft.folder_id) as is_task
      from dbo.fnc_dn_folders(null, null) ft
      
      order by ft.synch_folder_id, ft.lvl, ft.title
2021-02-28 17:12:25,219 [33] DEBUG dn_lib.tools.log - SQL: select f.synch_folder_id, f.file_id, f.folder_id, f.file_name, f.dt_ins , null as found_file
       from dn_files f
       where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
        
	      where ft.synch_folder_id = f.synch_folder_id 
          and isnull(ft.folder_id, 0) = isnull(f.folder_id, 0))
2021-02-28 17:12:25,229 [33] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (null is null or (null is not null and t.task_id = null)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 17:12:25,262 [33] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 17:12:25,276 [33] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, priorita as [value], [order] from dn_task_priorita
      ) t order by t.[order]
2021-02-28 17:12:25,380 [33] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [days]
       union select title_singolare as title, stima as [value], [days] from dn_task_stima 
       ) t order by t.[days]
2021-02-28 17:12:25,382 [33] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value], -1 as [order]
       union select title_singolare as title, tipo as [value], [order] from dn_task_tipo
       ) t order by t.[order]
2021-02-28 17:12:25,385 [33] DEBUG dn_lib.tools.log - SQL: select t.title, t.[value]
      from (select '' as title, '' as [value]
       union select nome as title, nome as [value] from users
       ) t order by 2
2021-02-28 17:12:30,673 [33] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:12:30,674 [33] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:30,675 [33] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:30,675 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:30,676 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:30,677 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:30,678 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:30,679 [33] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:30,679 [33] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:30,680 [33] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:30,681 [33] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:30,682 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:30,682 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:30,683 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:30,684 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:30,684 [33] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:30,685 [33] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:30,686 [33] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:30,687 [33] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:30,688 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:30,689 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:30,690 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:30,691 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:30,692 [33] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:30,692 [33] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:30,693 [33] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:12:32,765 [33] DEBUG dn_lib.tools.log - SQL: select content from dn_tasks_notes 
       where task_id = 1470
2021-02-28 17:12:32,768 [33] DEBUG dn_lib.tools.log - SQL: select a.file_id, a.file_name, a.extension, a.http_path , null as found_file       
       , (select top 1 1 from dn_tasks where task_id = a.task_id and file_id = a.file_id) as file_task
      from vw_task_allegati a
      where a.task_id = 1470
2021-02-28 17:12:37,402 [35] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:12:37,403 [35] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:37,404 [35] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:37,405 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:37,406 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:37,407 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:37,408 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:37,408 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:37,409 [35] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:37,410 [35] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:37,411 [35] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:37,412 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:37,412 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:37,413 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:37,414 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:37,415 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:37,416 [35] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:37,417 [35] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:12:37,417 [35] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:12:37,418 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:12:37,419 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:12:37,420 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:12:37,420 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:12:37,421 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:12:37,422 [35] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:12:37,422 [35] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:12:57,841 [35] DEBUG dn_lib.tools.log - SQL: select t.synch_folder_id, t.task_id, t.title, f.folder_id as parent_folder_id, t.folder_id
  , sf.local_path + isnull(replace(dbo.folder_path(t.folder_id), '/', '\'), '') as folder_path
  , t.file_id, ft.type_content, ft.open_comment, ft.close_comment
  , sf.local_path + replace(isnull(dbo.folder_path(f.folder_id), '\') + f.file_name, '/', '\') as file_path
  , tn.file_id as file_id_notes
  , sf.local_path + replace(isnull(dbo.folder_path(fn.folder_id), '\') + fn.file_name, '/', '\') as file_path_notes
 from dn_tasks t
 left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
 left join dn_files f on f.file_id = t.file_id
 left join dn_files_types ft on ft.extension = f.extension
 left join dn_tasks_notes tn on tn.task_id = t.task_id
 left join dn_files fn on fn.file_id = tn.file_id
 where t.task_id = 1470
2021-02-28 17:12:57,857 [35] DEBUG dn_lib.tools.log - SQL: delete from dn_files_contents where file_id = 4347;
        insert into dn_files_contents (file_id, extension, content, dt_ins, dt_lwt)
          values (4347, '.txt', @content, convert(datetime, '2021-02-28 17:12:57', 120), convert(datetime, '2021-02-28 17:12:57', 120));
2021-02-28 17:12:57,861 [35] DEBUG dn_lib.tools.log - SQL: delete from dn_tasks_notes where task_id = 1470;
      insert into dn_tasks_notes (task_id, file_id, content, dt_ins, dt_upd)
        values (1470, 4347, @content
          , convert(datetime, convert(varchar, getdate(), 120), 120), convert(datetime, convert(varchar, getdate(), 120), 120));
      update dn_tasks set dt_upd = convert(datetime, convert(varchar, getdate(), 120), 120) where task_id = 1470;
2021-02-28 17:13:06,260 [35] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:13:06,266 [35] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:13:06,267 [35] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:13:06,268 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:13:06,269 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:13:06,270 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:13:06,271 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:13:06,272 [35] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:13:06,272 [35] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:13:06,273 [35] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:13:06,274 [35] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:13:06,274 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:13:06,275 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:13:06,275 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:13:06,276 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:13:06,277 [35] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:13:06,277 [35] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:13:06,278 [35] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:13:06,279 [35] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:13:06,280 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:13:06,280 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:13:06,281 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:13:06,282 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:13:06,283 [35] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:13:06,283 [35] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:13:06,284 [35] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:13:14,820 [35] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 17:13:14,829 [35] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.stato is not null and fl.free_txt = t.item) as free_state
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.priorita is not null and fl.free_txt = t.item) as free_priorita
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.stima is not null and fl.free_txt = t.item) as free_stima
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.tipo is not null and fl.free_txt = t.item) as free_tipo
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join users fl on fl.nome = t.item) as free_assegna
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1470) t2
2021-02-28 17:13:15,004 [35] DEBUG dn_lib.tools.log - SQL: update dn_tasks set stato = 'check' where task_id = 1470
2021-02-28 17:13:15,006 [35] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'fuffa.monitora.task' where folder_id = 1849
2021-02-28 17:13:15,008 [35] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 17:13:15,011 [35] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (1470 is null or (1470 is not null and t.task_id = 1470)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
2021-02-28 17:13:28,627 [54] INFO dn_lib.tools.log - reload config docs
2021-02-28 17:13:28,628 [54] INFO dn_lib.tools.log - load xml config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:13:28,629 [54] INFO dn_lib.tools.log - load xml config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:13:28,630 [54] INFO dn_lib.tools.log - load xml config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:13:28,630 [54] INFO dn_lib.tools.log - load xml config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:13:28,631 [54] INFO dn_lib.tools.log - load xml config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:13:28,632 [54] INFO dn_lib.tools.log - load xml config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:13:28,633 [54] INFO dn_lib.tools.log - load xml config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:13:28,634 [54] INFO dn_lib.tools.log - load xml config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:13:28,635 [54] INFO dn_lib.tools.log - load vars doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:13:28,636 [54] INFO dn_lib.tools.log - load vars doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:13:28,636 [54] INFO dn_lib.tools.log - load vars doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:13:28,637 [54] INFO dn_lib.tools.log - load vars doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:13:28,638 [54] INFO dn_lib.tools.log - load vars doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:13:28,639 [54] INFO dn_lib.tools.log - load vars doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:13:28,639 [54] INFO dn_lib.tools.log - load vars doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:13:28,640 [54] INFO dn_lib.tools.log - load vars doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:13:28,641 [54] INFO dn_lib.tools.log - load config doc: \defs\blocks.xml - C:\root\todd\git\dn\deepanotes\defs\blocks.xml
2021-02-28 17:13:28,641 [54] INFO dn_lib.tools.log - load config doc: \defs\cmds.xml - C:\root\todd\git\dn\deepanotes\defs\cmds.xml
2021-02-28 17:13:28,642 [54] INFO dn_lib.tools.log - load config doc: \defs\lib-base.xml - C:\root\todd\git\dn\deepanotes\defs\lib-base.xml
2021-02-28 17:13:28,643 [54] INFO dn_lib.tools.log - load config doc: \defs\lib-conns.xml - C:\root\todd\git\dn\deepanotes\defs\lib-conns.xml
2021-02-28 17:13:28,644 [54] INFO dn_lib.tools.log - load config doc: \defs\lib-notes.xml - C:\root\todd\git\dn\deepanotes\defs\lib-notes.xml
2021-02-28 17:13:28,644 [54] INFO dn_lib.tools.log - load config doc: \defs\lib-synch.xml - C:\root\todd\git\dn\deepanotes\defs\lib-synch.xml
2021-02-28 17:13:28,645 [54] INFO dn_lib.tools.log - load config doc: \defs\lib-vars.xml - C:\root\todd\git\dn\deepanotes\defs\lib-vars.xml
2021-02-28 17:13:28,646 [54] INFO dn_lib.tools.log - load config doc: \defs\users.xml - C:\root\todd\git\dn\deepanotes\defs\users.xml
2021-02-28 17:13:28,646 [54] DEBUG dn_lib.tools.log - SQL: open conn 'Data Source=localhost;Initial Catalog=deepanotes;User ID=sa;Password=Molina32!'
2021-02-28 17:13:38,578 [54] DEBUG dn_lib.tools.log - SQL: select free_txt, stato, priorita, tipo, stima, (case when [default] = 1 then '1' else '0' end) as [default]
        from dn_task_free_labels 
2021-02-28 17:13:38,581 [54] DEBUG dn_lib.tools.log - SQL: select t2.task_id, t2.title, t2.folder_id, t2.file_id
  , t2.rel_path, t2.task_name
  , (case when t2.folder_id is not null then t2.folder_path else t2.file_path end) as folder_path
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.stato is not null and fl.free_txt = t.item) as free_state
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.priorita is not null and fl.free_txt = t.item) as free_priorita
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.stima is not null and fl.free_txt = t.item) as free_stima
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join dn_task_free_labels fl on fl.tipo is not null and fl.free_txt = t.item) as free_tipo
  , (select top 1 t.item as free_txt from dbo.split(t2.task_name, '.') t
    join users fl on fl.nome = t.item) as free_assegna
 from (select t.task_id, t.title
   , t.folder_id, sf.local_path + isnull(replace(dbo.folder_path(fo.parent_id), '/', '\'), '') as folder_path
   , t.file_id, sf.local_path + isnull(replace(dbo.folder_path(f.folder_id), '/', '\'), '') as file_path
   , isnull(f.file_name, fo.folder_name) as task_name
   , sf.title + isnull(isnull(dbo.folder_path(f.folder_id), dbo.folder_path(fo.parent_id)), '') as rel_path
  from dn_tasks t
  left join synch_folders sf on sf.synch_folder_id = t.synch_folder_id
  left join dn_files f on f.file_id = t.file_id
  left join dn_folders fo on fo.folder_id = t.folder_id 
  where t.task_id = 1470) t2
2021-02-28 17:13:38,598 [54] DEBUG dn_lib.tools.log - SQL: update dn_tasks set [user] = 'molinero' where task_id = 1470
2021-02-28 17:13:38,609 [54] DEBUG dn_lib.tools.log - SQL: update dn_tasks set priorita = NULL where task_id = 1470
2021-02-28 17:13:38,612 [54] DEBUG dn_lib.tools.log - SQL: update dn_tasks set stima = NULL where task_id = 1470
2021-02-28 17:13:38,615 [54] DEBUG dn_lib.tools.log - SQL: update dn_tasks set tipo = NULL where task_id = 1470
2021-02-28 17:13:38,617 [54] DEBUG dn_lib.tools.log - SQL: update dn_tasks set title = 'fuffa' where task_id = 1470
2021-02-28 17:13:38,620 [54] DEBUG dn_lib.tools.log - SQL: update dn_folders set folder_name = 'fuffa.monitora.molinero.task' where folder_id = 1849
2021-02-28 17:13:38,622 [54] DEBUG dn_lib.tools.log - SQL: select title_singolare, stato from dn_task_stato order by [order]
2021-02-28 17:13:38,624 [54] DEBUG dn_lib.tools.log - SQL: select t3.*
      , tst.stato, tst.[order] as stato_order, isnull(tst.class, 'light') as stato_class, isnull(tst.title_plurale, '') as stato_title_plurale, isnull(tst.title_singolare, '') as stato_title_singolare
      , tp.priorita, tp.[order] as priorita_order, isnull(tp.class, 'light') as priorita_class, isnull(tp.title_plurale, '') as priorita_title_plurale, isnull(tp.title_singolare, '') as priorita_title_singolare
      , tt.tipo, tt.[order] as tipo_order, isnull(tt.class, 'light') as tipo_class, isnull(tt.title_plurale, '') as tipo_title_plurale, isnull(tt.title_singolare, '') as tipo_title_singolare
      , ts.stima, ts.[days] as stima_days, isnull(ts.class, 'light') as stima_class, isnull(ts.title_plurale, '') as stima_title_plurale, isnull(ts.title_singolare, '') as stima_title_singolare
      , (select top 1 1 from dn_tasks_notes where task_id = t3.task_id) as task_notes
      , (select top 1 1 from vw_task_allegati f2 where f2.task_id = t3.task_id 
          and not exists (select top 1 1 from dn_files_info where file_name = f2.file_name)) as task_files
  from (select t2.*, datediff(day, t2.dt_ref, getdate()) as diff_days
    from (select t.task_id, t.synch_folder_id, isnull(t.folder_id, f.folder_id) as folder_id
	   , t.file_id, t.title, t.[user], t.stato, t.priorita, t.tipo, t.stima, t.dt_ins, t.dt_upd
     , t.dt_lwt, (case when t.dt_ins > t.dt_upd then t.dt_ins else t.dt_upd end) as dt_ref
	  from dn_tasks t
    
	  left join dn_files f on f.file_id = t.file_id
    where (1470 is null or (1470 is not null and t.task_id = 1470)) ) t2
    where exists (select top 1 1 from dbo.fnc_dn_folders(null, null) ft 
	    where  ft.synch_folder_id = t2.synch_folder_id 
       and isnull(ft.folder_id, 0) = isnull(t2.folder_id, 0))) t3
   left join dn_task_stato tst on tst.stato = t3.stato
   left join dn_task_priorita tp on tp.priorita = t3.priorita
   left join dn_task_tipo tt on tt.tipo = t3.tipo
   left join dn_task_stima ts on ts.stima = t3.stima
   where 1 = 1 
